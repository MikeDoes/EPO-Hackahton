<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE ep-patent-document PUBLIC "-//EPO//EP PATENT DOCUMENT 1.5.1//EN" "ep-patent-document-v1-5-1.dtd">
<!-- This XML data has been generated under the supervision of the European Patent Office -->
<ep-patent-document id="EP19891513A1" file="EP19891513NWA1.xml" lang="en" country="EP" doc-number="3889887" kind="A1" date-publ="20211006" status="n" dtd-version="ep-patent-document-v1-5-1">
<SDOBI lang="en"><B000><eptags><B001EP>ATBECHDEDKESFRGBGRITLILUNLSEMCPTIESILTLVFIROMKCYALTRBGCZEEHUPLSKBAHRIS..MTNORSMESMMAKHTNMD..........</B001EP><B005EP>J</B005EP><B007EP>BDM Ver 2.0.12 (4th of August) -  1100000/0</B007EP></eptags></B000><B100><B110>3889887</B110><B120><B121>EUROPEAN PATENT APPLICATION</B121><B121EP>published in accordance with Art. 153(4) EPC</B121EP></B120><B130>A1</B130><B140><date>20211006</date></B140><B190>EP</B190></B100><B200><B210>19891513.4</B210><B220><date>20191018</date></B220><B240><B241><date>20210210</date></B241></B240><B250>ja</B250><B251EP>en</B251EP><B260>en</B260></B200><B300><B310>2018224285</B310><B320><date>20181129</date></B320><B330><ctry>JP</ctry></B330></B300><B400><B405><date>20211006</date><bnum>202140</bnum></B405><B430><date>20211006</date><bnum>202140</bnum></B430></B400><B500><B510EP><classification-ipcr sequence="1"><text>G06T   7/00        20170101AFI20200605BHEP        </text></classification-ipcr><classification-ipcr sequence="2"><text>B25J  13/08        20060101ALI20200605BHEP        </text></classification-ipcr><classification-ipcr sequence="3"><text>G06N  20/00        20190101ALI20200605BHEP        </text></classification-ipcr></B510EP><B520EP><classifications-cpc><classification-cpc sequence="1"><text>G05B  19/4155      20130101 LI20200626BCEP        </text></classification-cpc><classification-cpc sequence="2"><text>G06T   7/00        20130101 LI20200626BCEP        </text></classification-cpc><classification-cpc sequence="3"><text>G06N  20/00        20190101 LI20200626BCEP        </text></classification-cpc><classification-cpc sequence="4"><text>B25J  13/08        20130101 LI20200626BCEP        </text></classification-cpc></classifications-cpc></B520EP><B540><B541>de</B541><B542>BILDERZEUGUNGSVORRICHTUNG, ROBOTERTRAININGSSYSTEM, BILDERZEUGUNGSVERFAHREN UND BILDERZEUGUNGSPROGRAMM</B542><B541>en</B541><B542>IMAGE GENERATION DEVICE, ROBOT TRAINING SYSTEM, IMAGE GENERATION METHOD, AND IMAGE GENERATION PROGRAM</B542><B541>fr</B541><B542>DISPOSITIF DE GÉNÉRATION D'IMAGES, SYSTÈME ?D'ENTRAÎNEMENT DE ROBOT, PROCÉDÉ DE GÉNÉRATION D'IMAGES ET PROGRAMME DE GÉNÉRATION D'IMAGES</B542></B540><B590><B598>1</B598></B590></B500><B700><B710><B711><snm>OMRON Corporation</snm><iid>101882444</iid><irf>67172EP (BE/CB)</irf><adr><str>801, Minamifudodo-cho, 
Horikawahigashiiru,</str><city>Shiokoji-dori, Shimogyo-ku,
Kyoto-shi
Kyoto 600-8530</city><ctry>JP</ctry></adr></B711></B710><B720><B721><snm>FU, Kin Chung Denny</snm><adr><str>c/o Intellectual Property Center OMRON CORPORATION
9 chome - 1, Kizugawadai,
Kizugawa-shi,</str><city>Kyoto 610-0283</city><ctry>JP</ctry></adr></B721><B721><snm>YAMAGUCHI, Yuki</snm><adr><str>c/o Intellectual Property Center OMRON CORPORATION
9 chome - 1, Kizugawadai,
Kizugawa-shi,</str><city>Kyoto 610-0283</city><ctry>JP</ctry></adr></B721><B721><snm>OKAWA, Yohei</snm><adr><str>c/o Intellectual Property Center OMRON CORPORATION
9 chome - 1, Kizugawadai,
Kizugawa-shi,</str><city>Kyoto 610-0283</city><ctry>JP</ctry></adr></B721><B721><snm>HAYASHI, Kennosuke</snm><adr><str>c/o Intellectual Property Center OMRON CORPORATION
9 chome - 1, Kizugawadai,
Kizugawa-shi,</str><city>Kyoto 610-0283</city><ctry>JP</ctry></adr></B721><B721><snm>SAITO, Chisato</snm><adr><str>c/o Intellectual Property Center OMRON CORPORATION
9 chome - 1, Kizugawadai,
Kizugawa-shi,</str><city>Kyoto 610-0283</city><ctry>JP</ctry></adr></B721><B721><snm>SHIBATA, Yoshiya</snm><adr><str>c/o Intellectual Property Center OMRON CORPORATION
9 chome - 1, Kizugawadai,
Kizugawa-shi,</str><city>Kyoto 610-0283</city><ctry>JP</ctry></adr></B721></B720><B740><B741><snm>Becker, Eberhard</snm><iid>100041761</iid><adr><str>Becker &amp; Kurig Partnerschaft 
Patentanwälte PartmbB 
Bavariastrasse 7</str><city>80336 München</city><ctry>DE</ctry></adr></B741></B740></B700><B800><B840><ctry>AL</ctry><ctry>AT</ctry><ctry>BE</ctry><ctry>BG</ctry><ctry>CH</ctry><ctry>CY</ctry><ctry>CZ</ctry><ctry>DE</ctry><ctry>DK</ctry><ctry>EE</ctry><ctry>ES</ctry><ctry>FI</ctry><ctry>FR</ctry><ctry>GB</ctry><ctry>GR</ctry><ctry>HR</ctry><ctry>HU</ctry><ctry>IE</ctry><ctry>IS</ctry><ctry>IT</ctry><ctry>LI</ctry><ctry>LT</ctry><ctry>LU</ctry><ctry>LV</ctry><ctry>MC</ctry><ctry>MK</ctry><ctry>MT</ctry><ctry>NL</ctry><ctry>NO</ctry><ctry>PL</ctry><ctry>PT</ctry><ctry>RO</ctry><ctry>RS</ctry><ctry>SE</ctry><ctry>SI</ctry><ctry>SK</ctry><ctry>SM</ctry><ctry>TR</ctry></B840><B844EP><B845EP><ctry>BA</ctry></B845EP><B845EP><ctry>ME</ctry></B845EP></B844EP><B848EP><B849EP><ctry>KH</ctry></B849EP><B849EP><ctry>MA</ctry></B849EP><B849EP><ctry>MD</ctry></B849EP><B849EP><ctry>TN</ctry></B849EP></B848EP><B860><B861><dnum><anum>JP2019041015</anum></dnum><date>20191018</date></B861><B862>ja</B862></B860><B870><B871><dnum><pnum>WO2020110505</pnum></dnum><date>20200604</date><bnum>202023</bnum></B871></B870></B800></SDOBI>
<abstract id="abst" lang="en">
<p id="pa01" num="0001">An image generation device according to the present invention generates, on the basis of inputted images, a learning image for training an action of a robot which carries out a prescribed operation on a workpiece. The image generation device comprises: a first image acquisition unit which acquires a first image capturing a real operation space including the robot and not including the workpiece; a second image acquisition unit which acquires a second image in which a virtual operation space including a virtual robot corresponding to the robot and a virtual workpiece corresponding to the workpiece is rendered; and a learning apparatus which is trained by machine learning so that, in response to an input of the first image and the second image, the apparatus outputs a third image obtained by transforming the second image such that at least the virtual robot included in the second image is made to approximate the robot included in the first image.<img id="iaf01" file="imgaf001.tif" wi="72" he="85" img-content="drawing" img-format="tif"/></p>
</abstract>
<description id="desc" lang="en"><!-- EPO <DP n="1"> -->
<heading id="h0001">BACKGROUND</heading>
<heading id="h0002">Technical Field</heading>
<p id="p0001" num="0001">The present invention relates to an image generation device, a robot training system, an image generation method, and an image generation program.</p>
<heading id="h0003">Background Art</heading>
<p id="p0002" num="0002">In recent years, as a control method of a robot, a control method called a visual servo system has been proposed. For example, in controlling a robot that grips a workpiece, an image including the workpiece is acquired as an input image by a visual sensor such as a camera, and a control command for the robot to operate to grip the workpiece is generated on the basis of a positional relationship between the robot and the workpiece identified from the image. In addition, in order to generate such a control command, machine learning for generating a control command suitable for the acquired image is performed (for example, Patent Literature 1).</p>
<p id="p0003" num="0003">Incidentally, in order to perform machine learning as described above, teacher data having learning images that show positional relationships between a robot and various types of workpieces, or workpieces placed in various positions and orientations, and control commands for the robot to perform a target gripping operation on a workpiece shown in each learning image is required, and in general, as the amount of teacher data increases, more accurate learning can be performed. Therefore, as the learning images, for example, a large number of images showing different types of workpieces or a large number of images showing different positional relationships between the workpieces and the robot are required.</p>
<heading id="h0004">Citation List</heading><!-- EPO <DP n="2"> -->
<heading id="h0005">Patent Literature</heading>
<p id="p0004" num="0004">Patent Literature 1 <patcit id="pcit0001" dnum="JP2017185577A"><text>Japanese Patent Laid-Open No. 2017-185577</text></patcit></p>
<heading id="h0006">SUMMARY</heading>
<heading id="h0007">Technical Problem</heading>
<p id="p0005" num="0005">As a learning image, for example, a captured image that captures a real operation space can be used, or a virtual image in which a virtual operation space that imitates a robot and a workpiece is rendered can be used. However, it is not easy to capture a large number of images of the real operation space in which various workpieces are disposed to generate the captured images. On the other hand, since the virtual image as described above can be generated by a computer, a large number of images can be easily generated. However, since it is an artificially generated image, it is not possible to completely render a real robot such as the robot shown in the captured image. For that reason, when the virtual image is used, for example, it may not be possible to accurately identify a positional relationship between the robot and the workpiece, and in such a case, there is a concern that the control command for the target gripping operation may not be output.</p>
<p id="p0006" num="0006">The present invention has been made to solve the above problems, and an objective of the present invention is to provide an image generation device, a robot training system, an image generation method, and an image generation program in which a learning image suitable for training an action of a robot which carries out a prescribed operation on a workpiece can be easily generated on the basis of an input image.</p>
<heading id="h0008">Solution to Problem</heading>
<p id="p0007" num="0007">An image generation device according to the present invention is an image generation device that generates a learning image for training an action of a robot which carries out a prescribed operation on a workpiece on the basis of an input image, and includes: a first image<!-- EPO <DP n="3"> --> acquisition unit which acquires a first image of a real operation space including the robot and not including the workpiece; a second image acquisition unit which acquires a second image in which a virtual operation space including a virtual robot corresponding to the robot and a virtual workpiece corresponding to the workpiece is rendered; and a learning apparatus, which is trained by machine learning, in which the first image and the second image are input, and a third image obtained by converting the second image such that at least the virtual robot included in the second image is made to approximate the robot included in the first image is output.</p>
<p id="p0008" num="0008">In the above image generation device, the learning apparatus further includes: a generator which generates the third image; a fourth image acquisition unit which acquires a fourth image in which the virtual workpiece is added to the first image on the basis of the second image; and a discriminator connected to the generator and the fourth image acquisition unit, and the machine learning may be configured to include alternating a first training step of training the discriminator to discriminate whether or not the third image input to the discriminator is the fourth image, and a second training step of training the generator to generate the third image such that the discriminator makes a mistake in the discrimination.</p>
<p id="p0009" num="0009">In the image generation device, the learning apparatus may further include a predictor trained such that the third image is input and performance of the operation performed by the robot is output.</p>
<p id="p0010" num="0010">A robot training system according to the present invention includes an imaging unit which acquires the input image, the robot, and any of the image generation devices described above, and the robot is trained to perform a prescribed processing operation from the input image in accordance with learning data including the third image generated by the image generation device.</p>
<p id="p0011" num="0011">The robot training system may further include a simulator which simulates the operation of the robot and an evaluation unit which evaluates an operation performed by the<!-- EPO <DP n="4"> --> simulator.</p>
<p id="p0012" num="0012">An image generation method according to the present invention is an image generation method that generates a learning image for training an action of a robot which carries out a prescribed operation on a workpiece on the basis of an input image, and includes the steps of: acquiring a first image of a real operation space including the robot and not including the workpiece; acquiring a second image in which a virtual operation space including a virtual robot corresponding to the robot and a virtual workpiece corresponding to the workpiece is rendered; and inputting the first image and the second image and outputting a third image obtained by converting the second image such that at least the virtual robot included in the second image is made to approximate the robot included in the first image.</p>
<p id="p0013" num="0013">An image generation program causes a computer that generates a learning image for training an action of a robot which carries out a prescribed operation on a workpiece on the basis of an input image to execute steps of: acquiring a first image of a real operation space including the robot and not including the workpiece; acquiring a second image in which a virtual operation space including a virtual robot corresponding to the robot and a virtual workpiece corresponding to the workpiece is rendered; and inputting the first image and the second image and outputting a third image obtained by converting the second image such that at least the virtual robot included in the second image is made to approximate the robot included in the first image.</p>
<heading id="h0009">Advantageous Effects of Invention</heading>
<p id="p0014" num="0014">According to the present invention, it is possible to easily generate a learning image suitable for training an action of a robot which carries out a prescribed operation on a workpiece on the basis of an input image.</p>
<heading id="h0010">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p0015" num="0015">
<ul id="ul0001" list-style="none" compact="compact">
<li><figref idref="f0001">Fig. 1</figref> is a block diagram showing an example of a situation in which a processing<!-- EPO <DP n="5"> --> system of the present invention is applied to a gripping system.</li>
<li><figref idref="f0002">Fig. 2</figref> is a schematic configuration diagram of a gripping system according to an embodiment of the present invention.</li>
<li><figref idref="f0003">Fig. 3</figref> is a block diagram showing a hardware configuration of a control device used in the system of <figref idref="f0002">Fig. 2</figref>.</li>
<li><figref idref="f0004">Fig. 4</figref> is a block diagram showing a hardware configuration of a learning apparatus used in the system of <figref idref="f0002">Fig. 2</figref>.</li>
<li><figref idref="f0005">Fig. 5</figref> is a block diagram showing a hardware configuration of an image generation device used in the system of <figref idref="f0002">Fig. 2</figref>.</li>
<li><figref idref="f0006">Fig. 6</figref> is a block diagram showing a hardware configuration of an evaluation device used in the system of <figref idref="f0002">Fig. 2</figref>.</li>
<li><figref idref="f0007">Fig. 7</figref> is a functional block diagram of the image generation device of <figref idref="f0005">Fig. 5</figref>.</li>
<li><figref idref="f0008">Fig. 8A</figref> is a diagram showing an example of a virtual image.</li>
<li><figref idref="f0008">Fig. 8B</figref> is a diagram showing an example of a virtual image.</li>
<li><figref idref="f0009">Fig. 8C</figref> is a diagram showing an example of a virtual image.</li>
<li><figref idref="f0009">Fig. 8D</figref> is a diagram showing an example of a virtual image.</li>
<li><figref idref="f0010">Fig. 9A</figref> is a diagram showing an example of correspondence between a virtual image and a real image.</li>
<li><figref idref="f0010">Fig. 9B</figref> is a diagram showing an example of correspondence between a virtual image and a real image.</li>
<li><figref idref="f0011">Fig. 9C</figref> is a diagram showing an example of correspondence between a virtual image and a real image.</li>
<li><figref idref="f0012">Fig. 10A</figref> is a diagram showing examples of a virtual image, a real image, and a composite image.</li>
<li><figref idref="f0013">Fig. 10B</figref> is a diagram showing examples of a virtual image, a real image, and a<!-- EPO <DP n="6"> --> composite image.</li>
<li><figref idref="f0014">Fig. 11</figref> is a functional block diagram of the control device of <figref idref="f0003">Fig. 3</figref>.</li>
<li><figref idref="f0015">Fig. 12</figref> is a functional block diagram of the learning apparatus of <figref idref="f0004">Fig. 4</figref>.</li>
<li><figref idref="f0016">Fig. 13</figref> is a functional block diagram of an evaluation device of <figref idref="f0006">Fig. 6</figref>.</li>
<li><figref idref="f0017">Fig. 14</figref> is a flowchart showing an operation example of the system of <figref idref="f0002">Fig. 2</figref>.</li>
</ul></p>
<heading id="h0011">DESCRIPTION OF EMBODIMENTS</heading>
<p id="p0016" num="0016">Hereinafter, embodiments of an image generation device, a robot training system, an image generation method, and an image generation program according to the present invention will be described with reference to the drawings. However, it goes without saying that the embodiments described below are merely examples of the present invention in all respects, and various improvements and modifications can be made without departing from the scope of the present invention. That is, in carrying out the present invention, specific configurations according to the embodiments may be appropriately adopted. Also, although the data appearing in the present embodiments is described in natural language, more specifically, it is specified in a pseudo language, a command, a parameter, a machine language, or the like that can be recognized by a computer.</p>
<heading id="h0012">&lt; 1. Application example&gt;</heading>
<p id="p0017" num="0017">First, an example of a situation in which the present invention is applied will be described with reference to <figref idref="f0001">Fig. 1. Fig. 1</figref> schematically illustrates an example of a situation in which a robot training system including an image generation device according to the present invention is applied to a gripping system 100. However, an application range of the present invention is not limited to examples of the gripping system illustrated below. That is, the present invention is applicable to all robot training systems that acquire an input image and train a robot to perform a prescribed operation on a workpiece on the basis of the input image.<!-- EPO <DP n="7"> --></p>
<p id="p0018" num="0018">As illustrated in <figref idref="f0001">Fig. 1</figref>, the gripping system 100 according to the present embodiment has a visual servo device 10 including a camera 1, a robot 2 that grips a workpiece R, and a control device 3 that controls an action of the robot 2, a learning apparatus 4 for training the action of the robot 2, an image generation device 5 that generates a learning image used in the learning apparatus 4, and an evaluation device 6 that evaluates learning results of the robot 2. First, the visual servo device 10 will be described.</p>
<p id="p0019" num="0019">In the visual servo device 10, a visual field of the camera 1 is adjusted such that a real operation space in which the robot 2 performs an operation of gripping the workpiece R is captured by the camera 1. As an example, the robot 2 includes an arm 20 having two bending joints 21 and 22, and a support base 23 that rotatably supports the arm 20 around a vertical axis. Also, a gripper 24 for gripping the workpiece R is attached to a tip of the arm 20. In addition, rotation of the bending joints 21 and 22 and the arm 20 with respect to the support base 23, and gripping of the workpiece R by the gripper 24 are performed by a drive motor that is not shown. A control command for the drive motor is output from the control device 3, whereby the robot 2 executes a target operation of gripping the workpiece R and moving it to a prescribed position. That is, bending angles of the bending joints 21 and 22, a rotation angle of the arm 20 with respect to the support base 23, and a degree of gripping of the gripper 24 are controlled to execute the target work.</p>
<p id="p0020" num="0020">In addition, such an operation of the robot 2 is performed on the basis of an image captured by the camera 1. That is, the real operation space is captured by the camera 1, and an input image in which the workpiece R and the robot 2 are captured is acquired. Moreover, a control unit 31 of the control device 3 identifies an action of the robot 1 required to grip the workpiece R from a type, a position, an orientation or the like of the workpiece R reflected in the input image and a positional relationship between the workpiece R and the robot 2, and the control unit 31 outputs a control command necessary for the operation to the robot 2.<!-- EPO <DP n="8"> --></p>
<p id="p0021" num="0021">In order to output an appropriate control command corresponding to the input image, the control unit 31 is machine-learned by the learning apparatus 4 and performs control of outputting a control command from the input image on the basis of learning result data generated by the learning apparatus 4. Here, for machine learning of the action of the robot 2, teacher data having learning images that show positional relationships between a robot and various types of workpieces, or workpieces placed in various orientations, and a control command for the robot to perform a target gripping operation on a workpiece shown in each learning image is required, and in general, as the amount of teacher data increases, more accurate learning can be performed. In the present embodiment, the learning images used for such learning are generated by the image generation device 5.</p>
<p id="p0022" num="0022">In the present embodiment, the image generation device 5 generates a learning image using two types of images. One image is a virtual image (a second image) in which the operation space (including a tray T containing the workpiece), the robot 2, and the workpiece R are all virtually rendered, and this virtual image is generated by a virtual image generation unit 501. The other image is a composite image (a fourth image) in which only the workpiece R among the operation space, the robot 2, and the workpiece R is virtually generated and this virtual product image is combined with a real image (a first image) of the operation space and the robot 2 captured by the camera 1. This composite image is generated by a processor 503. Then, using these two images, the learning image (a third image) is generated by a learner 509.</p>
<p id="p0023" num="0023">Here, since the virtual image is just a computer-generated real operation space, it may not faithfully render the real operation space. For that reason, when learning is performed with the learning apparatus 4 using such a virtual image as it is, it may not be possible to generate appropriate learning result data. For example, in a case in which a positional relationship between the workpiece R and the robot 2 shown in the virtual image cannot faithfully reproduce the positional relationship in the real operation space, only inaccurate positional relationships<!-- EPO <DP n="9"> --> can be identified from the virtual image, which may not output a correct control command for performing the target operation. Therefore, in the present embodiment, the composite image in which only the workpiece R is virtually rendered and combined with the captured image of the operation space and the robot 2 captured by the camera 1 is used. In addition, using the two images of the composite image and the virtual image, the learner 509 generates the learning image obtained by converting the virtual image to approximate the composite image. That is, since the composite image uses real images except for the image of the workpiece, it almost faithfully shows the real operation space, and by using this, the learning image that approximates the real operation space is generated from the virtual image. Also, since the composite image uses a real image only for the robot and the workpiece is generated by a computer, it can be easily generated as compared with a case of preparing captured images for all learning images.</p>
<p id="p0024" num="0024">Further, before transmitting such a generated learning image to the learning apparatus 4, a predictor 508 predicts whether or not the image is appropriate. This predictor 508 has been trained to output an evaluation as to whether or not the learning image can perform appropriate control. Therefore, by using this predictor 508, it is possible to confirm suitability of the learning image before transmitting it to the learning apparatus 4.</p>
<p id="p0025" num="0025">The learning image generated in this way is transmitted to the learning apparatus 4 and used for learning of the control unit 31. The learning result data generated by the learning apparatus 4 may be used as it is by the control unit 31, but in the present embodiment, evaluation is performed by the evaluation device 6 prior thereto. That is, the learning result data generated by the learning apparatus 4 is transmitted to the evaluation device 6, and a simulator 601 of the evaluation device 6 simulates the operation performed by the robot 2. Then, the result is evaluated by an evaluation unit 602. The evaluation here can be various evaluations related to the gripping operation, for example, the probability that the robot 2 can grip the workpiece R and the probability that the robot 2 can grip a correct position of the workpiece R.<!-- EPO <DP n="10"> --></p>
<p id="p0026" num="0026">Then, when the evaluation unit 602 determines that the learning result data is an appropriate evaluation, the learning result data is transmitted to the control unit 31 as being usable in a real operation. Further, the evaluation performed by the evaluation unit 62 can retrain the predictor 508 described above, whereby prediction accuracy of the predictor 508 can be improved.</p>
<p id="p0027" num="0027">Although the configuration of the gripping system according to the present embodiment can be changed in various ways, in particular, an example using the image generation device 5 in which the above-mentioned learner 509 is configured by a generative adversarial network (GAN), which is one type of machine learning, will be described below. The details will be described below.</p>
<heading id="h0013">&lt;2. Configuration example&gt;</heading>
<heading id="h0014">&lt;2-1. Hardware configuration&gt;</heading>
<heading id="h0015">&lt;2-1-1. Overview of gripping system&gt;</heading>
<p id="p0028" num="0028">The gripping system 100 including an image processing device 5 according to the present embodiment will be described with reference to <figref idref="f0002">Fig. 2</figref>. As shown in <figref idref="f0002">Fig. 2</figref>, this gripping system includes a control device 3, an image generation device 4, a learning apparatus 5 of the control device 3, and an evaluation device 6 connected via a network 10. In addition, a robot 2 and a camera 1 that captures a real operation space including the robot 2 are connected to the control device 3 to form a visual servo device 10. A type of network between the control device 3, the learning apparatus 4, the image generation device 5, and the evaluation device 6 does not have to be particularly limited, and the type of network may be appropriately selected from, for example, the Internet, a wireless communication network, a mobile communication network, a telephone network, a dedicated network, and the like.</p>
<p id="p0029" num="0029">Also, in the example of <figref idref="f0002">Fig. 2</figref>, the control device 3, the learning apparatus 4, the image generation device 5, and the evaluation device 6 are separate computers. However, the<!-- EPO <DP n="11"> --> configuration of the gripping system does not have to be limited to such examples. At least one pair among the control device 3, the learning apparatus 4, the image generation device 5, and the evaluation device 6 may be an integrated computer. Further, the control device 3, the learning apparatus 4, the image generation device 5, and the evaluation device 6 may each be configured of a plurality of computers.</p>
<heading id="h0016">&lt;2-1-2. Control device&gt;</heading>
<p id="p0030" num="0030">Next, an example of a hardware configuration of the control device 3 according to the present embodiment will be described with reference to <figref idref="f0003">Fig. 3. Fig. 3</figref> schematically illustrates an example of the hardware configuration of the control device 3 according to the present embodiment.</p>
<p id="p0031" num="0031">The control device 3 is a computer to which a control unit 31, a storage unit 32, an external interface 33, and a communication interface 34 are electrically connected. Thus, the control device 3 is configured to control an operations of the camera 1, a gripping device 2, and a display 35, which will be described later. Also, in <figref idref="f0003">Fig. 3</figref>, the external interface 33 and the communication interface 34 are described as an "external I/F" and a "communication I/F." This point is the same for various devices described later.</p>
<p id="p0032" num="0032">The control unit 31 includes a CPU, a RAM, a ROM, and the like and is configured to execute various information processing on the basis of programs and data. The storage unit 32 is configured of, for example, a RAM, a ROM, or the like and stores a control program 321, learning result data 322, and the like. The control program 321 is a program for causing the control device 3 to execute a control process of the robot 2 and performs the control process on the basis of the learning result data 322 generated by the learning apparatus 4. The control unit 31 is configured to execute processing of each step, which will be described later, by interpreting and executing the control program 321.</p>
<p id="p0033" num="0033">The external interface 33 is an interface for connecting to an external device and is<!-- EPO <DP n="12"> --> appropriately configured depending on the external device to be connected. In the present embodiment, the external interface 33 is connected to the display 35. The display 35 is used, for example, to display a status of the gripping device 2. The display 35 is not particularly limited as long as the status can be displayed, and a known liquid crystal display, a touch panel display, or the like may be used. In addition, an input device, an output device, and the like can be appropriately connected to the external interface 33.</p>
<p id="p0034" num="0034">The communication interface 34 is, for example, a wired local area network (LAN) module, a wireless LAN module, or the like and is an interface for performing wired or wireless communication. That is, the communication interface 34 is an example of a communication unit configured to communicate with another device. In the present embodiment, the camera 1, the gripping device 2, and the learning apparatus 4 are connected to each other via the network 10.</p>
<p id="p0035" num="0035">In addition, with respect to a specific hardware configuration of the control device 3, omissions, substitutions, and additions of components can be appropriately made depending on embodiments. The control unit 31 may include a plurality of processors. Also, the control unit 31 may be configured of an FPGA. The storage unit 32 may be configured of a RAM and a ROM included in the control unit 31. Also, the storage unit 32 may be configured of an auxiliary storage device such as a hard disk drive or a solid state drive. The control device 3 may be a general-purpose desktop PC, a general-purpose tablet PC, or the like, depending on an workpiece to be controlled, in addition to an information processing device designed exclusively for a provided service. The above points are the same in the learning apparatus 4, the image generation device 5, and the evaluation device 6, which will be described later.</p>
<heading id="h0017">&lt;2-1-3. Robot&gt;</heading>
<p id="p0036" num="0036">Next, the robot 2 will be described. An outline of the robot 2 is as described above, but a more detailed example will be described.<!-- EPO <DP n="13"> --></p>
<p id="p0037" num="0037">Drive motors that drive each of the bending joints 21 and 22 and rotate the arm are configured of a servo motor, a brushless motor, and the like. In addition, an angle sensor that can detect an angle, such as a rotary encoder, is attached to each of the bending joints 21 and 22 and a base end portion of the arm 20.</p>
<p id="p0038" num="0038">Further, the gripper 24 may be equipped with a force sensor that detects a force acting on the gripper 24. Thus, the robot 2 can be configured to detect the force acting on the gripper 24.</p>
<p id="p0039" num="0039">Also, with respect to a specific configuration of the robot 2, omissions, substitutions, and additions of components can be appropriately made depending on embodiments. For example, the number of bending joints 21 and 22 may be appropriately selected depending on embodiments. Further, torque sensors may be attached to the bending joints 21 and 22 in addition to the angle sensor. As a result, bending angles of the bending joints 21 and 22 can be controlled by torque.</p>
<p id="p0040" num="0040">Further, the robot 2 can feed back results of an operation performed on the basis of a control command to the control device 3 and reflect them in learning of the control device 3, which will be described later.</p>
<heading id="h0018">&lt;2-1-4. Camera&gt;</heading>
<p id="p0041" num="0041">The camera 1 is adapted to capture the real operation space including the robot 2 and the workpiece R. Also, the camera 1 may be fixed at a predetermined position, or may be configured such that an imaging direction (orientation) thereof can be changed by a motor or the like. For the camera 1, a general digital camera, a general video camera, a general 360-degree camera, or the like may be used, and the camera 1 may be a camera for visible light photography or infrared light photography.</p>
<heading id="h0019">&lt;2-1-5. Learning apparatus&gt;</heading>
<p id="p0042" num="0042"><figref idref="f0004">Fig. 4</figref> is a block diagram showing a learning apparatus according to the present<!-- EPO <DP n="14"> --> embodiment. As shown in <figref idref="f0004">Fig. 4</figref>, the learning apparatus 4 according to the present embodiment is for learning the control unit 31 of the control device 3 and is a computer to which a control unit 41, a storage unit 42, a communication interface 43, an input device 44, an output device 45, an external interface 46, and a drive 47 are electrically connected.</p>
<p id="p0043" num="0043">The control unit 41 includes a central processing unit (CPU), a random access memory (RAM), a read only memory (ROM), and the like and controls each component in accordance with information processing. The storage unit 42 is, for example, an auxiliary storage device such as a hard disk drive or a solid state drive, and stores a learning program 421, learning result data 422, learning data 423, and the like executed by the control unit 41.</p>
<p id="p0044" num="0044">The learning program 421 is a program for causing the learning apparatus 4 to execute a learning process of machine learning for a neural network or the like. The learning result data 422 is data of results of the learning process and is data for setting the control unit 31 of the control device 3. The learning data 423 is data for performing learning, and the learning data 423 includes learning images generated by the image generation device 5, which will be described later. The details will be described later.</p>
<p id="p0045" num="0045">The communication interface 43 and the external interface 46 are the same as those shown in the control device 3. The input device 44 is a device for performing an input through, for example, a mouse, a keyboard, or the like, and the output device 45 is a device for performing an output to, for example, a display, a speaker, or the like.</p>
<p id="p0046" num="0046">The drive 47 is, for example, a compact disk (CD) drive, a digital versatile disk (DVD) drive, or the like and is a device for reading a program stored in a storage medium 49. A type of the drive 47 may be appropriately selected depending on a type of the storage medium 49. The learning program 421 and/or the learning result data 422 may be stored in the storage medium 49.</p>
<p id="p0047" num="0047">The storage medium 49 is a medium that stores information such as recorded programs<!-- EPO <DP n="15"> --> by means of electrical, magnetic, optical, mechanical, or chemical actions so that computers and other devices, machines, or the like can read the information such as the programs. The image processing device 1 may acquire the learning program 421 and/or the learning result data 422 from the storage medium 49.</p>
<p id="p0048" num="0048">Here, <figref idref="f0004">Fig. 4</figref> illustrates a disc type storage medium such as a CD or DVD as an example of the storage medium 49. However, the type of the storage medium 49 is not limited to the disc type and may be other than the disc type. Examples of the storage medium other than the disc type include semiconductor memories such as flash memories.</p>
<heading id="h0020">&lt;2-1-6. Image generation device&gt;</heading>
<p id="p0049" num="0049"><figref idref="f0005">Fig. 5</figref> is a block diagram showing the image generation device according to the present embodiment. As shown in <figref idref="f0005">Fig. 5</figref>, the image generation device 5 according to the present embodiment is a computer to which a control unit 51, a storage unit 52, a communication interface 53, an input device 54, an output device 55, an external interface 56, and a drive 57 are electrically connected.</p>
<p id="p0050" num="0050">The control unit 51 to drive 57 and the storage medium 59 have the same configurations as the control unit 41 to drive 47 and the storage medium 49 of the learning apparatus 4, respectively. However, the storage unit 52 of the image generation device 5 mainly stores an image generation program 521 executed by the control unit 51, first learning data 522, second learning data 523, and third learning data 524 used respectively for learning a generator 504, a discriminator 505, and a predictor 508, which will be described later, and first learning result data 525, second learning result data 526, and third learning result data 527 created by executing the learning program 521.</p>
<p id="p0051" num="0051">Similar to the learning apparatus 4, various programs 521 and data 522 to 527 may be stored in the storage medium 59. In response thereto, the image generation device 5 may acquire at least one of these programs 521 and data 522-527 from the storage medium 59.<!-- EPO <DP n="16"> --></p>
<p id="p0052" num="0052">Further, the camera 1 is connected to the communication interface 53 via the network 10, and an image of the real operation space captured by the camera 1 is transmitted thereto. However, as will be described later, a product R is not included in the image of the real operation space used here.</p>
<heading id="h0021">&lt;2-1-7. Evaluation device&gt;</heading>
<p id="p0053" num="0053"><figref idref="f0006">Fig. 6</figref> is a block diagram showing the evaluation device according to the present embodiment. As shown in <figref idref="f0006">Fig. 6</figref>, the evaluation device 6 according to the present embodiment is a computer to which a control unit 61, a storage unit 62, a communication interface 63, an input device 64, an output device 65, an external interface 66, and a drive 67 are electrically connected.</p>
<p id="p0054" num="0054">The control units 61 to the drive 67 and the storage medium 69 have the same configurations as the control units 41 to drive 47 and the storage medium 49 of the learning apparatus 4, respectively. However, the storage unit 62 of the evaluation device 6 stores a simulation program 621 executed by the evaluation device 6, an evaluation program 622 for evaluating simulation results, evaluation results 623, and the like.</p>
<p id="p0055" num="0055">Also, similarly to the learning apparatus 4, various programs 621 and 622 may be stored in the storage medium 69. Accordingly, the evaluation device 6 may obtain at least one of these programs 621 and 622 from the storage medium 69.</p>
<p id="p0056" num="0056">Further, the learning apparatus 4 and the image generation device 5 are connected to the communication interface 63 via the network 10. As a result, the evaluation device 6 acquires the learning result data 422 from the learning apparatus 4 via the network 10, transmits the generated evaluation results 623 to the image generation device 5, and uses them for learning the predictor 508.</p>
<heading id="h0022">&lt;2-2. Software configuration&gt;</heading>
<heading id="h0023">&lt;2-2-1. Image generation device&gt;</heading><!-- EPO <DP n="17"> -->
<p id="p0057" num="0057">Next, a software configuration of the image generation device 5 will be described with reference to <figref idref="f0007">Fig. 7</figref>. As shown in <figref idref="f0007">Fig. 7</figref>, the control unit 51 of the image generation device 5 functions as a computer which interprets and executes the image generation program 521 stored in the storage unit 52 using the CPU when the image generation program 521 is developed into the RAM, and includes a virtual image generation unit (a second image acquisition unit) 501, an extractor 502, a processor (a first image acquisition unit and a fourth image acquisition unit) 503, a generator 504, a discriminator 505, and a learning processing unit 506, a storage processing unit 507, and a predictor 508.</p>
<p id="p0058" num="0058">The virtual image generation unit 501 generates a virtual image in which the operation space, the robot 2, and the workpiece R are all virtually generated. Since this virtual image becomes a basis of the learning images, a large number of images are generated. For example, as shown in <figref idref="f0008 f0009">Figs. 8A to 8D</figref>, a large number of virtual images having different types, positions, orientations, and the like of the workpiece R are generated. In addition, it is also possible to generate virtual images in which lighting (illuminance, color, orientation, etc.) in the operation space and an imaging position of the camera 1 are changed. The workpiece R in the virtual images can include position information.</p>
<p id="p0059" num="0059">The extractor 502 extracts information about features of the robot and the workpiece in the operation space, such as a shape, a position, and orientation of a product for each virtual image from the created plurality of virtual images.</p>
<p id="p0060" num="0060">The processor 503 acquires real images of the operation space including the robot 2 captured by the camera 1. At this time, as the real images to be acquired, for example, as shown in <figref idref="f0010 f0011">Figs. 9A to 9C</figref>, images corresponding to the virtual images are acquired. That is, real images of the operation space in which the robot 2 having the same arm rotation position and the same joint angle as those in each virtual image and a tray T containing the workpiece R is captured are acquired. For example, in the examples of <figref idref="f0010">Figs. 9B</figref> and <figref idref="f0011">9C</figref>, since only the<!-- EPO <DP n="18"> --> workpieces included in the virtual images are different from each other, and the robots are in the same position, only one real image corresponding to this may be provided. Then, the processor 503 combines an image of the workpiece R with the acquired real image by using, for example, a known technique such as augmented reality (AR). In this case, the combined image of the workpiece R is generated by the extractor 502 on the basis of the information (position information or the like) extracted from the corresponding virtual image. In this way, in the processor 503, the composite image in which the image of the workpiece R is combined with the actual image is generated. Then, the virtual image generated by the virtual image generation unit 501 is transmitted to the generator 504, and the composite image generated by the processor 503 is transmitted to the discriminator 505. <figref idref="f0012">Fig. 10A</figref> and <figref idref="f0013">10B</figref> show examples of the virtual image, the real image, and the composite image.</p>
<p id="p0061" num="0061">Next, the generator 504 and the discriminator 505 will be described. The generator 504 and the discriminator 505 form a learning network through GAN. In addition, the generator 504 is configured of a neural network having a multi-layer structure similar to that of the control device 3 and the learning apparatus 4. Similarly, the discriminator 505 is also configured of a multi-layered neural network. However, a configuration of the discriminator 505 may be different from that of the generator 504.</p>
<p id="p0062" num="0062">Then, the learning processing unit 506 carries out machine learning of the learning network. Performing this machine learning involves alternating a first training step of training the discriminator 505 and a second training step of training the generator 504. In the first training step, the learning processing unit 506 trains the discriminator 505 to discriminate whether an image input to the discriminator 505 is an image (a learning image, which will be described later) generated by the generator 504 or a composite image transmitted from the processor 503. That is, the discriminator 505 is trained to discriminate whether the given image is originated from the processor 503 or the generator 504. Further, in the second training<!-- EPO <DP n="19"> --> step, the learning processing unit 506 trains the generator 504 to generate an image that causes an erroneous discrimination performed by the discriminator 505. Also, here, what is originated from the processor 503 is expressed as "true," and what is originated from the generator 504 is expressed as "false." However, a method for expressing each origin is not limited to such an example and may be appropriately selected depending on embodiments.</p>
<p id="p0063" num="0063">Specifically, in the first training step, the learning processing unit 506 inputs a virtual image to an input layer of the generator 504 and executes arithmetic processing of the generator 504. Thus, the generator 504 acquires a learning image that approximates a composite image corresponding to the input virtual image from an output layer thereof. For example, the virtual image is converted from the virtual image shown in <figref idref="f0012">Fig. 10A</figref> to approximate the composite image, and the learning image is output.</p>
<p id="p0064" num="0064">Then, the learning processing unit 506 inputs the learning image to an input layer of the discriminator 505, and arithmetic processing of the discriminator 505 is executed. Thus, an output value corresponding to the result of discriminating whether the learning image is originated from the generator 50 or the processor 503 is acquired from an output layer thereof. Here, since the image input to the discriminator 505 is a learning image generated by the generator 504, the correct answer is that the discriminator 505 discriminates it as "false." Then, an error between the output value obtained from the output layer and the correct answer is calculated. The learning processing unit 506 calculates the error between the output value obtained from the output layer and the correct answer for each learning image.</p>
<p id="p0065" num="0065">Similarly, the learning processing unit 506 inputs the composite image to the input layer of the discriminator 505 and executes arithmetic processing of the discriminator 505. Thus, the learning processing unit 506 acquires an output value corresponding to the result of discriminating whether the input image is originated from the generator 504 or the processor 503 from the output layer. Here, since the input image is the composite image, the correct answer is<!-- EPO <DP n="20"> --> that the discriminator 505 discriminates it as "true." The learning processing unit 506 calculates an error between the output value obtained from the output layer and the correct answer for each composite image.</p>
<p id="p0066" num="0066">Then, the learning processing unit 506 adjusts parameter values of the discriminator 505 so that a sum of the calculated errors becomes small. The learning processing unit 506 repeats the adjustment of the parameter values of the discriminator 505 through a series of the above processing until the sum of the errors between the output value obtained from the output layer and the correct answer of true or false becomes equal to or less than a threshold. Thus, in the first training step, the learning processing unit 506 trains the discriminator 505 to discriminate whether the image is the learning image generated by the generator 505 or the composite image.</p>
<p id="p0067" num="0067">On the other hand, in the second training step, the learning processing unit 506 inputs the virtual image to the input layer of the generator 504 and executes arithmetic processing of the generator 504. Thus, as described above, the learning processing unit 506 acquires the learning image that approximates the composite image corresponding to the input virtual image from the output layer. That is, the learning image obtained by converting the virtual image into an image similar to the composite image including the real image is output.</p>
<p id="p0068" num="0068">Next, the learning processing unit 506 inputs the generated learning image to the input layer of the discriminator 505 and executes arithmetic processing of the discriminator 505. Thus, the learning processing unit 506 acquires an output value corresponding to the result of discriminating whether the input learning image is originated from the generator 504 or the processor 503 from the output layer. In the training of the generator 504, the correct answer is to cause the result of discrimination performed by the discriminator 505 to be incorrect. That is, it is sufficient that the learning image generated by the generator 504 is generated such that it closely approximates the composite image to be mistaken for the composite image, and the correct answer is that the output value obtained from the output layer corresponds to "true."<!-- EPO <DP n="21"> --> The learning processing unit 506 calculates an error between the output value obtained from the output layer through a series of processing and the correct answer (that is, "true") for each combination of the learning image and the composite image.</p>
<p id="p0069" num="0069">Then, the learning processing unit 506 adjusts parameter values of the generator 504 so that a sum of the calculated errors becomes smaller. For each combination of the learning image and the composite image, the learning processing unit 506 repeats the adjustment of the parameter values of the generator 504 through a series of the above processing until the sum of the errors between the output value obtained from the output layer through the series of processing and the "true" becomes equal to or less than the threshold. As a result, in the second training step, the learning processing unit 506 trains the generator 504 to generate the learning image that causes the erroneous discrimination performed by the discriminator 505.</p>
<p id="p0070" num="0070">In this way, the learning processing unit 506 alternately increases accuracy of the discriminator 505 and accuracy of the generator 504 by alternately performing the first training step and the second training step. As a result, the generator 504 can acquire the ability to appropriately generate the learning image that is substantially the same as the composite image including the real image.</p>
<p id="p0071" num="0071">After the machine learning is completed, the storage processing unit 507 generates the first learning result data and the second learning result data indicating configurations of the constructed generator 504 and the discriminator 505 (for example, the number of layers of the neural network, the number of neurons in each layer, connectional relationships between neurons, and a transfer function of each neuron) and arithmetic parameters (for example, a weight of combination between respective neurons, and a threshold of each neuron). Then, the storage processing unit 507 stores the generated first and first learning result data in a predetermined storage region.</p>
<p id="p0072" num="0072">In this way, when the virtual image generated by the virtual image generator 501 is<!-- EPO <DP n="22"> --> input to the learned generator 504, the learning image that approximates the composite image can be generated. As described above, in generating the learning image, it is not necessary to prepare the real image including the real workpiece R, and a load of generating the learning image can be reduced. That is, the learning image can be easily generated. Then, the learning image is transmitted to the learning apparatus 4, but before that, the predictor 508 is prepared in order to determine whether or not the learning image is appropriate. This predictor 508 is configured of a multi-layered neural network and is learned to input the learning image generated by the learned generator 504 and output whether or not the learning image is appropriate for controlling the gripping device 2. For the learning data, the evaluation output by the evaluation device, which will be described below, can be used. That is, when the gripping operation can be performed properly as a result of simulating the robot 2 on the basis of the learning result data learned using the generated learning image, it can be determined that the learning image is appropriate. On the other hand, in a case in which the gripping operation is not appropriate, it can be determined that the learning image is not appropriate. Therefore, when the predictor 508 is learned using a combination of the learning image and the evaluation performed by the evaluation device 6 as the learning data, it is possible to determine suitability of the learning image generated by the predictor 508 before the simulation is performed. The learning result data of the predictor 508 generated at this time becomes the third learning result data.</p>
<heading id="h0024">&lt;2-2-1. Control device&gt;</heading>
<p id="p0073" num="0073">Next, a software configuration of the control device 3 will be described with reference to <figref idref="f0014">Fig. 11</figref>. As shown in <figref idref="f0014">Fig. 11</figref>, the control unit 31 of the control device 3 functions as a computer which interprets and executes the control program 321 stored in the storage unit 32 using the CPU when the control program 321 is developed into the RAM and includes a learning result data acquisition unit 381, an input image acquisition unit 382, a processing unit 383, and a<!-- EPO <DP n="23"> --> transmission unit 384.</p>
<p id="p0074" num="0074">The learning result data acquisition unit 381 acquires the learning result data 422 from the learning apparatus 4. Further, the input image acquisition unit 382 acquires the input image transmitted from the camera 1. In addition, the processing unit 383 constitutes the learning apparatus that is learned to output a control command for the operation of the robot 2 on the basis of the input image when the input image is input.</p>
<p id="p0075" num="0075">The processing unit 383 that performs such output is configured of a neural network 30. Specifically, the processing unit 383 is a so-called multi-layered neural network 30 used for deep learning as shown in <figref idref="f0014">Fig. 11</figref> and includes an input layer 301, an intermediate layer (a hidden layer) 302, and an output layer 303 in order from the input.</p>
<p id="p0076" num="0076">In the example of <figref idref="f0014">Fig. 11</figref>, the neural network 30 includes one layer of the intermediate layer 302, in which an output of the input layer 301 is an input of the intermediate layer 302, and an output of the intermediate layer 302 is an input of the output layer 303. However, the number of the intermediate layer 302 is not limited to one, and the neural network 30 may include two or more intermediate layers 302.</p>
<p id="p0077" num="0077">Each layer 301 to 303 includes one or more neurons. For example, the number of neurons in the input layer 301 can be set in accordance with the number of input images. The number of neurons in the intermediate layer 302 can be appropriately set depending on embodiments. Further, the output layer 303 can also be set in accordance with the number of control commands.</p>
<p id="p0078" num="0078">Neurons in adjacent layers are appropriately connected to each other, and a weight (a load of connection) is set for each connection. In the example of <figref idref="f0007">Fig. 7</figref>, each neuron is connected to all neurons in adjacent layers, but the connection of neurons does not have to be limited to such an example and may be appropriately set according to embodiments.</p>
<p id="p0079" num="0079">A threshold is set for each neuron, and basically, an output of each neuron is determined<!-- EPO <DP n="24"> --> by whether or not a sum of products of each input and each weight exceeds the threshold. By inputting the input image into the input layer 301 of the neural network 30, the control device 3 obtains a control command indicating the optimum operation of the robot from the output layer 73.</p>
<p id="p0080" num="0080">In addition, information indicating the configuration of such a neural network 30 (for example, the number of layers of the neural network, the number of neurons in each layer, a connectional relationship between neurons, and a transfer function of each neuron), the weight of the connection between respective neurons, and the threshold of each neuron is included in the learning result data 422 generated by the learning apparatus 4. Therefore, the learning result data acquisition unit 381 performs setting of the learned neural network 30, that is, the processing unit 383, with reference to the learning result data 422 transmitted from the learning apparatus 4.</p>
<p id="p0081" num="0081">Then, the control command output by the processing unit 383 is transmitted to the robot 2 by the transmission unit 384.</p>
<heading id="h0025">&lt;2-2-3. Learning apparatus&gt;</heading>
<p id="p0082" num="0082">Next, a software configuration of the learning apparatus 4 will be described with reference to <figref idref="f0015">Fig. 12</figref>. As shown in <figref idref="f0015">Fig. 12</figref>, the control unit 41 of the learning apparatus 4 functions as a computer that interprets and executes the learning program 421 stored in the storage unit 42 using the CPU when the learning program 421 stored in the storage unit 42 is developed into the RAM and includes a learning data generation unit 481, a processing unit 482, and a transmission unit 483.</p>
<p id="p0083" num="0083">The learning data generation unit 481 collects the learning image received from the image generation device 5 and the control command for performing an appropriate gripping operation from the positional relationship between the robot 2 and the workpiece R shown in the learning image and generates the learning data 423 from these. In addition, the processing unit<!-- EPO <DP n="25"> --> 482 has a neural network 40 as the learning apparatus and learns the neural network 40 by an error propagation method or the like using the learning data 423. Then, the learning result data 422 obtained as a result of this learning is transmitted to the control device 3 by the transmission unit 483.</p>
<heading id="h0026">&lt;2-2-4. Evaluation device&gt;</heading>
<p id="p0084" num="0084">Next, a software configuration of the evaluation device 6 will be described with reference to <figref idref="f0016">Fig. 13</figref>. As shown in <figref idref="f0016">Fig. 13</figref>, the control unit 61 of the evaluation device 6 functions as a computer which interprets and executes the simulation program 621 stored in the storage unit 62 using the CPU when the simulation program 621 is developed into the RAM and includes a simulator 601 and an evaluation unit 602.</p>
<p id="p0085" num="0085">The simulator 601 performs simulation of the gripping device 2 on the basis of the learning result data 422 received from the learning apparatus 4. Therefore, the simulator 601 reproduces the control device 3 into which the learning result data 422 is incorporated and the robot 2 on a computer and simulates whether or not the robot 2 performs an appropriate gripping operation when a prescribed input image is input. Then, the evaluation unit 602 evaluates the operation. That is, as described above, the evaluation unit 602 evaluates, as a result of the simulation, whether or not the robot 2 can grip the workpiece R, can grip the workpiece R at a correct angle, can grip a correct position of the workpiece R, and can convey and then correctly dispose the workpiece R. In addition, if the evaluation is equal to or higher than a predetermined value, the learning result data used in this simulation can be determined to be appropriate and is used by the control device 3.</p>
<p id="p0086" num="0086">Further, the learning image used for generating the learning result data used for the evaluation is used for learning the predictor 508 of the image generation device 5 described above.</p>
<heading id="h0027">&lt;3. Operation example&gt;</heading><!-- EPO <DP n="26"> -->
<p id="p0087" num="0087">Next, an operation example of the gripping system configured as described above will be described with reference to the flowchart of <figref idref="f0017">Fig. 14</figref>. First, data such as images is collected (step S101). That is, a plurality of real images is acquired by the camera 1, and a plurality of virtual images is acquired by the virtual image generator 501. Next, composite images are generated from the acquired images. That is, features related to the robot 2 and the workpiece R are extracted from the virtual images, and the composite images in which the workpiece is combined with the corresponding real image is generated on the basis of the features (step S102). Subsequently, the generator 504 and the discriminator 505 are trained on the basis of the virtual images and the composite images (step S103). When the training of the generator 504 is completed in this way, learning image are generated from the virtual images using the learned generator 504 (step S104).</p>
<p id="p0088" num="0088">The generated learning image is transmitted to the learning apparatus 4, and the learning apparatus 4 generates learning result data for driving the control device 3. Then, the evaluation device 6 evaluates whether or not the generated learning result data is appropriate (step S105) and if appropriate, the learning result data is mounted on the control device 3, and the camera 1 and the robot 2 are used to actually grip the workpiece (step S106).</p>
<heading id="h0028">&lt;4. Features&gt;</heading>
<p id="p0089" num="0089">As described above, according to the present embodiment, the image generation device 5 generates the learning image for learning the control device 3 of the robot 2. If an image close to the real image is not used as such an image for learning, the robot 2 may not operate well. However, it is not easy to prepare a large number of learning images in which positions and orientations of the robot 2 and the workpiece R have changed. Therefore, in the present embodiment, the real image of the real operation space including only the robot 2 and the tray T is acquired, and the composite image obtained by combining the virtual R image of the workpiece is generated. In addition, by using GAN, the virtual image is converted into a<!-- EPO <DP n="27"> --> learning image that is made to approximate the composite image, which is adopted as the learning image. Therefore, in generating the learning image, it is not necessary to prepare a real image including the real workpiece R, and the load of generating the learning image can be reduced. That is, the learning image can be easily generated. Further, since the real operation space including the robot R included in the generated learning image is generated to approximate the real image, it is possible to prevent an erroneous positional relationship between the robot 2 and the workpiece R from being identified from this image, and highly accurate learning becomes possible.</p>
<heading id="h0029">&lt;5. Modified examples&gt;</heading>
<p id="p0090" num="0090">Although the embodiment of the present invention has been described in detail above, the above description is merely an example of the present invention in all respects. It is needless to say that various improvements and modifications can be made without departing from the scope of the present invention. For example, the following changes can be made. Also, in the following, the same reference numerals will be used for the same components as those in the above embodiment, and the same points as in the above embodiment will be omitted as appropriate. The following modified examples can be appropriately combined.</p>
<heading id="h0030">&lt;5-1&gt;</heading>
<p id="p0091" num="0091">In the above embodiment, a so-called multi-layered fully connected neural network is used for the processing unit 383, the processing unit 482, the generator 504, the discriminating unit 505, and the predictor 508. However, a structure and a type of the neural network constituting these are not limited to such an example and may be appropriately selected according to embodiments. For example, a convolutional neural network may be used for at least one of these.</p>
<heading id="h0031">&lt;5-2&gt;</heading>
<p id="p0092" num="0092">In the above embodiment, although the virtual image generator 501 is provided in the<!-- EPO <DP n="28"> --> image processing device 5, the above processing can be performed after the virtual image is generated by another device and acquired by the image processing device 5. In the above embodiment, the real operation space including the robot 2 and the tray T is shown in the real image, but at least the robot 2 may be shown.</p>
<heading id="h0032">&lt;5-3&gt;</heading>
<p id="p0093" num="0093">In the above embodiment, the image generation device 5 is provided with the predictor 508, but the predictor 508 is not always necessary and may not be provided.</p>
<heading id="h0033">&lt;5-4&gt;</heading>
<p id="p0094" num="0094">In the above embodiment, the learning image is generated from the virtual image and the composite image using GAN, but the learning image that is made to approximate an image including a real image can be generated using a method other than GAN on the basis of a virtual image.</p>
<heading id="h0034">&lt;5-5&gt;</heading>
<p id="p0095" num="0095">In the above embodiment, the image generation device 5 generates the learning image for controlling the robot 2 to grip the workpiece. However, the generation of such a learning image is not limited to the case of gripping the workpiece and can be applied to the entire visual servo system in which the robot performs some operation on the workpiece. That is, the image generation device of the present invention can be applied to an overall system in which control of pushing, moving, processing, or the like of a workpiece is performed on the basis of images.</p>
<heading id="h0035">Reference Signs List</heading>
<p id="p0096" num="0096">
<ul id="ul0002" list-style="none" compact="compact">
<li>1 Camera (imaging unit)</li>
<li>2 Robot</li>
<li>3 Control device</li>
<li>4 Learning apparatus</li>
<li>5 Image generation device<!-- EPO <DP n="29"> --></li>
<li>504 Generator</li>
<li>505 Discriminator</li>
<li>508 Predictor</li>
<li>6 Evaluation device</li>
</ul></p>
</description>
<claims id="claims01" lang="en"><!-- EPO <DP n="30"> -->
<claim id="c-en-0001" num="0001">
<claim-text>An image generation device is an image generation device that generates a learning image for training an action of a robot which carries out a prescribed operation on a workpiece on the basis of an input image, comprising:
<claim-text>a first image acquisition unit which acquires a first image of a real operation space including the robot and not including the workpiece;</claim-text>
<claim-text>a second image acquisition unit which acquires a second image in which a virtual operation space including a virtual robot corresponding to the robot and a virtual workpiece corresponding to the workpiece is rendered; and</claim-text>
<claim-text>a learning apparatus, which is trained by machine learning, in which the first image and the second image are input, and a third image obtained by converting the second image such that at least the virtual robot included in the second image is made to approximate the robot included in the first image is output.</claim-text></claim-text></claim>
<claim id="c-en-0002" num="0002">
<claim-text>The image generation device according to claim 1,<br/>
wherein the learning apparatus further includes:
<claim-text>a generator which generates the third image;</claim-text>
<claim-text>a fourth image acquisition unit which acquires a fourth image in which the virtual workpiece is added to the first image on the basis of the second image; and</claim-text>
<claim-text>a discriminator connected to the generator and the fourth image acquisition unit, and</claim-text>
<claim-text>the machine learning includes alternating a first training step of training the discriminator to discriminate whether or not the third image input to the discriminator is the fourth image, and a second training step of training the generator to generate the third image such that the discriminator makes a mistake in the discrimination.</claim-text></claim-text></claim>
<claim id="c-en-0003" num="0003">
<claim-text>The image generation device according to claim 2, wherein the learning apparatus further includes a predictor trained such that the third image is input and performance of the<!-- EPO <DP n="31"> --> operation performed by the robot is output.</claim-text></claim>
<claim id="c-en-0004" num="0004">
<claim-text>A robot training system comprising:
<claim-text>an imaging unit which acquires the input image:
<claim-text>the robot; and</claim-text>
<claim-text>the image generation device according to any one of claims 1 to 3,</claim-text></claim-text>
<claim-text>wherein the robot is trained to perform a prescribed processing operation from the input image in accordance with learning data including the third image generated by the image generation device.</claim-text></claim-text></claim>
<claim id="c-en-0005" num="0005">
<claim-text>The robot training system according to claim 4, further comprising a simulator which simulates the operation of the robot and an evaluation unit which evaluates an operation performed by the simulator.</claim-text></claim>
<claim id="c-en-0006" num="0006">
<claim-text>An image generation method is an image generation method that generates a learning image for training an action of a robot which carries out a prescribed operation on a workpiece on the basis of an input image, comprising the steps of:
<claim-text>acquiring a first image of a real operation space including the robot and not including the workpiece;</claim-text>
<claim-text>acquiring a second image in which a virtual operation space including a virtual robot corresponding to the robot and a virtual workpiece corresponding to the workpiece is rendered; and</claim-text>
<claim-text>using a learned learning apparatus, inputting the first image and the second image and outputting a third image obtained by converting the second image such that at least the virtual robot included in the second image is made to approximate the robot included in the first image.</claim-text></claim-text></claim>
<claim id="c-en-0007" num="0007">
<claim-text>An image generation program causing a computer that generates a learning image for training an action of a robot which carries out a prescribed operation on a workpiece on the basis of an input image to execute the steps of:<!-- EPO <DP n="32"> -->
<claim-text>acquiring a first image of a real operation space including the robot and not including the workpiece;</claim-text>
<claim-text>acquiring a second image in which a virtual operation space including a virtual robot corresponding to the robot and a virtual workpiece corresponding to the workpiece is rendered; and</claim-text>
<claim-text>using a learned learning apparatus, inputting the first image and the second image and outputting a third image obtained by converting the second image such that at least the virtual robot included in the second image is made to approximate the robot included in the first image.</claim-text></claim-text></claim>
</claims>
<drawings id="draw" lang="en"><!-- EPO <DP n="33"> -->
<figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="163" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> -->
<figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="162" he="144" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> -->
<figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="165" he="172" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> -->
<figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="163" he="144" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="37"> -->
<figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="151" he="180" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> -->
<figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="138" he="152" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="39"> -->
<figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="165" he="173" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="40"> -->
<figure id="f0008" num="8A,8B"><img id="if0008" file="imgf0008.tif" wi="91" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> -->
<figure id="f0009" num="8C,8D"><img id="if0009" file="imgf0009.tif" wi="96" he="205" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> -->
<figure id="f0010" num="9A,9B"><img id="if0010" file="imgf0010.tif" wi="164" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> -->
<figure id="f0011" num="9C"><img id="if0011" file="imgf0011.tif" wi="164" he="94" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> -->
<figure id="f0012" num="10A"><img id="if0012" file="imgf0012.tif" wi="79" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> -->
<figure id="f0013" num="10B"><img id="if0013" file="imgf0013.tif" wi="79" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> -->
<figure id="f0014" num="11"><img id="if0014" file="imgf0014.tif" wi="149" he="170" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> -->
<figure id="f0015" num="12"><img id="if0015" file="imgf0015.tif" wi="162" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="48"> -->
<figure id="f0016" num="13"><img id="if0016" file="imgf0016.tif" wi="165" he="86" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="49"> -->
<figure id="f0017" num="14"><img id="if0017" file="imgf0017.tif" wi="82" he="190" img-content="drawing" img-format="tif"/></figure>
</drawings>
<search-report-data id="srep" lang="en" srep-office="EP" date-produced=""><doc-page id="srep0001" file="srep0001.tif" wi="160" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="160" he="233" type="tif"/></search-report-data>
<ep-reference-list id="ref-list">
<heading id="ref-h0001"><b>REFERENCES CITED IN THE DESCRIPTION</b></heading>
<p id="ref-p0001" num=""><i>This list of references cited by the applicant is for the reader's convenience only. It does not form part of the European patent document. Even though great care has been taken in compiling the references, errors or omissions cannot be excluded and the EPO disclaims all liability in this regard.</i></p>
<heading id="ref-h0002"><b>Patent documents cited in the description</b></heading>
<p id="ref-p0002" num="">
<ul id="ref-ul0001" list-style="bullet">
<li><patcit id="ref-pcit0001" dnum="JP2017185577A"><document-id><country>JP</country><doc-number>2017185577</doc-number><kind>A</kind></document-id></patcit><crossref idref="pcit0001">[0004]</crossref></li>
</ul></p>
</ep-reference-list>
</ep-patent-document>
