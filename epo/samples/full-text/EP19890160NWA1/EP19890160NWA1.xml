<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE ep-patent-document PUBLIC "-//EPO//EP PATENT DOCUMENT 1.5.1//EN" "ep-patent-document-v1-5-1.dtd">
<!-- This XML data has been generated under the supervision of the European Patent Office -->
<ep-patent-document id="EP19890160A1" file="EP19890160NWA1.xml" lang="en" country="EP" doc-number="3889560" kind="A1" date-publ="20211006" status="n" dtd-version="ep-patent-document-v1-5-1">
<SDOBI lang="en"><B000><eptags><B001EP>ATBECHDEDKESFRGBGRITLILUNLSEMCPTIESILTLVFIROMKCYALTRBGCZEEHUPLSKBAHRIS..MTNORSMESMMAKHTNMD..........</B001EP><B005EP>J</B005EP><B007EP>BDM Ver 2.0.12 (4th of August) -  1100000/0</B007EP></eptags></B000><B100><B110>3889560</B110><B120><B121>EUROPEAN PATENT APPLICATION</B121><B121EP>published in accordance with Art. 153(4) EPC</B121EP></B120><B130>A1</B130><B140><date>20211006</date></B140><B190>EP</B190></B100><B200><B210>19890160.5</B210><B220><date>20191114</date></B220><B240><B241><date>20210414</date></B241></B240><B250>ja</B250><B251EP>en</B251EP><B260>en</B260></B200><B300><B310>2018224110</B310><B320><date>20181129</date></B320><B330><ctry>JP</ctry></B330></B300><B400><B405><date>20211006</date><bnum>202140</bnum></B405><B430><date>20211006</date><bnum>202140</bnum></B430></B400><B500><B510EP><classification-ipcr sequence="1"><text>G01H   9/00        20060101AFI20200605BHEP        </text></classification-ipcr><classification-ipcr sequence="2"><text>G01J   9/00        20060101ALI20200605BHEP        </text></classification-ipcr><classification-ipcr sequence="3"><text>G01M  11/02        20060101ALI20200605BHEP        </text></classification-ipcr></B510EP><B520EP><classifications-cpc><classification-cpc sequence="1"><text>G01M  11/02        20130101 LI20200626BCEP        </text></classification-cpc><classification-cpc sequence="2"><text>G01J   9/00        20130101 LI20200626BCEP        </text></classification-cpc><classification-cpc sequence="3"><text>G01H   9/00        20130101 LI20200626BCEP        </text></classification-cpc></classifications-cpc></B520EP><B540><B541>de</B541><B542>PHASENMESSVERFAHREN, SIGNALVERARBEITUNGSVORRICHTUNG UND PROGRAMM</B542><B541>en</B541><B542>PHASE MEASUREMENT METHOD, SIGNAL PROCESSING DEVICE, AND PROGRAM</B542><B541>fr</B541><B542>PROCÉDÉ DE MESURE DE PHASE, DISPOSITIF DE TRAITEMENT DE SIGNAL ET PROGRAMME</B542></B540><B590><B598>1</B598></B590></B500><B700><B710><B711><snm>NIPPON TELEGRAPH AND TELEPHONE CORPORATION</snm><iid>101867533</iid><irf>23449/EP CR</irf><adr><str>5-1, Otemachi 1-chome,</str><city>Chiyoda-ku, Tokyo 100-8116,</city><ctry>JP</ctry></adr></B711></B710><B720><B721><snm>WAKISAKA, Yoshifumi</snm><adr><str>c/o NTT 
Intellectual Property Center
9-11, Midori-cho 3-chome</str><city>Musashino-shi, Tokyo 180-8585</city><ctry>JP</ctry></adr></B721><B721><snm>IIDA, Daisuke</snm><adr><str>c/o NTT 
Intellectual Property Center
9-11, Midori-cho 3-chome</str><city>Musashino-shi, Tokyo 180-8585</city><ctry>JP</ctry></adr></B721><B721><snm>OKAMOTO, Keiji</snm><adr><str>c/o NTT 
Intellectual Property Center
9-11, Midori-cho 3-chome</str><city>Musashino-shi, Tokyo 180-8585</city><ctry>JP</ctry></adr></B721><B721><snm>OSHIDA, Hiroyuki</snm><adr><str>c/o NTT 
Intellectual Property Center
9-11, Midori-cho 3-chome</str><city>Musashino-shi, Tokyo 180-8585</city><ctry>JP</ctry></adr></B721></B720><B740><B741><snm>v. Bezold &amp; Partner Patentanwälte - PartG mbB</snm><iid>101440043</iid><adr><str>Akademiestraße 7</str><city>80799 München</city><ctry>DE</ctry></adr></B741></B740></B700><B800><B840><ctry>AL</ctry><ctry>AT</ctry><ctry>BE</ctry><ctry>BG</ctry><ctry>CH</ctry><ctry>CY</ctry><ctry>CZ</ctry><ctry>DE</ctry><ctry>DK</ctry><ctry>EE</ctry><ctry>ES</ctry><ctry>FI</ctry><ctry>FR</ctry><ctry>GB</ctry><ctry>GR</ctry><ctry>HR</ctry><ctry>HU</ctry><ctry>IE</ctry><ctry>IS</ctry><ctry>IT</ctry><ctry>LI</ctry><ctry>LT</ctry><ctry>LU</ctry><ctry>LV</ctry><ctry>MC</ctry><ctry>MK</ctry><ctry>MT</ctry><ctry>NL</ctry><ctry>NO</ctry><ctry>PL</ctry><ctry>PT</ctry><ctry>RO</ctry><ctry>RS</ctry><ctry>SE</ctry><ctry>SI</ctry><ctry>SK</ctry><ctry>SM</ctry><ctry>TR</ctry></B840><B844EP><B845EP><ctry>BA</ctry></B845EP><B845EP><ctry>ME</ctry></B845EP></B844EP><B848EP><B849EP><ctry>KH</ctry></B849EP><B849EP><ctry>MA</ctry></B849EP><B849EP><ctry>MD</ctry></B849EP><B849EP><ctry>TN</ctry></B849EP></B848EP><B860><B861><dnum><anum>JP2019044621</anum></dnum><date>20191114</date></B861><B862>ja</B862></B860><B870><B871><dnum><pnum>WO2020110739</pnum></dnum><date>20200604</date><bnum>202023</bnum></B871></B870></B800></SDOBI>
<abstract id="abst" lang="en">
<p id="pa01" num="0001">It is an object to enable offline measurement with a high SN ratio of the phase of scattered light of an optical fiber to be measured in an optical receiving system for real-time measurement (direct measurement). The phase measurement method according to the present invention performs coherent detection of scattered light using a 90-degree optical hybrid, obtains an estimated quadrature component value by averaging a measured quadrature component value that is directly measured and a calculated quadrature component value obtained by Hilbert transforming a measured in-phase component value that is directly measured, obtains an estimated in-phase component value by averaging the measured in-phase component value and a calculated in-phase component value obtained by inverse Hilbert transforming the measured quadrature component value, and calculates the phase of scattered light based on the estimated quadrature component value and the estimated in-phase component value.<img id="iaf01" file="imgaf001.tif" wi="81" he="64" img-content="drawing" img-format="tif"/></p>
</abstract>
<description id="desc" lang="en"><!-- EPO <DP n="1"> -->
<heading id="h0001">Technical Field</heading>
<p id="p0001" num="0001">The present disclosure relates to a phase measurement method, a signal processing apparatus, and a program for calculating the phase of scattered light from a fiber to be measured.</p>
<heading id="h0002">Background Art</heading>
<p id="p0002" num="0002">A phase OTDR method is known as a means for measuring a physical vibration applied to an optical fiber in a distributed manner in a longitudinal direction of the optical fiber (see, for example, Non Patent Literature 1).</p>
<p id="p0003" num="0003">In the phase OTDR, pulsed light is incident on an optical fiber to be measured and the phase of scattered light at the time t when the pulsed light is incident is measured in a distributed manner in the longitudinal direction of the optical fiber. That is, the phase θ(l, t) of scattered light is measured with respect to a distance 1 from a far end of the optical fiber. By repeatedly injecting the pulsed light into the optical fiber to be measured at time intervals T, a change with time θ(l, nT) of the phase of scattered light at time t = nT where n is an integer is measured for each point in the longitudinal direction of the optical fiber to be measured. It is known that the magnitude of a physical vibration applied to a section from the distance 1 to a distance l + δt at each time nT is proportional to the difference δθ(l, nT) between the phase θ(l + δl, nT) at the distance 1 + δl and the phase θ(l, nT) at the distance 1. That is, the magnitude of the physical vibration with reference to time 0 is given as follows.</p>
<heading id="h0003">[Formula 1]</heading>
<p id="p0004" num="0004"><maths id="math0001" num="(1)"><math display="block"><mtable columnalign="left"><mtr><mtd><mfenced separators=""><mi>Magnitude</mi><mspace width="1ex"/><mi>of</mi><mspace width="1ex"/><mi>vibration</mi></mfenced><mo>∝</mo><mi mathvariant="italic">δθ</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>−</mo><mi mathvariant="italic">δθ</mi><mfenced><mi>l</mi><mn>0</mn></mfenced></mtd></mtr><mtr><mtd><mrow><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/></mrow><mo>=</mo><mfenced open="[" close="]" separators=""><mi>θ</mi><mfenced separators=""><mi>l</mi><mo>+</mo><mi mathvariant="italic">δl</mi><mo>,</mo><mi mathvariant="italic">nT</mi></mfenced><mo>−</mo><mi>θ</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced><mo>−</mo><mfenced open="[" close="]" separators=""><mi>θ</mi><mfenced separators=""><mi>l</mi><mo>+</mo><mi mathvariant="italic">δl</mi><mo>,</mo><mn>0</mn></mfenced><mo>−</mo><mi>θ</mi><mfenced><mi>l</mi><mn>0</mn></mfenced></mfenced></mtd></mtr><mtr><mtd><mrow><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/></mrow><mo>=</mo><mfenced open="[" close="]" separators=""><mi>θ</mi><mfenced separators=""><mi>l</mi><mo>+</mo><mi mathvariant="italic">δl</mi><mo>,</mo><mi mathvariant="italic">nT</mi></mfenced><mo>−</mo><mi>θ</mi><mfenced separators=""><mi>l</mi><mo>+</mo><mi mathvariant="italic">δl</mi><mo>,</mo><mn>0</mn></mfenced></mfenced><mo>−</mo><mfenced open="[" close="]" separators=""><mi>θ</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>−</mo><mi>θ</mi><mfenced><mi>l</mi><mn>0</mn></mfenced></mfenced></mtd></mtr></mtable></math><img id="ib0001" file="imgb0001.tif" wi="153" he="22" img-content="math" img-format="tif"/></maths></p>
<p id="p0005" num="0005">There are a plurality of phase OTDR configurations for measuring the phase θ(l, nT), among which a coherent OTDR (C-OTDR) that uses coherent detection with a mixture of signal light scattered from an optical fiber to be measured and local light can perform measurement with a high SN ratio.</p>
<p id="p0006" num="0006">Mechanisms for performing coherent detection and calculating the phase are subdivided into two types, a software-based processing mechanism using a Hilbert transform and a hardware-based processing mechanism using a 90-degree optical hybrid.</p>
<p id="p0007" num="0007">In the software-based processing mechanism using the Hilbert transform, local light and signal light scattered from an optical fiber to be measured are incident on two inputs of a 50:50 coupler having the two inputs and two outputs, respectively, and light beams emitted from the two outputs are detected through balanced detection (see, for example, Non Patent Literature 2).<!-- EPO <DP n="2"> --></p>
<p id="p0008" num="0008">Assuming that the detected signal is an in-phase component 1(1, nT), the entire in-phase component is Hilbert transformed to calculate a quadrature component Q(l, nT). That is, the quadrature component Q(l, nT) is calculated as follows.</p>
<heading id="h0004">[Formula 2]</heading>
<p id="p0009" num="0009"><maths id="math0002" num="(2)"><math display="block"><mi>Q</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><msub><mi mathvariant="italic">HT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><mi>I</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></math><img id="ib0002" file="imgb0002.tif" wi="133" he="5" img-content="math" img-format="tif"/></maths> Here, HT[*] is defined as a Hilbert operator that delays each frequency component of * by 90 degrees. The subscript of the operator represents a variable with respect to which the operation is performed. For example, HT<sub>x</sub>[cos(kx)sin(ωt)] gives sin(kx)sin(ωt).</p>
<p id="p0010" num="0010">A calculated phase value θ<sub>cal</sub>(l, nT) is calculated as the angle of a vector (x, y) = (1(1, nT), Q(l, nT)) on an xy plane with the in-phase component on the x axis and the quadrature component on the y axis. That is, the calculated phase value θ<sub>cal</sub>(l, nT) is calculated as follows.</p>
<heading id="h0005">[Formula 3]</heading>
<p id="p0011" num="0011"><maths id="math0003" num="(3)"><math display="block"><msub><mi>θ</mi><mi mathvariant="italic">cal</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mrow><mi>Q</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow><mrow><mi>I</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow></mfrac></mfenced></math><img id="ib0003" file="imgb0003.tif" wi="132" he="11" img-content="math" img-format="tif"/></maths> However, there is an uncertainty of 2mπ in the calculated phase value θ<sub>cal</sub>(l, nT) because the output value of a four-quadrant inverse tangent operator Arctan is in a range of (-π, π] in radians and all phase values of 2mπ + θ(l, nT) correspond to the same vector direction on the xy plane, where m is any integer. Thus, signal processing such as phase unwrapping is further performed as a method of more accurately evaluating θ(l, nT). In typical phase unwrapping, if a value given by Expression (4b) where p is any integer is greater than π radians for an unwrapped phase given by Expression (4a), an appropriate integer q which makes a value given by Expression (4c) less than or equal to π radians is selected to calculate an unwrapped phase of Expression (4d) using Equation (4) as follows.</p>
<heading id="h0006">[Formula 4a]</heading>
<p id="p0012" num="0012"><maths id="math0004" num="(4a)"><math display="block"><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">unwrap</mi></msubsup></math><img id="ib0004" file="imgb0004.tif" wi="130" he="5" img-content="math" img-format="tif"/></maths></p>
<heading id="h0007">[Formula 4b]</heading>
<p id="p0013" num="0013"><maths id="math0005" num="(4b)"><math display="block"><mfenced open="|" close="|" separators=""><msub><mi>θ</mi><mi mathvariant="italic">cal</mi></msub><mfenced separators=""><mi>l</mi><mo>,</mo><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>−</mo><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">unwrap</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">pT</mi></mfenced></mfenced></math><img id="ib0005" file="imgb0005.tif" wi="130" he="6" img-content="math" img-format="tif"/></maths></p>
<heading id="h0008">[Formula 4c]</heading>
<p id="p0014" num="0014"><maths id="math0006" num="(4c)"><math display="block"><mfenced open="|" close="|" separators=""><msub><mi>θ</mi><mi mathvariant="italic">cal</mi></msub><mfenced separators=""><mi>l</mi><mo>,</mo><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>+</mo><mn>2</mn><mi mathvariant="italic">πq</mi><mo>−</mo><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">unwrap</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">pT</mi></mfenced></mfenced></math><img id="ib0006" file="imgb0006.tif" wi="131" he="6" img-content="math" img-format="tif"/></maths></p>
<heading id="h0009">[Formula 4d]</heading>
<p id="p0015" num="0015"><maths id="math0007" num="(4d)"><math display="block"><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">unwrap</mi></msubsup><mfenced separators=""><mi>l</mi><mo>,</mo><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced></math><img id="ib0007" file="imgb0007.tif" wi="131" he="5" img-content="math" img-format="tif"/></maths></p>
<heading id="h0010">[Formula 4]</heading>
<p id="p0016" num="0016"><maths id="math0008" num="(4)"><math display="block"><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">unwrap</mi></msubsup><mfenced separators=""><mi>l</mi><mo>,</mo><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>=</mo><msub><mi>θ</mi><mi mathvariant="italic">cal</mi></msub><mfenced separators=""><mi>l</mi><mo>,</mo><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>+</mo><mn>2</mn><mi mathvariant="italic">πq</mi></math><img id="ib0008" file="imgb0008.tif" wi="132" he="6" img-content="math" img-format="tif"/></maths> The superscript unwrap indicates that the phase has been unwrapped.</p>
<p id="p0017" num="0017">In the hardware-based processing mechanism using the 90-degree optical hybrid, local light and signal light scattered from an optical fiber to be measured are incident on a component which is called a 90-degree optical hybrid, and as outputs from two balanced detectors, an in-phase component 1(1, nT) and a quadrature component Q(l, nT) are directly acquired (see, for<!-- EPO <DP n="3"> --> example, Non Patent Literature 3). Subsequent phase calculation is the same as the above calculation.</p>
<p id="p0018" num="0018">The hardware-based processing mechanism using the 90-degree optical hybrid is used for applications such as not only offline processing but also real-time measurement because the in-phase component 1(1, nT) and the quadrature component Q(l, nT) can be measured directly and simultaneously.</p>
<heading id="h0011">Citation List</heading>
<heading id="h0012">Non Patent Literature</heading>
<p id="p0019" num="0019">
<ul id="ul0001" list-style="none" compact="compact">
<li>Non Patent Literature 1: <nplcit id="ncit0001" npl-type="s"><text>Ali. Masoudi, T. P. Newson, "Contributed Rview: Distributed optical fibre dynamic strain sensing", Review of Scientific Instruments, vol. 87, pp011501 (2016</text></nplcit>)</li>
<li>Non Patent Literature 2: <nplcit id="ncit0002" npl-type="s"><text>Xinyu Fan et al., "Distributed Fiber-Optic Vibration Sensing Based on Phase Extraction From Optical Reflectometry", Journal of Lightwave Technology, vol. 35, no. 16 pp3281 (2017</text></nplcit>)</li>
<li>Non Patent Literature 3: <nplcit id="ncit0003" npl-type="s"><text>Zinan Wang et al., "Coherent Φ-OTDR based on I/Q demodulation and homodyne detection", Optics Express, vol. 24, no. 2, pp853 (2016</text></nplcit>)</li>
</ul></p>
<heading id="h0013">Summary of the Invention</heading>
<heading id="h0014">Technical Problem</heading>
<p id="p0020" num="0020">Compared to the software-based processing mechanism using the Hilbert transform, the hardware-based processing mechanism using the 90-degree optical hybrid reduces the intensity of light incident on the balanced detector, which increases the deterioration of the SN ratio. This increases the uncertainty of the calculated phase and deteriorates the sensitivity of phase measurement. In addition, due to the increase in the uncertainty of the calculated phase, the number of points where the integer q is incorrectly selected increases in the unwrapping processing shown in Equation (4) and phase value differences of 2π or more which do not actually exist occur across the points where the integer q is incorrectly selected. Such phase value differences lead to incorrect recognition that a large physical force has been applied to the optical fiber when the magnitude of the vibration is calculated using Expression (1). That is, the hardware-based processing mechanism using the 90-degree optical hybrid has a problem in the SN ratio although it is necessary to use the hardware-based processing mechanism for performing real-time measurement in addition to offline processing.</p>
<p id="p0021" num="0021">An object of the present invention to solve the above problems is to provide a phase measurement method, a signal processing apparatus, and a program that enable both real-time measurement and offline measurement with a high SN ratio of the phase of scattered light from an optical fiber.<!-- EPO <DP n="4"> --></p>
<heading id="h0015">Means for Solving the Problem</heading>
<p id="p0022" num="0022">In order to achieve the above object, the phase measurement method and the signal processing apparatus according to the present invention perform coherent detection of scattered light using a 90-degree optical hybrid, obtain an estimated quadrature component value by averaging a measured quadrature component value that is directly measured and a calculated quadrature component value obtained by Hilbert transforming a measured in-phase component value that is directly measured, obtain an estimated in-phase component value by averaging the measured in-phase component value and a calculated in-phase component value obtained by inverse Hilbert transforming the measured quadrature component value, and calculate the phase of scattered light based on the estimated quadrature component value and the estimated in-phase component value.</p>
<p id="p0023" num="0023">Specifically, the phase measuring method according to the present invention is a phase measurement method for measuring a phase of scattered light from a fiber to be measured, the phase measurement method including acquiring a measured in-phase component value and a measured quadrature component value of a signal obtained by coherently detecting the scattered light through a 90-degree optical hybrid, Hilbert transforming the measured in-phase component value to acquire a calculated quadrature component value and inverse Hilbert transforming the measured quadrature component value to acquire a calculated in-phase component value, averaging the measured in-phase component value and the calculated in-phase component value to acquire an estimated in-phase component value and averaging the measured quadrature component value and the calculated quadrature component value to acquire an estimated quadrature component value, and calculating a four-quadrant inverse tangent of a quotient obtained by dividing the estimated quadrature component value by the estimated in-phase component value.</p>
<p id="p0024" num="0024">Further, the signal processing apparatus according to the present invention includes a signal input unit that receives, as inputs, a measured in-phase component value and a measured quadrature component value of a signal obtained by coherently detecting scattered light from a fiber to be measured through a 90-degree optical hybrid, a transform unit that Hilbert transforms the measured in-phase component value to acquire a calculated quadrature component value and inverse Hilbert transforms the measured quadrature component value to acquire a calculated in-phase component value, an estimation unit that averages the measured in-phase component value and the calculated in-phase component value to acquire an estimated in-phase component value and averages the measured quadrature component value and the calculated quadrature component value to acquire an estimated quadrature component value, and a calculation unit that calculates a four-quadrant inverse tangent of a quotient obtained by dividing the estimated quadrature component value by the estimated in-phase component value.</p>
<p id="p0025" num="0025">By calculating the phase of scattered light using the estimated quadrature component value and the estimated in-phase component value as described above, it is possible to reduce the<!-- EPO <DP n="5"> --> variation of the measured value to 1/√2. This can reduce the SN ratio of offline measurement. Real-time measurement is also possible because the 90-degree hybrid is used. Therefore, the present invention can provide a phase measurement method and a signal processing apparatus that enable both real-time measurement and offline measurement with a high SN ratio of the phase of scattered light from an optical fiber.</p>
<p id="p0026" num="0026">The phase measurement method according to the present invention is characterized by further including performing phase unwrapping processing on the four-quadrant inverse tangent. The signal processing apparatus according to the present invention is characterized by further including a phase unwrapping processing unit that performs phase unwrapping processing on the four-quadrant inverse tangent.</p>
<p id="p0027" num="0027">Because the SN ratio of the offline measurement can be reduced, a phase with less uncertainty can be used in the phase unwrapping processing and the probability of occurrence of points where the integer q is incorrectly selected can be reduced.</p>
<p id="p0028" num="0028">The present invention provides a program for causing a computer to operate as the signal processing apparatus. The signal processing apparatus of the present invention can also be implemented by the computer and the program and the program can be recorded on a recording medium or provided through a network.</p>
<heading id="h0016">Effects of the Invention</heading>
<p id="p0029" num="0029">The present invention can provide a phase measurement method, a signal processing apparatus, and a program that enable both real-time measurement and offline measurement with a high SN ratio of the phase of scattered light from an optical fiber.</p>
<heading id="h0017">Brief Description of Drawings</heading>
<p id="p0030" num="0030">
<ul id="ul0002" list-style="none" compact="compact">
<li><figref idref="f0001">Fig. 1</figref> is a diagram illustrating a C-OTDR including a signal processing apparatus according to the present invention.</li>
<li><figref idref="f0001">Fig. 2</figref> is a diagram illustrating a phase calculation result of scattered light obtained through a method of the related art.</li>
<li><figref idref="f0002">Fig. 3</figref> is a diagram illustrating a phase calculation result of scattered light obtained through a phase measurement method according to the present invention.</li>
<li><figref idref="f0002">Fig. 4</figref> is a diagram illustrating a result of performing phase unwrapping processing using the phase calculation result of scattered light obtained through the method of the related art.</li>
<li><figref idref="f0003">Fig. 5</figref> is a diagram illustrating a result of performing phase unwrapping processing using the phase calculation result of scattered light obtained through the phase measurement method according to the present invention.</li>
<li><figref idref="f0004">Fig. 6</figref> is a diagram illustrating the signal processing apparatus according to the present invention.</li>
<li><figref idref="f0005">Fig. 7</figref> is a flowchart illustrating the phase measurement method according to the present invention.</li>
</ul><!-- EPO <DP n="6"> --></p>
<heading id="h0018">Description of Embodiments</heading>
<p id="p0031" num="0031">Embodiments of the present invention will be described with reference to the accompanying drawings. The embodiments described below are examples of the present invention and the present invention is not limited to the embodiments described below. In the present specification and the drawings, components with the same reference signs indicate the same components.</p>
<heading id="h0019">Phase Measurement Method for Scattered Light</heading>
<p id="p0032" num="0032"><figref idref="f0001">Fig. 1</figref> is a diagram illustrating a configuration of a C-OTDR which uses a hardware-based processing mechanism using a 90-degree optical hybrid for a receiving system.</p>
<p id="p0033" num="0033">Continuous light of a single wavelength is emitted from a continuous wave (CW) light source 1 and is split into local light and probe light by a coupler 2. The probe light is pulsed by an intensity modulator 3 and is changed in frequency by a frequency shifter 4. Any type of the intensity modulator or the frequency shifter may be used, a plurality of intensity modulators or frequency shifters may be provided, and a device into which the functions of the intensity modulator and the frequency shifter are integrated may also be used. For example, pulsing and frequency shifting using an LN modulator or an AO modulator is possible. A configuration in which the amount of frequency shift by the frequency shifter is zero, that is, there is no frequency shifter, may also be used. The pulsed probe light is incident on an optical fiber to be measured 6 via a circulator 5. Light scattered at each point in the longitudinal direction of the optical fiber 6 returns to the circulator 5 as backscattered light and is incident on one input of a 90-degree optical hybrid 7. The local light obtained through splitting by the coupler 2 is incident on another input of the 90-degree optical hybrid 7.</p>
<p id="p0034" num="0034">The 90-degree optical hybrid may have any internal configuration as long as it has the functionality of the 90-degree optical hybrid. An exemplary configuration is illustrated in <figref idref="f0001">Fig. 1</figref>. The backscattered light is incident on a coupler 8 having a split ratio of 50:50 and the split beams of the scattered light are incident on an input of a coupler 12 having a split ratio of 50:50 and an input of a coupler 11 having a 50:50 ratio. The local light is incident on a coupler 9 having a split ratio of 50:50 and one of the two split beams of the local light is directly incident on an input of the coupler 11. The other of the two split beams of the local light is incident on an input of the coupler 12 after being phase-shifted by a phase shifter 10 which shifts the phase by π/2 at the wavelength of the local light. A balanced detector 13 detects two outputs of the coupler 11 to acquire an electrical signal 15 which is an in-phase component. A balanced detector 14 detects two outputs of the coupler 12 to acquire an electrical signal 16 which is a quadrature component. The electrical signals 15 and 16 are sent to a signal processing apparatus 17 that includes an AD conversion functional element 17a and an AD conversion functional element 17b, each of which can sample the frequency band of a signal without aliasing. In the signal processing apparatus 17, a signal processing unit 17c calculates a phase based on digitized signals of the in-phase and<!-- EPO <DP n="7"> --> quadrature components respectively output from the AD conversion functional elements 17a and 17b.</p>
<p id="p0035" num="0035">The signal 15 is a measured value I<sub>measure</sub>(l, nT) which corresponds to a noise-free in-phase component 1(1, nT) with noise added. The signal 16 is a measured value Q<sub>measure</sub>(l, nT) which corresponds to a noise-free quadrature component Q(l, nT) with noise added. That is, when N<sub>I</sub> and N<sub>Q</sub> are noise superimposed on the in-phase and quadrature components respectively, I<sub>measure</sub>(l, nT) and Q<sub>measure</sub>(l, nT) are given as follows.</p>
<heading id="h0020">[Formula 5]</heading>
<p id="p0036" num="0036"><maths id="math0009" num="(5)"><math display="block"><msub><mi>I</mi><mi mathvariant="italic">measure</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><mi>I</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msub><mi>N</mi><mi>I</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></math><img id="ib0009" file="imgb0009.tif" wi="131" he="5" img-content="math" img-format="tif"/></maths></p>
<heading id="h0021">[Formula 6]</heading>
<p id="p0037" num="0037"><maths id="math0010" num="(6)"><math display="block"><msub><mi>Q</mi><mi mathvariant="italic">measure</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><mi>Q</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msub><mi>N</mi><mi>Q</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></math><img id="ib0010" file="imgb0010.tif" wi="131" he="5" img-content="math" img-format="tif"/></maths> Here, because the in-phase and quadrature components are detected by the separate balanced detectors, N<sub>I</sub> and N<sub>Q</sub> are waveforms that are independent of each other and not correlated with each other.</p>
<p id="p0038" num="0038">The signal processing apparatus 17 calculates the phase of the scattered light from the measured in-phase and quadrature components as follows.</p>
<heading id="h0022">[Formula 7]</heading>
<p id="p0039" num="0039"><maths id="math0011" num="(7)"><math display="block"><msub><mi>θ</mi><mi mathvariant="italic">cal</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mrow><msub><mi>Q</mi><mi mathvariant="italic">measure</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow><mrow><msub><mi>I</mi><mi mathvariant="italic">measure</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow></mfrac></mfenced><mo>=</mo><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mrow><mi>Q</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msub><mi>N</mi><mi>Q</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow><mrow><mi>I</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msub><mi>N</mi><mi>I</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow></mfrac></mfenced></math><img id="ib0011" file="imgb0011.tif" wi="131" he="10" img-content="math" img-format="tif"/></maths> Presence of the noise N<sub>I</sub> and N<sub>Q</sub> causes uncertainty at a position pointed to by the vector (x, y) of Equation (7a) on the xy plane with the in-phase component on the x axis and the quadrature component on the y axis and also causes uncertainty in the phase which corresponds to the direction indicated by the vector.</p>
<heading id="h0023">[Formula 7a]</heading>
<p id="p0040" num="0040"><maths id="math0012" num="(7a)"><math display="block"><mfenced><mi>x</mi><mi>y</mi></mfenced><mo>=</mo><mfenced separators=""><msub><mi>I</mi><mi mathvariant="italic">measure</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>,</mo><mspace width="1ex"/><msub><mi>Q</mi><mi mathvariant="italic">measure</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></math><img id="ib0012" file="imgb0012.tif" wi="129" he="6" img-content="math" img-format="tif"/></maths></p>
<p id="p0041" num="0041">For example, if there is no noise, the calculated phase value θ<sub>cal</sub>(l, nT) does not change with time and has a constant value for each 1 in a state where no vibration is applied to the optical fiber. However, if there is noise, the calculated phase value θ<sub>cal</sub>(l, nT) changes with time for each 1 even when no vibration is applied to the optical fiber. This situation is illustrated in <figref idref="f0001">Fig. 2</figref>. When a vector at a certain position l<sub>0</sub> shown in Expression (7b) is plotted on the xy plane, Equation (7c) indicated by the vector 201 is always constant, and the angle 202 of the vector 201 also does not change with time if there is no noise.</p>
<heading id="h0024">[Formula 7b]</heading>
<p id="p0042" num="0042"><maths id="math0013" num="(7b)"><math display="block"><mfenced separators=""><msub><mi>I</mi><mi mathvariant="italic">measure</mi></msub><mfenced><msub><mi>l</mi><mn>0</mn></msub><mi mathvariant="italic">nT</mi></mfenced><mo>,</mo><mspace width="1ex"/><msub><mi>Q</mi><mi mathvariant="italic">measure</mi></msub><mfenced><msub><mi>l</mi><mn>0</mn></msub><mi mathvariant="italic">nT</mi></mfenced></mfenced></math><img id="ib0013" file="imgb0013.tif" wi="129" he="5" img-content="math" img-format="tif"/></maths></p>
<heading id="h0025">[Formula 7c]</heading>
<p id="p0043" num="0043"><maths id="math0014" num="(7c)"><math display="block"><mfenced><mi>x</mi><mi>y</mi></mfenced><mo>=</mo><mfenced separators=""><mi>I</mi><mfenced><msub><mi>l</mi><mn>0</mn></msub><mi mathvariant="italic">nT</mi></mfenced><mo>,</mo><mspace width="1ex"/><mi>Q</mi><mfenced><msub><mi>l</mi><mn>0</mn></msub><mi mathvariant="italic">nT</mi></mfenced></mfenced></math><img id="ib0014" file="imgb0014.tif" wi="131" he="6" img-content="math" img-format="tif"/></maths></p>
<p id="p0044" num="0044">However, because noise is actually present, a vector having in-phase and quadrature components at each time, like a vector 203, differs from the vector 201 and its angle 204 also<!-- EPO <DP n="8"> --> differs from the angle 202. Therefore, vectors having actually measured values vary around the vector 201. The degree of variation can be evaluated using a standard deviation of measured values in each axial direction. For example, in the direction of the x axis, there is uncertainty corresponding to a standard deviation σ(N<sub>I</sub>) of noise N<sub>I</sub> indicated by 205 due to the variation of the x components of measured values. For coherent detection, the intensity of local light is sufficiently increased such that shot noise becomes dominant and the noise distribution can be approximated by a normal distribution. Because the intensities of light beams incident on the two balanced detectors 13 and 14 in <figref idref="f0001">Fig. 1</figref> can be regarded as about the same, the standard deviations of the noise N<sub>I</sub> and N<sub>Q</sub> can also be regarded as having the same magnitude and the uncertainty forms a circle centered on the vector 201. Even when noise posterior to an electric stage such as thermal noise of a PD cannot be ignored, noise characteristics of the two balanced detectors 13 and 14 can be regarded as the same, such that the uncertainty may be considered to be a circle centered on the vector 201.</p>
<heading id="h0026">First Embodiment</heading>
<p id="p0045" num="0045">A method for calculating the phase with less uncertainty than the phase calculated using Equation (7) using the acquired I<sub>measure</sub>(l, nT) and Q<sub>measure</sub>(l, nT) will be described below.</p>
<p id="p0046" num="0046"><figref idref="f0004">Fig. 6</figref> is a diagram illustrating the signal processing unit 17c of the present embodiment. That is, in the present embodiment, the signal processing unit 17c of <figref idref="f0001">Fig. 1</figref> includes a signal input unit 51 that receives, as inputs, a measured in-phase component value and a measured quadrature component value of a signal obtained by coherently detecting scattered light from a fiber to be measured 6 through a 90-degree optical hybrid 7, a transform unit 52 that Hilbert transforms the measured in-phase component value to acquire a calculated quadrature component value and inverse Hilbert transforms the measured quadrature component value to acquire a calculated in-phase component value, an estimation unit 53 that averages the measured in-phase component value and the calculated in-phase component value to acquire an estimated in-phase component value and averages the measured quadrature component value and the calculated quadrature component value to acquire an estimated quadrature component value, and a calculation unit 54 that calculates a four-quadrant inverse tangent of a quotient obtained by dividing the estimated quadrature component value by the estimated in-phase component value. The signal processing unit 17c may further include a phase unwrapping processing unit that performs phase unwrapping processing on the four-quadrant inverse tangent.</p>
<p id="p0047" num="0047"><figref idref="f0005">Fig. 7</figref> is a diagram illustrating a method of measuring the phase of scattered light from the optical fiber to be measured 6 by a C-OTDR including the signal processing unit 17c of the present embodiment. This method is a phase measurement method for measuring a phase of scattered light from the fiber to be measured 6, the phase measurement method including a detection procedure S01 of acquiring a measured in-phase component value and a measured quadrature component value of a signal obtained by coherently detecting the scattered light through a 90-degree optical hybrid 7, a transform procedure S02 of Hilbert transforming the<!-- EPO <DP n="9"> --> measured in-phase component value to acquire a calculated quadrature component value and inverse Hilbert transforming the measured quadrature component value to acquire a calculated in-phase component value, an estimation procedure S03 of averaging the measured in-phase component value and the calculated in-phase component value to acquire an estimated in-phase component value and averaging the measured quadrature component value and the calculated quadrature component value to acquire an estimated quadrature component value, and a calculation procedure S04 of calculating a four-quadrant inverse tangent of a quotient obtained by dividing the estimated quadrature component value by the estimated in-phase component value.<br/>
The phase measurement method may further include a phase unwrapping processing procedure of performing phase unwrapping processing on the four-quadrant inverse tangent.</p>
<p id="p0048" num="0048">The transform unit 52 performs the transform procedure S02 as follows.<br/>
The transform unit 52 Hilbert transforms the measured in-phase component value I<sub>measure</sub>(l, nT) with respect to 1 to obtain a calculated quadrature component value of Expression (8a).</p>
<heading id="h0027">[Formula 8a]</heading>
<p id="p0049" num="0049"><maths id="math0015" num="(8a)"><math display="block"><msubsup><mi>Q</mi><mi mathvariant="italic">measure</mi><mi mathvariant="italic">HT</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></math><img id="ib0015" file="imgb0015.tif" wi="133" he="5" img-content="math" img-format="tif"/></maths> The calculated quadrature component value can be expanded as follows.</p>
<heading id="h0028">[Formula 8]</heading>
<p id="p0050" num="0050"><maths id="math0016" num="(8)"><math display="block"><mtable><mtr><mtd><mrow><msubsup><mi>Q</mi><mi mathvariant="italic">measure</mi><mi mathvariant="italic">HT</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><msub><mi mathvariant="italic">HT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><msub><mi>I</mi><mi mathvariant="italic">measure</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></mrow></mtd></mtr><mtr><mtd><mrow><mo>=</mo><msub><mi mathvariant="italic">HT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><mi>I</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced><mo>+</mo><msub><mi mathvariant="italic">HT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><msub><mi>N</mi><mi>I</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></mrow></mtd></mtr><mtr><mtd><mrow><mo>=</mo><mi>Q</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msub><mi mathvariant="italic">HT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><msub><mi>N</mi><mi>I</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></mrow></mtd></mtr></mtable></math><img id="ib0016" file="imgb0016.tif" wi="131" he="22" img-content="math" img-format="tif"/></maths></p>
<p id="p0051" num="0051">In Equation (8), it is assumed that the Hilbert transform HT<sub>l</sub>[I(l, nT)] of the in-phase component without noise matches the quadrature component Q(l, nT) obtained when there is no noise. However, actually, it is necessary to consider a calculation error due to the Hilbert transform. The Hilbert transform does not cause an error due to aliasing, but causes an error due to calculation with the signal being cut into a finite interval. In addition, the transfer function of the Hilbert transform exhibits an infinite response because it is discontinuous at the position where the frequency is zero, but in actual calculation, causes an error due to approximating the infinite response by a finite response.</p>
<p id="p0052" num="0052">However, such errors can be made sufficiently small as described below. First, the shape of the carrier envelope of the probe light incident on the fiber to be measured 6 can be approximated by a rectangle. In this case, the scattered light from the fiber to be measured 6 becomes a signal with a time length of at most about 2 L/c, where the length of the fiber to be measured 6 is L and the speed of light in the fiber is c. Thus, the error that occurs when the length for measuring the signal is not sufficient can be made negligible by measuring the scattered light for a time longer than or equal to 2 L/c. In addition, the error due to approximating the response can be made sufficiently small compared to noise by making the<!-- EPO <DP n="10"> --> finite response (FIR) used for processing sufficiently long or by performing processing equivalent to this.</p>
<p id="p0053" num="0053">In the Hilbert transform of the actual signal processing apparatus 17, the error due to the Hilbert transform can be made negligible compared to noise by making the signal sufficiently long and making the FIR used for the processing sufficiently long or by performing processing equivalent to this.</p>
<p id="p0054" num="0054">The estimation unit 53 performs the estimation procedure S03 as follows.<br/>
The estimation unit 53 calculates an average value of the calculated quadrature component value of Expression (8a) and the actually measured quadrature component value Q<sub>measure</sub>(l, nT) using Equation (9) to obtain an estimated quadrature component value.</p>
<heading id="h0029">[Formula 9]</heading>
<p id="p0055" num="0055"><maths id="math0017" num="(9)"><math display="block"><msubsup><mi>Q</mi><mi mathvariant="italic">measure</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><mi>Q</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><mfrac><mrow><msub><mi>N</mi><mi>Q</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msub><mi mathvariant="italic">HT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><msub><mi>N</mi><mi>I</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></mrow><mn>2</mn></mfrac><mo>=</mo><mi>Q</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msubsup><mi>N</mi><mi>Q</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></math><img id="ib0017" file="imgb0017.tif" wi="136" he="9" img-content="math" img-format="tif"/></maths></p>
<p id="p0056" num="0056">Because N<sub>I</sub> and N<sub>Q</sub> are waveforms that are independent of each other and not correlated with each other, N<sub>Q</sub> and HT<sub>l</sub>[N<sub>I</sub>] are also waveforms that are independent of each other and not correlated with each other. Thus, the standard deviation (Expression (9b)) of noise (Expression (9a)) which is given as the average of N<sub>Q</sub> and HT<sub>l</sub>[N<sub>I</sub>] has a magnitude of about σ/√2, where the standard deviations of both N<sub>I</sub> and N<sub>Q</sub> are σ.</p>
<heading id="h0030">[Formula 9a]</heading>
<p id="p0057" num="0057"><maths id="math0018" num="(9a)"><math display="block"><msubsup><mi>N</mi><mi>Q</mi><mi mathvariant="italic">new</mi></msubsup></math><img id="ib0018" file="imgb0018.tif" wi="134" he="5" img-content="math" img-format="tif"/></maths></p>
<heading id="h0031">[Formula 9b]</heading>
<p id="p0058" num="0058"><maths id="math0019" num="(9b)"><math display="block"><mi mathvariant="normal">σ</mi><mfenced><msubsup><mi>N</mi><mi>Q</mi><mi mathvariant="italic">new</mi></msubsup></mfenced></math><img id="ib0019" file="imgb0019.tif" wi="135" he="6" img-content="math" img-format="tif"/></maths></p>
<p id="p0059" num="0059">The transform unit 52 also performs the transform procedure S02 for the quadrature component.<br/>
The transform unit 52 performs an inverse Hilbert transform on the measured quadrature component value Q<sub>measure</sub>(l, nT) with respect to 1 to obtain a calculated in-phase component value of Expression (10a).</p>
<heading id="h0032">[Formula 10a]</heading>
<p id="p0060" num="0060"><maths id="math0020" num="(10a)"><math display="block"><msubsup><mi>I</mi><mi mathvariant="italic">measure</mi><mi mathvariant="italic">IHT</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></math><img id="ib0020" file="imgb0020.tif" wi="129" he="5" img-content="math" img-format="tif"/></maths> The calculated in-phase component value can be expanded as follows.</p>
<heading id="h0033">[Formula 10]</heading>
<p id="p0061" num="0061"><maths id="math0021" num="(10)"><math display="block"><mtable><mtr><mtd><mrow><msubsup><mi>I</mi><mi mathvariant="italic">measure</mi><mi mathvariant="italic">IHT</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><msub><mi mathvariant="italic">IHT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><msub><mi>Q</mi><mi mathvariant="italic">measure</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></mrow></mtd></mtr><mtr><mtd><mrow><mo>=</mo><msub><mi mathvariant="italic">IHT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><mi>Q</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced><mo>+</mo><msub><mi mathvariant="italic">IHT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><msub><mi>N</mi><mi>Q</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></mrow></mtd></mtr><mtr><mtd><mrow><mo>=</mo><mi>I</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msub><mi mathvariant="italic">IHT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><msub><mi>N</mi><mi>Q</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></mrow></mtd></mtr></mtable></math><img id="ib0021" file="imgb0021.tif" wi="128" he="22" img-content="math" img-format="tif"/></maths> Here, IHT[*] is defined as an inverse Hilbert operator that advances the phase of each frequency component of * by 90 degrees. The subscript of the operator represents a variable with respect to which the operation is performed.<!-- EPO <DP n="11"> --></p>
<p id="p0062" num="0062">The estimation unit 53 performs the estimation procedure S03 for the in-phase component in the same manner.<br/>
The estimation unit 53 calculates an average value of the calculated in-phase component value of Expression (10a) and the actually measured in-phase component value I<sub>measure</sub>(l, nT) using Equation (11) to obtain an estimated in-phase component value.</p>
<heading id="h0034">[Formula 11]</heading>
<p id="p0063" num="0063"><maths id="math0022" num="(11)"><math display="block"><msubsup><mi>I</mi><mi mathvariant="italic">measure</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><mi>I</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><mfrac><mrow><msub><mi>N</mi><mi>I</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msub><mi mathvariant="italic">IHT</mi><mi>l</mi></msub><mfenced open="[" close="]" separators=""><msub><mi>N</mi><mi>Q</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></mrow><mn>2</mn></mfrac><mo>=</mo><mi>I</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msubsup><mi>N</mi><mi>I</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></math><img id="ib0022" file="imgb0022.tif" wi="136" he="9" img-content="math" img-format="tif"/></maths></p>
<p id="p0064" num="0064">The standard deviation (Expression (11b)) of noise (Expression (11a)) which is given as the average of N<sub>I</sub> and IHT<sub>l</sub>[N<sub>Q</sub>] has a magnitude of about 1/√2 relative to the original standard deviation σ of noise in the measurement of the in-phase component.</p>
<heading id="h0035">[Formula 11a]</heading>
<p id="p0065" num="0065"><maths id="math0023" num="(11a)"><math display="block"><msubsup><mi>N</mi><mi>I</mi><mi mathvariant="italic">new</mi></msubsup></math><img id="ib0023" file="imgb0023.tif" wi="134" he="5" img-content="math" img-format="tif"/></maths></p>
<heading id="h0036">[Formula 11b]</heading>
<p id="p0066" num="0066"><maths id="math0024" num="(11b)"><math display="block"><mi mathvariant="normal">σ</mi><mfenced><msubsup><mi>N</mi><mi>I</mi><mi mathvariant="italic">new</mi></msubsup></mfenced></math><img id="ib0024" file="imgb0024.tif" wi="134" he="5" img-content="math" img-format="tif"/></maths></p>
<p id="p0067" num="0067">Using the estimated in-phase component value of Equation (11) and the estimated quadrature component value of Equation (9) that have been newly calculated, the phase of scattered light is calculated as follows.</p>
<heading id="h0037">[Formula 12]</heading>
<p id="p0068" num="0068"><maths id="math0025" num="(12)"><math display="block"><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mrow><msubsup><mi>Q</mi><mi mathvariant="italic">measured</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow><mrow><msubsup><mi>I</mi><mi mathvariant="italic">measured</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow></mfrac></mfenced><mo>=</mo><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mrow><mi>Q</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msubsup><mi>N</mi><mi>Q</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow><mrow><mi>I</mi><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msubsup><mi>N</mi><mi>I</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow></mfrac></mfenced></math><img id="ib0025" file="imgb0025.tif" wi="133" he="10" img-content="math" img-format="tif"/></maths></p>
<p id="p0069" num="0069">The uncertainty of the phase of scattered light newly calculated using Equation (12) is smaller than the uncertainty of the phase of scattered light calculated using Equation (7). <figref idref="f0002">Fig. 3</figref> illustrates, for example, estimated quadrature component values and estimated in-phase component values newly calculated using Equations (9) and (11) are plotted on the xy plane for a change with time at a certain 1 in a state where no vibration is applied to the optical fiber, similar to <figref idref="f0001">Fig. 2</figref>. The phase value at each time varies, but a vector 301, which indicates the center of the phase values, is given by the same Equation (7c) as the vector 201. However, the degree of variation of the vector 301 is about 1/√2 smaller than that of the vector 201 in any direction. For example, the standard deviation 302 of the vector 301 in the direction of the x axis is about 1/√2 times as much as the standard deviation 205 in <figref idref="f0001">Fig. 2</figref>.</p>
<p id="p0070" num="0070">For the calculation based on Equation (7), the uncertainty of the phase Δθ<sub>cal</sub>(l, nT) can be evaluated as in Equation (13) using the amplitude of the signal of Expression (13a) and the standard deviation σ in a certain direction if the amplitude is larger than the standard deviation.</p>
<heading id="h0038">[Formula 13a]</heading>
<p id="p0071" num="0071"><maths id="math0026" num="(13a)"><math display="block"><msqrt><mrow><msup><mi>I</mi><mn>2</mn></msup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msup><mi>Q</mi><mn>2</mn></msup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow></msqrt></math><img id="ib0026" file="imgb0026.tif" wi="136" he="13" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="12"> --> <maths id="math0027" num="(13)"><math display="block"><msub><mi mathvariant="italic">Δθ</mi><mi mathvariant="italic">cal</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mi>σ</mi><msqrt><mrow><msup><mi>I</mi><mn>2</mn></msup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>+</mo><msup><mi>Q</mi><mn>2</mn></msup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mrow></msqrt></mfrac></mfenced><mo>=</mo><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mi>σ</mi><mi>S</mi></mfrac></mfenced></math><img id="ib0027" file="imgb0027.tif" wi="136" he="11" img-content="math" img-format="tif"/></maths> Here, S is the amplitude of the signal of Expression (13a).</p>
<p id="p0072" num="0072">For the calculation based on Equation (12), the uncertainty of the phase of Expression (14a) can be evaluated as in Equation (14).</p>
<heading id="h0039">[Formula 14a]</heading>
<p id="p0073" num="0073"><maths id="math0028" num="(14a)"><math display="block"><msubsup><mi mathvariant="italic">Δθ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></math><img id="ib0028" file="imgb0028.tif" wi="134" he="5" img-content="math" img-format="tif"/></maths></p>
<heading id="h0040">[Formula 14]</heading>
<p id="p0074" num="0074"><maths id="math0029" num="(14)"><math display="block"><msubsup><mi mathvariant="italic">Δθ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>=</mo><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mi>σ</mi><mrow><msqrt><mn>2</mn></msqrt><mi>S</mi></mrow></mfrac></mfenced></math><img id="ib0029" file="imgb0029.tif" wi="133" he="9" img-content="math" img-format="tif"/></maths></p>
<p id="p0075" num="0075">Thus, compared, when the wavelength of measurement is λ and the spatial resolution of the measurement is ΔL, to the method of calculating the phase from the output of the 90-degree optical hybrid using Equation (7), the amount of improvement D in the sensitivity of the amount of distortion by calculating the phase using Equation (12) is as follows.</p>
<heading id="h0041">[Formula 15]</heading>
<p id="p0076" num="0076"><maths id="math0030" num="(15)"><math display="block"><mi>D</mi><mo>=</mo><mfrac><mrow><mi>λ</mi><mfenced open="[" close="]" separators=""><msub><mi mathvariant="italic">Δθ</mi><mi mathvariant="italic">cal</mi></msub><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced><mo>−</mo><msubsup><mi mathvariant="italic">Δθ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">new</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></mfenced></mrow><mrow><mn>2</mn><mi mathvariant="italic">πΔL</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>λ</mi><mfenced open="[" close="]" separators=""><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mi>σ</mi><mi>S</mi></mfrac></mfenced><mo>−</mo><mi>Arctan</mi><mfenced open="[" close="]"><mfrac><mi>σ</mi><mrow><msqrt><mn>2</mn></msqrt><mi>S</mi></mrow></mfrac></mfenced></mfenced></mrow><mrow><mn>2</mn><mi mathvariant="italic">πΔL</mi></mrow></mfrac></math><img id="ib0030" file="imgb0030.tif" wi="135" he="14" img-content="math" img-format="tif"/></maths> Here, the amount of distortion is a dimensionless quantity representing the ratio of the amount of expansion and contraction of the optical fiber due to the physical vibration to the natural length of the optical fiber at each point, and units of ε are used to express the amount of distortion as a numerical value. For example, the amount of distortion is 1 µε when a certain part of an optical fiber has a natural length of 1 m and has been extended by 1 µm due to the physical vibration. The amount of improvement D in the sensitivity of the amount of distortion according to the present invention, for example, when the ratio S/σ of the amplitude of the signal to noise is 2, the wavelength is 1.55 µm, and the spatial resolution is 1 m, the amount of improvement D in the measurement sensitivity is about 30 nε.</p>
<p id="p0077" num="0077">A comparison between the uncertainty of the phase given by Equation (14) in the phase calculation method based on Equation (12) and the uncertainty of the phase when using the software-based processing mechanism using the Hilbert transform is described below. The software-based processing mechanism using the Hilbert transform can be implemented, for example, by causing the backscattered light from the circulator 5 in <figref idref="f0001">Fig. 1</figref> and the local light obtained through splitting by the coupler 2 to be directly incident on the coupler 11 and detecting a signal 15 output from the balanced detector 13 as an in-phase component.</p>
<p id="p0078" num="0078">In this configuration, the number of times the backscattered light is split by couplers until reaching the balanced detector is reduced to 1 from 2 as compared with the configuration illustrated in <figref idref="f0001">Fig. 1</figref>. The intensity of the incident probe light has an upper limit to avoid a nonlinear effect occurring in the fiber to be measured which interferes with the phase measurement.<!-- EPO <DP n="13"> --> Therefore, in the software-based processing mechanism using the Hilbert transform, twice as much scattered light can be incident on the balanced detector as in the hardware-based processing mechanism using the 90-degree optical hybrid illustrated in <figref idref="f0001">Fig. 1</figref>. Thus, S in Equation (13) can be increased √2 times.</p>
<p id="p0079" num="0079">On the other hand, the local light can be adjusted such that a sufficient intensity is incident on the balanced detector even for the hardware-based processing mechanism using the 90-degree optical hybrid. Therefore, the uncertainty of the phase does not depend on the intensity of the local light because both σ and S in Equation (13) are proportional to the square root of the intensity of the local light. Thus, the uncertainty of the phase when using the software-based processing mechanism using the Hilbert transform and the uncertainty of the phase given by Equation (14) in the phase calculation method based on Equation (12) are the same.</p>
<p id="p0080" num="0080">Further, the averaging method based on Equations (9) and (11) described in the above example is effective in reducing not only the uncertainty of the phase of scattered light but also the uncertainty of the amplitude S of the signal of Expression (13a).</p>
<heading id="h0042">Second Embodiment</heading>
<p id="p0081" num="0081">Because the phase values of scattered light calculated using Equations (7) and (12) have an uncertainty of an integer multiple of 2π, a method such as phase unwrapping described using Equation (4) is used to perform a procedure of removing the uncertainty of an integer multiple of 2π. However, in the phase unwrapping, there is a problem that an appropriate integer q is incorrectly selected due to the influence of noise and phase value differences of 2π or more which do not actually exist occur across points where the integer q is incorrectly selected. Use of the phase value calculated using Equation (12) can reduce the probability of occurrence of points where the integer q is incorrectly selected and solve such a problem because the uncertainty of the phase value calculated using Equation (12) is smaller than that of the phase value calculated using Equation (7). In the following description, the phase value of scattered light calculated using Equation (7) is referred to as a "related art phase value" and the phase value of scattered light calculated using Equation (12) is referred to as a "new phase value".</p>
<p id="p0082" num="0082">A specific example will be further described. The case where a periodic vibration is applied to the optical fiber during time intervals T such that the actual amount of change in phase is less than π radians will be considered. Values obtained by phase-unwrapping the related art phase value and the new phase value at a certain point 1 after a point where a vibration is applied are given by Expressions (16) and (17), respectively.</p>
<heading id="h0043">[Formula 16]</heading>
<p id="p0083" num="0083"><maths id="math0031" num="(16)"><math display="block"><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">unwrap</mi></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></math><img id="ib0031" file="imgb0031.tif" wi="130" he="5" img-content="math" img-format="tif"/></maths></p>
<heading id="h0044">[Formula 17]</heading>
<p id="p0084" num="0084"><maths id="math0032" num="(17)"><math display="block"><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mrow><mi mathvariant="italic">new</mi><mo>,</mo><mspace width="1ex"/><mi mathvariant="italic">unwrap</mi></mrow></msubsup><mfenced><mi>l</mi><mi mathvariant="italic">nT</mi></mfenced></math><img id="ib0032" file="imgb0032.tif" wi="130" he="6" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="14"> --></p>
<p id="p0085" num="0085"><figref idref="f0002">Figs. 4</figref> and <figref idref="f0003">5</figref> are graphs in which the values of Expressions (16) and (17) are plotted with time on the horizontal axis and phase on the vertical axis, respectively. In <figref idref="f0002">Fig. 4</figref> which shows a result of performing phase unwrapping processing on the related art phase value, the phase changes with time as in a waveform 2101. Peak-to-peak values of the phase changing due to an actually applied vibration fall within a range of 2102. However, a plurality of points at which phase unwrapping fails occur like at a time indicated by 2103 due to the influence of noise. On the other hand, in <figref idref="f0003">Fig. 5</figref> which shows a result of performing phase unwrapping processing on the new phase value, the phase changes with time as in a waveform 2204 and the number of points at which phase unwrapping fails can be reduced as the influence of noise is reduced.</p>
<p id="p0086" num="0086">The principle is described below. An ideal measured value of the phase in the absence of noise is simply referred to as θ(l, nT) below. This will also be simply referred to as θ(nT) by omitting the argument 1 representing the distance for the sake of simplicity. Phase unwrapping processing at time (p + 1)T will be considered assuming that phase unwrapping has been completed by time pT.</p>
<p id="p0087" num="0087">In an ideal case where there is no noise, Equation (19) is obtained because the phase θ((p + 1)T) at time (p + 1)T satisfies Expression (18), assuming that phase changes between time intervals T are less than π radians.</p>
<heading id="h0045">[Formula 18]</heading>
<p id="p0088" num="0088"><maths id="math0033" num="(18)"><math display="block"><mfenced separators=""><mn>2</mn><mi>n</mi><mo>+</mo><mn>1</mn></mfenced><mi>π</mi><mo>&gt;</mo><mi>θ</mi><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>−</mo><msup><mi>θ</mi><mi mathvariant="italic">unwrap</mi></msup><mfenced><mi mathvariant="italic">pT</mi></mfenced><mo>&gt;</mo><mfenced separators=""><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></mfenced><mi>π</mi></math><img id="ib0033" file="imgb0033.tif" wi="132" he="6" img-content="math" img-format="tif"/></maths> Here, θ<sup>unwrap</sup>(pT) is the unwrapped phase at time pT.</p>
<heading id="h0046">[Formula 19]</heading>
<p id="p0089" num="0089"><maths id="math0034" num="(19)"><math display="block"><msup><mi>θ</mi><mi mathvariant="italic">unwrap</mi></msup><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>=</mo><mi>θ</mi><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>−</mo><mn>2</mn><mi mathvariant="italic">nπ</mi></math><img id="ib0034" file="imgb0034.tif" wi="131" he="6" img-content="math" img-format="tif"/></maths></p>
<p id="p0090" num="0090">However, because the calculated phase value, for example, θ<sub>cal</sub>, is affected by noise, phase unwrapping fails if m satisfying Expression (20) is different from n.</p>
<heading id="h0047">[Formula 20]</heading>
<p id="p0091" num="0091"><maths id="math0035" num="(20)"><math display="block"><mfenced separators=""><mn>2</mn><mi>m</mi><mo>+</mo><mn>1</mn></mfenced><mi>π</mi><mo>≥</mo><msub><mi>θ</mi><mi mathvariant="italic">cal</mi></msub><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>−</mo><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">unwrap</mi></msubsup><mfenced><mi mathvariant="italic">pT</mi></mfenced><mo>≥</mo><mfenced separators=""><mn>2</mn><mi>m</mi><mo>−</mo><mn>1</mn></mfenced><mi>π</mi></math><img id="ib0035" file="imgb0035.tif" wi="130" he="6" img-content="math" img-format="tif"/></maths> Here, a condition in which m is different from n is given by Expressions (21).</p>
<heading id="h0048">[Formula 21]</heading>
<p id="p0092" num="0092"><maths id="math0036" num="(21)"><math display="block"><mtable columnalign="left"><mtr><mtd><mfenced open="[" close="]" separators=""><msub><mi>θ</mi><mi mathvariant="italic">cal</mi></msub><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>−</mo><mi>θ</mi><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced></mfenced><mo>−</mo><mfenced open="[" close="]" separators=""><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">unwrap</mi></msubsup><mfenced><mi mathvariant="italic">pT</mi></mfenced><mo>−</mo><msup><mi>θ</mi><mi mathvariant="italic">unwrap</mi></msup><mfenced><mi mathvariant="italic">pT</mi></mfenced></mfenced></mtd></mtr><mtr><mtd><mrow><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/></mrow><mo>≥</mo><mfenced separators=""><mn>2</mn><mi>n</mi><mo>+</mo><mn>1</mn></mfenced><mi>π</mi><mo>−</mo><mfenced open="[" close="]" separators=""><mi>θ</mi><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>−</mo><msup><mi>θ</mi><mi mathvariant="italic">unwrap</mi></msup><mfenced><mi mathvariant="italic">pT</mi></mfenced></mfenced></mtd></mtr><mtr><mtd><mi>or</mi><mo>,</mo></mtd></mtr><mtr><mtd><mrow><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/></mrow><mfenced open="[" close="]" separators=""><msub><mi>θ</mi><mi mathvariant="italic">cal</mi></msub><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>−</mo><mi>θ</mi><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced></mfenced><mo>−</mo><mfenced open="[" close="]" separators=""><msubsup><mi>θ</mi><mi mathvariant="italic">cal</mi><mi mathvariant="italic">unwrap</mi></msubsup><mfenced><mi mathvariant="italic">pT</mi></mfenced><mo>−</mo><msup><mi>θ</mi><mi mathvariant="italic">unwrap</mi></msup><mfenced><mi mathvariant="italic">pT</mi></mfenced></mfenced></mtd></mtr><mtr><mtd><mrow><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/><mspace width="1ex"/></mrow><mo>≤</mo><mfenced separators=""><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></mfenced><mi>π</mi><mo>−</mo><mfenced open="[" close="]" separators=""><mi>θ</mi><mfenced separators=""><mfenced separators=""><mi>p</mi><mo>+</mo><mn>1</mn></mfenced><mi>T</mi></mfenced><mo>−</mo><msup><mi>θ</mi><mi mathvariant="italic">unwrap</mi></msup><mfenced><mi mathvariant="italic">pT</mi></mfenced></mfenced></mtd></mtr></mtable></math><img id="ib0036" file="imgb0036.tif" wi="130" he="39" img-content="math" img-format="tif"/></maths></p>
<p id="p0093" num="0093">The probability that the condition of Expressions (21) are satisfied increases as the absolute value on the left sides of Expressions (21) increases if the amount of change in phase when the time changes from pT to (p + 1)T is the same. The statistical averages of the values on<!-- EPO <DP n="15"> --> the left sides of Expressions (21) are zero, but the statistical standard deviations thereof increase as the uncertainties of phases calculated at times (p + 1)T and pT increase.</p>
<p id="p0094" num="0094">Thus, the use of the new phase value that has a smaller uncertainty than that of the related art phase value can reduce the probability of phase unwrapping failure.</p>
<heading id="h0049">Additional Description</heading>
<p id="p0095" num="0095">The following is a description of the phase measurement method and the signal processing apparatus of the present invention.</p>
<heading id="h0050">Object</heading>
<p id="p0096" num="0096">It is an object to enable offline measurement with a high SN ratio of the phase of scattered light of an optical fiber to be measured in an optical receiving system for real-time measurement (direct measurement).</p>
<heading id="h0051">Means</heading>
<p id="p0097" num="0097">
<ol id="ol0001" compact="compact" ol-style="">
<li>(1): The present signal processing method uses a phase OTDR device that measures the phase of scattered light from a fiber to be measured with a configuration that performs coherent detection using a 90-degree optical hybrid and reduces the uncertainty of the phase through a method described below. First, the phase OTDR device directly measures an in-phase component and a quadrature component of a signal corresponding to scattered light. Next, a quadrature component calculated by Hilbert transforming the directly measured in-phase component and the directly measured quadrature component are averaged to generate a new quadrature component. Further, an in-phase component calculated by inverse Hilbert transforming the directly measured quadrature component and the directly measured in-phase component are averaged to generate a new in-phase component. Then, the generated new quadrature component is divided by the generated new in-phase component and a four-quadrant inverse tangent is applied to calculate a phase. This method can reduce the uncertainty of the phase compared to that of a phase calculated by dividing the directly measured quadrature component by the directly measured in-phase component and applying a four-quadrant inverse tangent.</li>
<li>(2): The present measurement apparatus includes a laser light source that outputs continuous light, an element that splits the laser light source into local light and probe light, an element that causes the probe light to be incident on an optical fiber to be measured, a 90-degree optical hybrid that receives backscattered light of the probe light from the optical fiber to be measured and the local light as inputs, a balanced detector that receives two outputs on the in-phase component side of the 90-degree optical hybrid and obtains an electrical signal of the in-phase component, a balanced detector that receives two outputs on the quadrature component side of the 90-degree optical hybrid and obtains an electrical signal of the quadrature component, and a signal processing unit that processes the electrical signals of the in-phase and quadrature components output from the two balanced detectors, and obtains the phase of scattered light at each point in a longitudinal direction of the optical fiber to be measured through calculation of the signal processing unit and performs the signal processing of the above (1).<!-- EPO <DP n="16"> --></li>
<li>(3): The phase is calculated through the signal processing method of the above (1) and phase unwrapping processing is performed on the calculated phase, thereby reducing the probability of incorrect phase unwrapping compared to when phase unwrapping is performed on a phase calculated by dividing the directly measured quadrature component by the directly measured in-phase component and applying a four-quadrant inverse tangent.</li>
</ol></p>
<heading id="h0052">Effects</heading>
<p id="p0098" num="0098">The present invention enables measurement having a high SN ratio by offline processing through signal processing even when a hardware-based processing mechanism using a 90-degree optical hybrid is used for a receiving system in a C-OTDR. Therefore, both real-time measurement and measurement having a high SN ratio by offline processing can be achieved by a single hardware-based processing mechanism using a 90-degree optical hybrid.</p>
<p id="p0099" num="0099">The present invention is not limited to the above embodiments as they are, but the components can be modified and embodied without departing from the spirit of the invention at an implementation stage. The signal processing apparatus of the present invention can also be implemented by a computer and a program and the program can be recorded on a recording medium or provided through a network.</p>
<heading id="h0053">Reference Signs List</heading>
<p id="p0100" num="0100">
<ul id="ul0003" list-style="none" compact="compact">
<li>1 CW light source</li>
<li>2 Coupler</li>
<li>3 Intensity modulator</li>
<li>4 Frequency shifter</li>
<li>5 Circulator</li>
<li>6 Optical fiber to be measured</li>
<li>7 90-degree optical hybrid</li>
<li>8 Coupler</li>
<li>9 Coupler</li>
<li>10 Phase shifter</li>
<li>11 Coupler</li>
<li>12 Coupler</li>
<li>13 Balanced detector</li>
<li>14 Balanced detector</li>
<li>15 Electrical signal</li>
<li>16 Electrical signal</li>
<li>17 Signal processing apparatus</li>
<li>17a AD conversion functional element</li>
<li>17b AD conversion functional element</li>
<li>17c Signal processing unit</li>
</ul></p>
</description>
<claims id="claims01" lang="en"><!-- EPO <DP n="17"> -->
<claim id="c-en-0001" num="0001">
<claim-text>A phase measurement method for measuring a phase of scattered light from a fiber to be measured, the phase measurement method comprising:
<claim-text>acquiring a measured in-phase component value and a measured quadrature component value of a signal obtained by coherently detecting the scattered light through a 90-degree optical hybrid;</claim-text>
<claim-text>Hilbert transforming the measured in-phase component value to acquire a calculated quadrature component value and inverse Hilbert transforming the measured quadrature component value to acquire a calculated in-phase component value;</claim-text>
<claim-text>averaging the measured in-phase component value and the calculated in-phase component value to acquire an estimated in-phase component value and averaging the measured quadrature component value and the calculated quadrature component value to acquire an estimated quadrature component value; and</claim-text>
<claim-text>calculating a four-quadrant inverse tangent of a quotient obtained by dividing the estimated quadrature component value by the estimated in-phase component value.</claim-text></claim-text></claim>
<claim id="c-en-0002" num="0002">
<claim-text>The phase measurement method according to claim 1, further comprising performing phase unwrapping processing on the four-quadrant inverse tangent.</claim-text></claim>
<claim id="c-en-0003" num="0003">
<claim-text>A signal processing apparatus comprising:
<claim-text>a signal input unit configured to receive, as inputs, a measured in-phase component value and a measured quadrature component value of a signal obtained by coherently detecting scattered light from a fiber to be measured through a 90-degree optical hybrid;</claim-text>
<claim-text>a transform unit configured to Hilbert transform the measured in-phase component value to acquire a calculated quadrature component value and inverse Hilbert transform the measured quadrature component value to acquire a calculated in-phase component value;</claim-text>
<claim-text>an estimation unit configured to average the measured in-phase component value and the calculated in-phase component value to acquire an estimated in-phase component value and average the measured quadrature component value and the calculated quadrature component value to acquire an estimated quadrature component value; and</claim-text>
<claim-text>a calculation unit configured to calculate a four-quadrant inverse tangent of a quotient obtained by dividing the estimated quadrature component value by the estimated in-phase component value.</claim-text></claim-text></claim>
<claim id="c-en-0004" num="0004">
<claim-text>The signal processing apparatus according to claim 3, further comprising a phase unwrapping processing unit configured to perform phase unwrapping processing on the four-quadrant inverse tangent.<!-- EPO <DP n="18"> --></claim-text></claim>
<claim id="c-en-0005" num="0005">
<claim-text>A program for causing a computer to operate as the signal processing apparatus according to claim 3 or 4.</claim-text></claim>
</claims>
<drawings id="draw" lang="en"><!-- EPO <DP n="19"> -->
<figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="142" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="20"> -->
<figure id="f0002" num="3,4"><img id="if0002" file="imgf0002.tif" wi="105" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="21"> -->
<figure id="f0003" num="5"><img id="if0003" file="imgf0003.tif" wi="111" he="115" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="22"> -->
<figure id="f0004" num="6"><img id="if0004" file="imgf0004.tif" wi="139" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="23"> -->
<figure id="f0005" num="7"><img id="if0005" file="imgf0005.tif" wi="48" he="138" img-content="drawing" img-format="tif"/></figure>
</drawings>
<search-report-data id="srep" lang="en" srep-office="EP" date-produced=""><doc-page id="srep0001" file="srep0001.tif" wi="165" he="229" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="165" he="229" type="tif"/><doc-page id="srep0003" file="srep0003.tif" wi="165" he="229" type="tif"/></search-report-data>
<ep-reference-list id="ref-list">
<heading id="ref-h0001"><b>REFERENCES CITED IN THE DESCRIPTION</b></heading>
<p id="ref-p0001" num=""><i>This list of references cited by the applicant is for the reader's convenience only. It does not form part of the European patent document. Even though great care has been taken in compiling the references, errors or omissions cannot be excluded and the EPO disclaims all liability in this regard.</i></p>
<heading id="ref-h0002"><b>Non-patent literature cited in the description</b></heading>
<p id="ref-p0002" num="">
<ul id="ref-ul0001" list-style="bullet">
<li><nplcit id="ref-ncit0001" npl-type="s"><article><author><name>ALI. MASOUDI</name></author><author><name>T. P. NEWSON</name></author><atl>Contributed Rview: Distributed optical fibre dynamic strain sensing</atl><serial><sertitle>Review of Scientific Instruments</sertitle><pubdate><sdate>20160000</sdate><edate/></pubdate><vid>87</vid></serial><location><pp><ppf>011501</ppf><ppl/></pp></location></article></nplcit><crossref idref="ncit0001">[0019]</crossref></li>
<li><nplcit id="ref-ncit0002" npl-type="s"><article><author><name>XINYU FAN et al.</name></author><atl>Distributed Fiber-Optic Vibration Sensing Based on Phase Extraction From Optical Reflectometry</atl><serial><sertitle>Journal of Lightwave Technology</sertitle><pubdate><sdate>20170000</sdate><edate/></pubdate><vid>35</vid><ino>16</ino></serial><location><pp><ppf>3281</ppf><ppl/></pp></location></article></nplcit><crossref idref="ncit0002">[0019]</crossref></li>
<li><nplcit id="ref-ncit0003" npl-type="s"><article><author><name>ZINAN WANG et al.</name></author><atl>Coherent Φ-OTDR based on I/Q demodulation and homodyne detection</atl><serial><sertitle>Optics Express</sertitle><pubdate><sdate>20160000</sdate><edate/></pubdate><vid>24</vid><ino>2</ino></serial><location><pp><ppf>853</ppf><ppl/></pp></location></article></nplcit><crossref idref="ncit0003">[0019]</crossref></li>
</ul></p>
</ep-reference-list>
</ep-patent-document>
