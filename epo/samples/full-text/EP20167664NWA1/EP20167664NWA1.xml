<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE ep-patent-document PUBLIC "-//EPO//EP PATENT DOCUMENT 1.5.1//EN" "ep-patent-document-v1-5-1.dtd">
<!-- This XML data has been generated under the supervision of the European Patent Office -->
<ep-patent-document id="EP20167664A1" file="EP20167664NWA1.xml" lang="en" country="EP" doc-number="3889896" kind="A1" date-publ="20211006" status="n" dtd-version="ep-patent-document-v1-5-1">
<SDOBI lang="en"><B000><eptags><B001EP>ATBECHDEDKESFRGBGRITLILUNLSEMCPTIESILTLVFIROMKCYALTRBGCZEEHUPLSKBAHRIS..MTNORSMESMMAKHTNMD..........</B001EP><B005EP>J</B005EP><B007EP>BDM Ver 2.0.12 (4th of August) -  1100000/0</B007EP></eptags></B000><B100><B110>3889896</B110><B120><B121>EUROPEAN PATENT APPLICATION</B121></B120><B130>A1</B130><B140><date>20211006</date></B140><B190>EP</B190></B100><B200><B210>20167664.0</B210><B220><date>20200402</date></B220><B250>en</B250><B251EP>en</B251EP><B260>en</B260></B200><B400><B405><date>20211006</date><bnum>202140</bnum></B405><B430><date>20211006</date><bnum>202140</bnum></B430></B400><B500><B510EP><classification-ipcr sequence="1"><text>G06T   7/149       20170101AFI20200917BHEP        </text></classification-ipcr></B510EP><B520EP><classifications-cpc><classification-cpc sequence="1"><text>G06T2207/10072     20130101 LA20200915BHEP        </text></classification-cpc><classification-cpc sequence="2"><text>G06T2207/30028     20130101 LA20200915BHEP        </text></classification-cpc><classification-cpc sequence="3"><text>G06T2207/20121     20130101 LA20200915BHEP        </text></classification-cpc><classification-cpc sequence="4"><text>G06T   7/149       20170101 FI20200915BHEP        </text></classification-cpc></classifications-cpc></B520EP><B540><B541>de</B541><B542>MODELLBASIERTE VIRTUELLE REINIGUNG FÜR SPEKTRALE VIRTUELLE KOLOSKOPIE</B542><B541>en</B541><B542>MODEL-BASED VIRTUAL CLEANSING FOR SPECTRAL VIRTUAL COLONOSCOPY</B542><B541>fr</B541><B542>NETTOYAGE VIRTUEL BASÉ SUR UN MODÈLE POUR UNE COLOSCOPIE VIRTUELLE SPECTRALE</B542></B540><B590><B598>1</B598></B590></B500><B700><B710><B711><snm>Koninklijke Philips N.V.</snm><iid>101851185</iid><irf>2019P00949EP</irf><adr><str>High Tech Campus 52</str><city>5656 AG Eindhoven</city><ctry>NL</ctry></adr></B711></B710><B720><B721><snm>SABCZYNSKI, Jörg</snm><adr><str>c/o Philips International B.V. - Intellectual
Property &amp; Standards High Tech Campus 5</str><city>5656 AE Eindhoven</city><ctry>NL</ctry></adr></B721><B721><snm>WIEMKER, Rafael</snm><adr><str>c/o Philips International B.V. - Intellectual
Property &amp; Standards High Tech Campus 5</str><city>5656 AE Eindhoven</city><ctry>NL</ctry></adr></B721><B721><snm>KLINDER, Tobias</snm><adr><str>c/o Philips International B.V. - Intellectual
Property &amp; Standards High Tech Campus 5</str><city>5656 AE Eindhoven</city><ctry>NL</ctry></adr></B721></B720><B740><B741><snm>Philips Intellectual Property &amp; Standards</snm><iid>101808802</iid><adr><str>High Tech Campus 5</str><city>5656 AE Eindhoven</city><ctry>NL</ctry></adr></B741></B740></B700><B800><B840><ctry>AL</ctry><ctry>AT</ctry><ctry>BE</ctry><ctry>BG</ctry><ctry>CH</ctry><ctry>CY</ctry><ctry>CZ</ctry><ctry>DE</ctry><ctry>DK</ctry><ctry>EE</ctry><ctry>ES</ctry><ctry>FI</ctry><ctry>FR</ctry><ctry>GB</ctry><ctry>GR</ctry><ctry>HR</ctry><ctry>HU</ctry><ctry>IE</ctry><ctry>IS</ctry><ctry>IT</ctry><ctry>LI</ctry><ctry>LT</ctry><ctry>LU</ctry><ctry>LV</ctry><ctry>MC</ctry><ctry>MK</ctry><ctry>MT</ctry><ctry>NL</ctry><ctry>NO</ctry><ctry>PL</ctry><ctry>PT</ctry><ctry>RO</ctry><ctry>RS</ctry><ctry>SE</ctry><ctry>SI</ctry><ctry>SK</ctry><ctry>SM</ctry><ctry>TR</ctry></B840><B844EP><B845EP><ctry>BA</ctry></B845EP><B845EP><ctry>ME</ctry></B845EP></B844EP><B848EP><B849EP><ctry>KH</ctry></B849EP><B849EP><ctry>MA</ctry></B849EP><B849EP><ctry>MD</ctry></B849EP><B849EP><ctry>TN</ctry></B849EP></B848EP></B800></SDOBI>
<abstract id="abst" lang="en">
<p id="pa01" num="0001">The present invention relates to assessing the relative contribution of different tissues, or tissue mix. A method is proposed that is based on models of material transitions. The proposed method may be extended to take into account additional information available in increasingly used spectral CT or multi-parametric MRI. Different material concentration maps can be created, which can be used for improved visualization.
<img id="iaf01" file="imgaf001.tif" wi="88" he="112" img-content="drawing" img-format="tif"/></p>
</abstract>
<description id="desc" lang="en"><!-- EPO <DP n="1"> -->
<heading id="h0001">FIELD OF THE INVENTION</heading>
<p id="p0001" num="0001">The present invention relates to assessing the relative contribution of different tissues in a medical object data set, and in particular to a computer-implemented method and an apparatus for processing image voxel data representative of at least one three-dimensional medical image of an imaging modality of an object of interest to classify transitions between at least two materials in the object of interest, to a medical imaging system as well as a computer program element and a computer readable medium.</p>
<heading id="h0002">BACKGROUND OF THE INVENTION</heading>
<p id="p0002" num="0002">Tissue mix is known in the art, for example from "Partial Volume Tissue Segmentation using Grey-Level Gradient", D. C. Williamson, N. A. Thacker, S. R. Williams and M. Pokric, presented at MIUA 2002, which discloses a method for its calculation. The calculation of tissue mix may be used to solve the problem of partial volume effect, which is the misclassification of CT (Computed Tomography) value in a voxel occurring at a boundary between different tissue types due to the contributions to that voxel from unknown proportions of surrounding tissue. The problem may occur whenever different tissues or materials meet at a boundary such as between bone and soft tissue, but may also occur between regions of air and tissue in e.g. the colon, and also between combinations such as air, liquid and different types of tissue.</p>
<p id="p0003" num="0003">For example, in virtual colonoscopy, the colon consists of many haustra, i.e. pouches that are often separated only by very thin walls with a thickness sometimes even thinner than the scanner resolution. Therefore, partial volume effects during Virtual Cleansing may lead to a misinterpretation of voxels containing a wall between haustra as air. This may lead to holes in the rendered image of the colon.</p>
<heading id="h0003">SUMMARY OF THE INVENTION</heading>
<p id="p0004" num="0004">There may be a need to provide an improved method to calculate tissue mix. The object of the present invention is solved by the subject-matter of the independent claims, wherein further embodiments are incorporated in the dependent claims. It should be noted<!-- EPO <DP n="2"> --> that the following described aspects of the invention apply also for the method, the apparatus, the medical imaging system, the computer program element, and the computer readable medium.</p>
<p id="p0005" num="0005">According to a first aspect of the present invention, there is provided a computer-implemented method for processing image voxel data representative of at least one three-dimensional medical image of an imaging modality of an object of interest to classify transitions between at least two materials in the object of interest. The computer-implemented method comprises:
<ol id="ol0001" compact="compact" ol-style="">
<li>a) selecting a local environment around a voxel in the image voxel data;</li>
<li>b) fitting a material transition model to image intensities of the local environment of the voxel to estimate model parameters of the material transition model and to derive one or more quantities for characterizing a fitting quality of the model fit for the voxel, wherein the material transition model is constructed that corresponds to a behavior of the image intensities at material transitions;</li>
<li>c) determining whether a valid fitting result is achieved for the voxel based on at least one of the one or more derived quantities and the model parameters;</li>
<li>d) classifying the voxel into one type of material transitions based on the estimated model parameters, if a valid fitting result is achieved for the voxel; or classifying the voxel into one of the at least two materials based on the estimated model parameters, if an invalid fitting result is achieved for the voxel; and</li>
<li>e) repeating steps a) to d) for a plurality of voxels in the image voxel data.</li>
</ol></p>
<p id="p0006" num="0006">In other words, it is proposed to take into account the appearance of material transitions between discrete pure material classes in medical images by using a mathematical model. The mathematical model (e.g. two-material transition model or three-material transition model) allows a local, non-linear fit of pure materials (e.g. air, tissue, tagged faeces, bone) and their respective transitions. An exemplary two-material transition model is described in detail with respect to the embodiment illustrated in <figref idref="f0001">Fig. 1</figref> of the present disclosure. In addition, it is checked whether the fitting procedure produced valid values based on the estimated model parameters and/or the fitting quality. In other words, it is checked whether the values comply with "logical rules", such as "voxels far away from a wall should not contribute much to the model and should result in a pure value". This may reduce the chances of misinterpreting voxels containing a pure material as the material transitions, and <i>vice versa</i>.<!-- EPO <DP n="3"> --></p>
<p id="p0007" num="0007">The proposed method may be used with standard CT, MRI (Magnetic Resonance Imaging), or CBCT (Cone Beam Computed Tomography), but also may be extended to spectral CT or multi-parametric MRI. As the proposed method has the potential to better assess the relative contribution of different tissues in the medical object data set, less artefacts may be produced in the rendering. This may improve the certainty during reading and the value of virtual rendering.</p>
<p id="p0008" num="0008">The method may comprise the following steps:<br/>
Fitting of a model: A two-material transition model is fitted to the image intensities of an environment around the voxel. For example, Hounsfield units may represent image intensities in CT imaging.</p>
<p id="p0009" num="0009">Determining results from the fitting of results: Model parameters and quantities representative for the fitting quality of the model fit are estimated. Examples of the quantity for characterizing the fitting quality may include, but not limited to, optimality, residual, fitting success, tolerance of the result.</p>
<p id="p0010" num="0010">Filtering of fitting quality: It is checked whether the fitting procedure produced valid values based on the estimated model parameters and/or the fitting quality. If the fitting procedure produced valid values, the voxel is classified into one of the material transitions. If not, the voxel is classified into one of the pure materials.</p>
<p id="p0011" num="0011">Repeating the above-mentioned steps for a plurality of voxels.</p>
<p id="p0012" num="0012">According to an embodiment of the present invention, at least two material transition models are applied to the plurality of voxels in the image voxel data.</p>
<p id="p0013" num="0013">Examples of the material transition models may include, but are not limited to, two-material transition, three-material transition, thin-wall embedded in another material, two-material-transition with a thin film of a third material, etc. It may be beneficial do the calculation as described for a given voxel i for all these models and select the best one. It may be beneficial do the calculation as described for a given voxel for all these models and select the best one.</p>
<p id="p0014" num="0014">According to an embodiment of the present invention, the computer-implemented method further comprises:
<ul id="ul0001" list-style="dash" compact="compact">
<li>determining a respective concentration value for each of the plurality of voxels (i) based on the classified material transition, if a valid fitting result is achieved for the respective voxel, or (ii) based on the classified material, if an invalid fitting result is achieved for the respective voxel; and<!-- EPO <DP n="4"> --></li>
<li>creating at least one concentration image for the at least two materials based on the determined concentration values of the plurality of voxels.</li>
</ul></p>
<p id="p0015" num="0015">In other words, the concentration maps for one or more pure materials may be calculated.</p>
<p id="p0016" num="0016">As the proposed method has the potential to better assess the relative contribution of different tissues in the medical object data set, less artefacts may be produced in the rendered concentration image(s).</p>
<p id="p0017" num="0017">According to an embodiment of the present invention, the plurality of voxels are voxels that are likely to be close to a material transition area.</p>
<p id="p0018" num="0018">In order to reduce the computational effort for fitting, the fitting procedure may be started only for those voxels, which are likely to be close to the material transition area. The material transition area may be determined e.g. by image segmentation.</p>
<p id="p0019" num="0019">According to an embodiment of the present invention, the imaging modality comprises computed tomography (CT).</p>
<p id="p0020" num="0020">The proposed method may be used with standard CT as well as spectral CT.</p>
<p id="p0021" num="0021">According to an embodiment of the present invention, the at least one three-dimensional medical image comprises synthesized monoenergetic images acquired at different energies. The behavior of the image intensities at material transitions in each of the synthesized monoenergetic images is modelled by a respective material transition model. Each material transition model has same geometric parameters.</p>
<p id="p0022" num="0022">Making use of the additional information from the spectral acquisition may result in improved estimation of material transition.</p>
<p id="p0023" num="0023">For spectral CT, each spectral image may have a respective model function. The material parameters of the model functions are different for each of the spectral images, while the geometric parameters are the same. The model fitting is done to optimize to the matching of the model functions with all the spectral images simultaneously.</p>
<p id="p0024" num="0024">According to an embodiment of the present invention, the imaging modality comprises magnetic resonance (MR) imaging.</p>
<p id="p0025" num="0025">In other words, the proposed method may also be extended to MRI, such as standard MRI or multi-parametric MRI.</p>
<p id="p0026" num="0026">According to an embodiment of the present invention, the at least one three-dimensional medical image comprises a sequence of multi-parametric MR images. The behavior of the image intensities at material transitions in each of the multi-parametric MR<!-- EPO <DP n="5"> --> images is modelled by a respective material transition model. Each material transition model has same geometric parameters.</p>
<p id="p0027" num="0027">Multi-parametric (mp) MRI is essentially any functional form of imaging used to supplement standard anatomical T1 and T2-weighted imaging. The functional sequences of choice may include, but are not limited to, dynamic contrast-enhanced (DCE) MRI and diffusion-weighted imaging (DWI), including the calculation of apparent diffusion coefficient (ADC) maps.</p>
<p id="p0028" num="0028">For multi-parametric MRI, each of the multi-parametric MR images may have a respective model function. The material parameters of the model functions are different for each of the multi-parametric MR images, while the geometric parameters are the same. The model fitting is done to optimize to the matching of the model functions with all the multi-parametric MR images simultaneously.</p>
<p id="p0029" num="0029">According to an embodiment of the present invention, the computer-implemented method further comprises removing effects of an undesired material of the at least two materials from the image voxel data based on a result of classification.</p>
<p id="p0030" num="0030">In other words, an undesired material, e.g. tagged faeces may be replaced by another material, e.g. air. The voxels corresponding to the undesired material (e.g. tagged faeces) need to be identified and their concentration values need to be replaced by the values of another material (e.g. air).</p>
<p id="p0031" num="0031">In an example, for the clinical inspection of the colon in virtual colonoscopy, remains of stool or faeces may be removed from the colon image prior to visualization.</p>
<p id="p0032" num="0032">According to an embodiment of the present invention, at least one of the following images is created: a model parameter image illustrative of the model parameters, a fitting quality image illustrate of the one or more derived quantity characterizing the fitting quality of the model fit, and one or more concentration images.</p>
<p id="p0033" num="0033">In other words, one or more images created by the proposed method, such as model parameter images, fitting quality images, derived quantity images, may be used to color the resulting surface mesh in order to visualize more information to the user. This will be explained hereafter and particularly with respect to the embodiment illustrated in <figref idref="f0003">Figs. 4A to 4E</figref> of the present disclosure.</p>
<p id="p0034" num="0034">According to an embodiment of the present invention, the computer-implemented method further comprises visualizing at least one of the created images.<!-- EPO <DP n="6"> --></p>
<p id="p0035" num="0035">According to an embodiment of the present invention, the object of interest comprises a colon. The at least two materials comprise gas, stool tagged with stool tagging agent, and tissue.</p>
<p id="p0036" num="0036">In other words, the proposed method may be applied to virtual colonoscopy.</p>
<p id="p0037" num="0037">According to a second aspect of the present invention, there is provided an apparatus that comprises a processor configured to perform the method according to the first aspect and any associated embodiment.</p>
<p id="p0038" num="0038">According to a third aspect of the present invention, there is provided a medical imaging system. The medical imaging system comprises:
<ul id="ul0002" list-style="dash" compact="compact">
<li>a scanner configured to scan an object of interest to acquire at least one three-dimensional image of the object of interest; and</li>
<li>an apparatus according to the second aspect and any associated embodiment for processing image voxel data representative of the at least one three-dimensional image.</li>
</ul></p>
<p id="p0039" num="0039">In an example, the scanner is a CT scanner.</p>
<p id="p0040" num="0040">In another example, the scanner is an MRI scanner.</p>
<p id="p0041" num="0041">In a further example, the scanner is a CBCT scanner.</p>
<p id="p0042" num="0042">According to a fourth aspect of the present invention, there is provided a computer program element configured, during execution, to perform the method steps according to the first aspect and any associated embodiment.</p>
<p id="p0043" num="0043">According to another aspect of the present invention, there is provided a computer readable medium that comprises the computer program element according to the fourth aspect.</p>
<p id="p0044" num="0044">It should be appreciated that all combinations of the foregoing concepts and additional concepts discussed in greater detail below (provided such concepts are not mutually inconsistent) are contemplated as being part of the inventive subject matter disclosed herein. In particular, all combinations of claimed subject matter appearing at the end of this disclosure are contemplated as being part of the inventive subject matter disclosed herein.</p>
<p id="p0045" num="0045">These and other aspects of the present invention will become apparent from and be elucidated with reference to the embodiments described hereinafter.<!-- EPO <DP n="7"> --></p>
<heading id="h0004">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p0046" num="0046">These and other aspects of the invention will be apparent from and elucidated further with reference to the embodiments described by way of examples in the following description and with reference to the accompanying drawings, in which
<ul id="ul0003" list-style="none" compact="compact">
<li><figref idref="f0001">Fig. 1</figref> shows a flow chart of a computer-implemented method according to some embodiments of the present disclosure.</li>
<li><figref idref="f0002">Fig. 2</figref> schematically shows a two-material transition in vicinity of voxel i.</li>
<li><figref idref="f0002">Fig. 3</figref> shows a two-material function in dependence of location along a line orthogonal to the transition plane.</li>
<li><figref idref="f0003">Fig. 4A</figref> shows a CT image of an abdomen.</li>
<li><figref idref="f0003">Fig. 4B</figref> shows a distance image representative of the absolute value of the distance obtained after fitting a two-material transition model to the three-dimensional medical image illustrated in <figref idref="f0003">Fig. 4A</figref>.</li>
<li><figref idref="f0003">Fig. 4C</figref> illustrates an image representative of the lower Hounsfield value of the two pure materials obtained after fitting a two-material transition model to the three-dimensional medical image illustrated in <figref idref="f0003">Fig. 4A</figref>.</li>
<li><figref idref="f0003">Fig. 4D</figref> illustrates an image representative of the higher Hounsfield value of the two pure materials obtained after fitting a two-material transition model to the three-dimensional medical image illustrated in <figref idref="f0003">Fig. 4A</figref>.</li>
<li><figref idref="f0003">Fig. 4E</figref> illustrates an optimality image representative of the value of the optimality for characterizing the fitting quality obtained after fitting a two-material transition model to the three-dimensional medical image illustrated in <figref idref="f0003">Fig. 4A</figref>.</li>
<li><figref idref="f0004">Fig. 5</figref> schematically shows an apparatus according to some embodiments of the present disclosure.</li>
<li><figref idref="f0004">Fig. 6</figref> schematically shows a medical imaging system according to some embodiments of the present disclosure.</li>
</ul></p>
<p id="p0047" num="0047">It should be noted that the figures are purely diagrammatic and not drawn to scale. In the figures, elements which correspond to elements already described may have the same reference numerals. Examples, embodiments or optional features, whether indicated as non-limiting or not, are not to be understood as limiting the invention as claimed.</p>
<heading id="h0005">DETAILED DESCRIPTION OF EMBODIMENTS</heading>
<p id="p0048" num="0048">In the following, the method is described for an application of a two-material-transition model in a situation with three different classes of materials in the colon. Although<!-- EPO <DP n="8"> --> the following detailed description is described using application to CT virtual colonoscopy for the purposes of illustration, anyone of ordinary skill in the art will appreciate that the method, apparatus, and medical imaging system described above and below can be adapted to more tissue classes, e.g. bone, and to other imaging modality, e.g. MRI or CBCT. Accordingly, the following described examples are set forth without any loss of generality to, and without imposing limitations upon, the claimed invention.</p>
<p id="p0049" num="0049">Polyps in the colon can possibly develop into colon cancer. If removed early, cancer can be prevented effectively. It is therefore recommended also for asymptomatic patients above a certain age to perform endoscopic inspection of the colon (colonoscopy) in order to detect and assess possible polyps. Unfortunately, compliance with this screening is low, mainly due to the discomfort associated with endoscopy. Therefore, non-invasive virtual colonoscopy (VC) based on CT was developed as an alternative. VC is the virtual inspection of the colon wall on a computer screen usually rendered with the help of Volume Rendering (VR) techniques. In VC, VR results in animate impression similar to the view of a real endoscope during colonoscopy. A necessary step for the clinical inspection of the colon in VC is removing remains of stool or faeces from the colon image prior to visualization, so called Virtual Cleansing. Unfortunately, the CT contrast of faeces is similar to the contrast of the tissue surrounding the colon. Therefore, this pre-processing of the image is usually supported by orally administering a laxative to remove stool followed by administering contrast agent containing iodine prior to CT imaging in order to tag remaining stool. This tagging helps removing the remaining faeces from the image. In order to create a visualization of a virtual empty colon, the Hounsfield values of voxels with faeces are set to the value of air.</p>
<p id="p0050" num="0050">Virtual cleansing may have some inherent problems and disadvantages in combination with Volume Rendering.</p>
<p id="p0051" num="0051">Virtual cleansing methods relying on the assumption that the Hounsfield values of pure materials are known. Usually, it is assumed that there are three different classes of relevant materials in VC: Air, soft tissue, and tagged faeces. Unfortunately, except for air, the Hounsfield values of soft tissue and tagged faeces may vary not only from patient to patient, from CT image to CT image, but also within a single CT image. This is due to natural differences in tissue density as well as variations of the contrast agent concentration in the faeces. Therefore, cleansing methods relying on the knowledge of the Hounsfield values of pure materials often produce artefacts in the rendered images.<!-- EPO <DP n="9"> --></p>
<p id="p0052" num="0052">Depending on the threshold values for identifying those voxels, which are completely or partially filled with tagged faeces, the apparent position of the colon wall in the rendered image might be different and might not coincide with the real colon wall position. Therefore, even if the material properties of the pure materials were known exactly, voxel-wise rendering methods can produce geometric artefacts at the three-material transitions. In virtual colonoscopy, these appear as "water level" artefacts at the colon wall, where all three pure materials (air, tissue, tagged faeces) meet.</p>
<p id="p0053" num="0053">Furthermore, the colon consists of many haustra, i.e. pouches that are often separated only by very thin walls with a thickness sometimes even thinner than the scanner resolution. Therefore, partial volume effects during Virtual Cleansing can lead to a misinterpretation of voxels containing a wall between haustra as air. This leads to holes in the rendered image of the colon.</p>
<p id="p0054" num="0054">In order to solve some of the above-mentioned problems, <figref idref="f0001">Fig. 1</figref> shows a flow chart of a computer-implemented method 100 according to some embodiments of the present disclosure. The computer-implemented method 100 is proposed for processing image voxel data representative of at least one three-dimensional medical image of an imaging modality of an object of interest to classify transitions between at least two materials in the object of interest. Examples of the imaging modality may include, but are not limited to, CT, MRI, or CBCT.</p>
<p id="p0055" num="0055">The method 100 may be implemented as a device, module or related component in a set of logic instructions stored in a non-transitory machine- or computer-readable storage medium such as random access memory (RAM), read only memory (ROM), programmable ROM (PROM), firmware, flash memory, etc., in configurable logic such as, for example, programmable logic arrays (PLAs), field programmable gate arrays (FPGAs), complex programmable logic devices (CPLDs), in fixed-functionality hardware logic using circuit technology such as, for example, application specific integrated circuit (ASIC), complementary metal oxide semiconductor (CMOS) or transistor-transistor logic (TTL) technology, or any combination thereof. For example, computer program code to carry out operations shown in the method 100 may be written in any combination of one or more programming languages, including an object oriented programming language such as JAVA, SMALLTALK, C++ or the like and conventional procedural programming languages, such as the "C" programming language or similar programming languages.</p>
<p id="p0056" num="0056">In step 110, i.e. step a), a local environment is selected around a voxel in the image voxel data.<!-- EPO <DP n="10"> --></p>
<p id="p0057" num="0057">In an example, as illustrated in <figref idref="f0002">Fig. 2</figref>, the local environment 10 is in form of a cubic sub-image of size <i>k</i><sup>3</sup> with voxel i in the center, where <i>k</i> = 2, 3, 4....</p>
<p id="p0058" num="0058">In another example (not shown), the local environment may be in the form of spherical or ellipsoidal sub-image with voxel i in the center.</p>
<p id="p0059" num="0059">In step 120, i.e. step b), a material transition model is fitted to image intensities of the local environment of the voxel to estimate model parameters of the material transition model. The material transition model is constructed that corresponds to a behavior of the image intensities at material transitions. Examples of the material transition model may include, but are not limited to, a two-material transition and a three-material transition model.</p>
<p id="p0060" num="0060">For illustration purposes, the method will be described below for a two material transition (either air-tissue or air-stool or stool-tissue). It applies similarly to other transitions.</p>
<p id="p0061" num="0061">A two-material transition may be modelled by a model function <i>g</i>(<i>m<sub>high</sub>, m<sub>low</sub>, d, <b>n</b>, σ</i>) where <i>m<sub>high</sub></i> is the higher and <i>m<sub>low</sub></i> the lower Hounsfield value of the two pure materials of the two-material transition. <i>d</i> and <b><i>n</i></b> are the distance and unit normal vector. <i>σ</i> is the width of the point spread function of the scanner. The point spread function of the scanner may be anisotropic. In this case, <i>σ</i> may be a vector <b><i>σ</i></b>. The point spread function of the scanner (isotropic or anisotropic) might be known. In this case, it does not need to be estimated and can be fixed in the algorithm.</p>
<p id="p0062" num="0062">Different material transition models may be used for different material topologies. It may be beneficial to try several material transition models before selecting one. For the simple case of a planar two-material transition, the only spatial dependence of the model function is from the distance <i>d</i>(<b><i>r</i></b>) of the voxel at position <b><i>r</i></b> from a transition plane 20 (see <figref idref="f0002">Fig. 2</figref>): <maths id="math0001" num=""><math display="block"><mrow><mi>g</mi><mfenced><mi mathvariant="bold-italic">r</mi></mfenced><mo>=</mo><msub><mi>m</mi><mi mathvariant="italic">low</mi></msub><mo>+</mo><mfenced separators=""><msub><mi>m</mi><mi mathvariant="italic">high</mi></msub><mo>−</mo><msub><mi>m</mi><mi mathvariant="italic">low</mi></msub></mfenced><mfenced separators=""><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>erf</mi><mfrac><mrow><mi>d</mi><mfenced><mi mathvariant="bold-italic">r</mi></mfenced></mrow><mrow><msqrt><mn>2</mn></msqrt><mi>σ</mi></mrow></mfrac></mfenced></mrow></math><img id="ib0001" file="imgb0001.tif" wi="85" he="10" img-content="math" img-format="tif"/></maths></p>
<p id="p0063" num="0063">An example of a two-material model function in dependence of location along a line orthogonal to the transition plane is illustrated in <figref idref="f0002">Fig. 3</figref>.</p>
<p id="p0064" num="0064">From the fit, several important quantities are obtained for the voxel i. The model parameters of the material transition model, e.g. <i>m<sub>high</sub></i>(<i>i</i>)<i>, m<sub>low</sub></i>(<i>i</i>)<i>, d(i),</i> n(i), σ(i) can be obtained by fitting the material transition model to the image intensities of the local environment.<!-- EPO <DP n="11"> --></p>
<p id="p0065" num="0065">Additionally, one or more quantities are derived for characterizing a fitting quality of the model fit for the voxel. Depending on the fitting method, these may be e.g. optimality, residual, fitting success, tolerance of the result etc. The quantity for characterizing the fitting quality may be obtained from the Meta results of the fitting procedure.</p>
<p id="p0066" num="0066">In step 130, i.e. step c), it is determined whether a valid fitting result is achieved for the voxel based on at least one of the one or more derived quantities and the model parameters.</p>
<p id="p0067" num="0067">In an example, it may be checked if fitting procedure gave valid values based on distance, <i>m<sub>high</sub></i>(<i>i</i>) and <i>m<sub>low</sub></i>(<i>i</i>)<i>,</i> quantity for characterizing the fitting quality (e.g. optimality, residual, fitting success, tolerance of the result, etc.). For example, for voxels, which are far away from any two-material transition, the model fitting procedure for a two-material transition can give no valid results. For example, for voxels, which have values of <i>m<sub>high</sub></i> or <i>m<sub>low</sub></i> out of a predefined range, the model fitting procedure for a two-material transition can give no valid results. For example, if the fitting quality, such as optimality, fitting success, etc., is out of a predefined range, the model fitting procedure for a two-material transition can give no valid results. Therefore, these voxels need to be identified and their concentration values need to be replaced by e.g. the values for one of the following pure materials: air, tissue, or faeces.</p>
<p id="p0068" num="0068">In step 140a, i.e. step d), if a valid fitting result is achieved for the voxel, the voxel is classified into one type of material transitions (e.g. tissue/gas, gas/tagged material, or tagged material/tissue) based on the estimated model parameters.</p>
<p id="p0069" num="0069">In step 140b, if an invalid fitting result is achieved for the voxel, the voxel is classified into one of the at least two materials based on the estimated model parameters. In step 150, i.e. step e), steps a) to d) are repeated for a plurality of voxels in the image voxel data.</p>
<p id="p0070" num="0070">In an example, steps a) to d) are repeated for all voxels in the image voxel data.</p>
<p id="p0071" num="0071">In an example, steps a) to d) are repeated for part of the voxels in the image voxel data. For example, the plurality of voxels are voxels that are likely to be close to a material transition area. In other words, in order to reduce the computational effort for fitting, the fitting procedure may be started only for those voxels, which are likely to be close to a material transition. Image segmentation may be used to partition the image voxel data into multiple segments to determine the voxels that are likely to be close to a material transition area.<!-- EPO <DP n="12"> --></p>
<p id="p0072" num="0072">Optionally, at least two material transition models may be applied to the plurality of voxels in the image voxel data. In other words, it is optional to implement several models for different geometries, e.g. two-material transition, three-material transition, thin-wall embedded in another material, two-material-transition with a thin film of a third material, etc. It may be beneficial do the calculation as described for a given voxel i for all these models and select the best one, that is, the model with best fitting results.</p>
<p id="p0073" num="0073">In an example, as illustrated in step 160 of <figref idref="f0001">Fig. 1</figref>, an additional loop may be added that repeats steps a) to e) for other model(s). In other words, all voxels may be calculated with one material transition model, and then the calculation may be repeated for all voxels with another material transition model.</p>
<p id="p0074" num="0074">In another example (not shown), the calculation may be done for a given voxel with all material transition models, and then the calculation may be repeated for another voxel with all material transition models. In other words, an additional loop may be added to <figref idref="f0001">Fig. 1</figref> that repeats steps b) to d) for other model(s).</p>
<p id="p0075" num="0075">Optionally, the computer-implemented method 100 may further comprises the step of determining a respective concentration value for each of the plurality of voxels (i) based on the classified material transition, if a valid fitting result is achieved for the respective voxel, or (ii) based on the classified material, if an invalid fitting result is achieved for the respective voxel.</p>
<p id="p0076" num="0076">Once the distance <i>d</i> is known, the concentration of the two materials <i>c<sub>high</sub></i> and <i>c<sub>low</sub></i> in the voxel centered at position <b><i>r</i></b> can be calculated as the convolution of the calculated concentration profile with a Gauss function of width σ̃ centered at position <b><i>r</i></b>: <maths id="math0002" num=""><math display="block"><mrow><msub><mi>c</mi><mi mathvariant="italic">high</mi></msub><mfenced><mi mathvariant="bold-italic">r</mi></mfenced><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>erf</mi><mfrac><mi>d</mi><mrow><msqrt><mn>2</mn></msqrt><mover><mi mathvariant="normal">σ</mi><mrow><mo>˜</mo></mrow></mover></mrow></mfrac></mrow></math><img id="ib0002" file="imgb0002.tif" wi="45" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0003" num=""><math display="block"><mrow><msub><mi>c</mi><mi mathvariant="italic">low</mi></msub><mfenced><mi mathvariant="bold-italic">r</mi></mfenced><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>c</mi><mi mathvariant="italic">high</mi></msub><mfenced><mi>r</mi></mfenced><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>erf</mi><mfrac><mi>d</mi><mrow><msqrt><mn>2</mn></msqrt><mover><mi mathvariant="normal">σ</mi><mrow><mo>˜</mo></mrow></mover></mrow></mfrac></mrow></math><img id="ib0003" file="imgb0003.tif" wi="71" he="9" img-content="math" img-format="tif"/></maths></p>
<p id="p0077" num="0077">The width can be chosen arbitrarily and may not need to be the same as the width of the point spread function of the scanner.</p>
<p id="p0078" num="0078">For each material, e.g., air, tissue, tagged faeces, a concentration image of the same size of the original CT image is created: <i>c<sub>air</sub>, c<sub>tissue</sub>,</i> and <i>c<sub>faeces</sub>.</i> For each voxel <i>i,</i> it is decided, if the voxel belongs to a transition air-tissue, air-faeces, or tissue-faeces based on the distance <i>d</i> and the <i>m<sub>high</sub></i>(<i>i</i>) and <i>m<sub>low</sub></i>(<i>i</i>) material parameters.</p>
<p id="p0079" num="0079">The corresponding concentrations have the following values:<!-- EPO <DP n="13"> -->
<ul id="ul0004" list-style="none" compact="compact">
<li><i>c<sub>air</sub></i>(<i>i</i>) = <i>c<sub>low</sub></i>(<i>i</i>), <i>c<sub>tissue</sub></i>(<i>i</i>) = <i>c<sub>high</sub></i>(<i>i</i>), <i>and c<sub>faeces</sub></i>(<i>i</i>) = 0 for the air-tissue transition,</li>
<li><i>c<sub>air</sub></i>(<i>i</i>) = <i>c<sub>low</sub></i>(<i>i</i>)<i>, c<sub>tissue</sub></i>(<i>i</i>) = 0, <i>and c<sub>faeces</sub></i>(<i>i</i>) = <i>c<sub>high</sub></i>(<i>i</i>) for the air-faeces transition, and</li>
<li><i>c<sub>air</sub></i>(<i>i</i>) = 0, <i>c<sub>tissue</sub></i>(<i>i</i>) = <i>c<sub>low</sub></i>(<i>i</i>), <i>and c<sub>faeces</sub></i>(<i>i</i>) = <i>c<sub>high</sub></i>(<i>i</i>) for the air-faeces transition.</li>
</ul></p>
<p id="p0080" num="0080">If an invalid fitting result is achieved for the respective voxel, the corresponding value in the concentration images is replaced by values of a pure material. If necessary use region growing methods to fill these areas.</p>
<p id="p0081" num="0081">The tissue concentration image <i>c<sub>tissue</sub></i> represents the cleansed colon and can be visualized with Volume Rendering methods.</p>
<p id="p0082" num="0082">Images created by this method, such as model parameter images, fitting quality images, and derived quantity images, may be used to color the resulting surface mesh in order to visualize more information to the user.</p>
<p id="p0083" num="0083">Examples of the steps and intermediate results of this method are shown in <figref idref="f0003">Figs. 4A to 4E</figref>. These examples use a CT image of the abdomen as illustrated in <figref idref="f0003">Fig. 4A</figref> as input. Usually, the remaining faeces is tagged with iodine contrast agent prior to imaging.</p>
<p id="p0084" num="0084"><figref idref="f0003">Figs. 4B to 4D</figref> illustrate three model parameter images. In particular, <figref idref="f0003">Fig. 4B</figref> illustrates a distance image representative of the absolute value of the distance <i>d</i> obtained after fitting a two-material transition model to the three-dimensional medical image illustrated in <figref idref="f0003">Fig. 4A. Fig. 4C</figref> illustrates an image representative of the value of <i>m<sub>low</sub></i> obtained after fitting a two-material transition model to the three-dimensional medical image illustrated in <figref idref="f0003">Fig. 4A. Fig. 4D</figref> illustrates an image representative of the value of <i>m<sub>high</sub></i> obtained after fitting a two-material transition model to the three-dimensional medical image illustrated in <figref idref="f0003">Fig. 4A</figref>.</p>
<p id="p0085" num="0085"><figref idref="f0003">Fig. 4E</figref> illustrates an optimality image representative of the value of the optimality for characterizing the fitting quality.</p>
<p id="p0086" num="0086">As can be seen from the images, even small structures like the folds are captured by the model fit.</p>
<p id="p0087" num="0087">The method described above may be extended for spectral CT. In spectral CT, e.g. with the Philips "IQon Spectral CT" it is possible to create synthesized monoenergetic images at different keV values. In other words, the at least one three-dimensional medical image may comprise synthesized monoenergetic images acquired at different energies. In these monoenergetic images, different materials show different contrast. Spectral CT has the<!-- EPO <DP n="14"> --> potential to better discriminate different materials (e.g. faeces and tissue) than conventional CT. Spectral Virtual Colonoscopy may lead to a higher specificity of the screening even without bowel preparation.</p>
<p id="p0088" num="0088">With little variations, the method described above can take advantage of the additional information available from two or more CT with different spectral properties and that results in a more robust solution.</p>
<p id="p0089" num="0089">Turning to <figref idref="f0001">Fig. 1</figref>, in step 120, the behavior of the image intensities at material transitions in each of the synthesized monoenergetic images is modelled by a respective material transition model.</p>
<p id="p0090" num="0090">For example, in spectral CT, <i>n</i> different spectral input images <i>I<sub>i</sub></i> can be used with <i>n</i>=2, 3,... and <i>i</i>=1,..., <i>n.</i> An example is dual-energy spectral CT with two monoergetic images <i>I<sub>1</sub></i> at 45 KeV and <i>I<sub>2</sub></i> at 125 KeV.</p>
<p id="p0091" num="0091">The material transition (e.g. two-material transition or three-material transition) is now modelled by <i>n</i> different model functions <i>g<sub>i</sub></i>(<i>m<sub>i,high</sub>, m<sub>i,low</sub>, d, <b>n</b>, σ</i>) with <i>i</i>=1,..., <i>n.</i> The material parameters <i>m<sub>i,high</sub>, m<sub>i,low</sub></i> are different for each of the spectral image <i>I<sub>i</sub></i> simultaneously, while the geometric parameters <i>d, n,</i> and <i>σ</i> are the same. The model fitting is done to optimize to the matching of the model functions <i>g<sub>i</sub></i> with all the spectral images <i>I<sub>i</sub></i> simultaneously.</p>
<p id="p0092" num="0092">For each voxel <i>j,</i> the material parameters <i>m<sub>i,high</sub></i>(<i>j</i>)<i>, m<sub>i,iow</sub></i>(<i>j</i>) and the geometric parameters <i>d(j), <b>n</b></i>(<i>j</i>)<i>, σ</i>(<i>j</i>) can be obtained by fitting the <i>n</i> material transition models to the image intensities of the local environment for each spectral image <i>I<sub>i</sub></i>.</p>
<p id="p0093" num="0093">Steps 130 to 150 do not change.</p>
<p id="p0094" num="0094">The method described above may be also extended for MRI, such as standard MRI or multi-parametric MRI.</p>
<p id="p0095" num="0095">The exemplary method illustrated in <figref idref="f0001">Fig. 1</figref> may be directly applied to standard MRI.</p>
<p id="p0096" num="0096">For multi-parametric MR images, the at least one three-dimensional medical image comprises a sequence of multi-parametric MR images.</p>
<p id="p0097" num="0097">Turning to <figref idref="f0001">Fig. 1</figref>, in step 120, the behavior of the image intensities at material transitions in each of the multi-parametric MR images is modelled by a respective material transition model.</p>
<p id="p0098" num="0098">Similar to the above-mentioned spectral CT, the material transition (e.g. two-material transition or three-material transition) is also modelled by <i>n</i> different model functions <i>g<sub>i</sub></i>(<i>m<sub>i,high</sub>, m<sub>i,low</sub>, d, <b>n</b>, σ</i>) with <i>i</i>=1,..., <i>n.</i> The material parameters <i>m<sub>i,high</sub>, m<sub>i,low</sub></i> are<!-- EPO <DP n="15"> --> different for each of the multi-parametric MR images, while the geometric parameters <i>d, <b>n</b>,</i> and <i>σ</i> are the same. The model fitting is done to optimize to the matching of the model functions <i>g<sub>i</sub></i> with all the multi-parametric MR images, simultaneously.</p>
<p id="p0099" num="0099">It will be appreciated that the above operation may be performed in any suitable order, e.g., consecutively, simultaneously, or a combination thereof, subject to, where applicable, a particular order being necessitated, e.g., by input/output relations. For example, steps a) to d) may be performed simultaneously for many voxels. In other words, steps a) to d) and step e) may be performed simultaneously or consecutively.</p>
<p id="p0100" num="0100"><figref idref="f0004">Fig. 5</figref> schematically shows an example of an apparatus 200 for processing image voxel data representative of at least one three-dimensional medical image of an imaging modality of an object of interest to classify transitions between at least two materials in the object of interest.</p>
<p id="p0101" num="0101">The apparatus 200 may comprise an input unit 210, a processing unit 220, and an output unit 230. The input unit 210, the processing unit 220, and the output unit 230 may be a software, or hardware dedicated to running said software, for delivering the corresponding functionality. Each unit may be part of, or include an Application Specific Integrated Circuit (ASIC), an electronic circuit, a processor (shared, dedicated, or group) and/or memory (shared, dedicated, or group) that execute one or more software or firmware programs, a combinational logical circuit, and/or other suitable components that provide the described functionality.</p>
<p id="p0102" num="0102">The apparatus 200 may be any computing device, such as mobile devices, laptop and desktop computers, wearable computing devices, and other computing devices, suitable for processing image voxel data.</p>
<p id="p0103" num="0103">The input unit 210 is configured to receive image voxel data representative of at least one three-dimensional medical image of an imaging modality of an object of interest. Examples of the imaging modality may include, but are not limited to, CT and MRI.</p>
<p id="p0104" num="0104">The processing unit 220 is configured to perform the method steps described above.</p>
<p id="p0105" num="0105">The output unit 230 is configured to output a processing result e.g. to a display (for example, a built-in screen, a connected monitor or projector) or to a file storage (for example, a hard drive or a solid state drive).</p>
<p id="p0106" num="0106"><figref idref="f0004">Fig. 6</figref> schematically shows a medical imaging system 300 according to some embodiments of the present disclosure.<!-- EPO <DP n="16"> --></p>
<p id="p0107" num="0107">The medical imaging system 300 comprises a scanner 310 configured to scan an object of interest to acquire at least one three-dimensional image of the object of interest. The scanner 310 may be a CT-scanner or an MRI scanner.</p>
<p id="p0108" num="0108">The medical imaging system 300 further comprises an apparatus 200 for processing image voxel data representative of the at least one three-dimensional image.</p>
<p id="p0109" num="0109">All definitions, as defined and used herein, should be understood to control over dictionary definitions, definitions in documents incorporated by reference, and/or ordinary meanings of the defined terms.</p>
<p id="p0110" num="0110">The indefinite articles "a" and "an," as used herein in the specification and in the claims, unless clearly indicated to the contrary, should be understood to mean "at least one."</p>
<p id="p0111" num="0111">The phrase "and/or," as used herein in the specification and in the claims, should be understood to mean "either or both" of the elements so conjoined, i.e., elements that are conjunctively present in some cases and disjunctively present in other cases. Multiple elements listed with "and/or" should be construed in the same fashion, i.e., "one or more" of the elements so conjoined. Other elements may optionally be present other than the elements specifically identified by the "and/or" clause, whether related or unrelated to those elements specifically identified.</p>
<p id="p0112" num="0112">As used herein in the specification and in the claims, the phrase "at least one," in reference to a list of one or more elements, should be understood to mean at least one element selected from any one or more of the elements in the list of elements, but not necessarily including at least one of each and every element specifically listed within the list of elements and not excluding any combinations of elements in the list of elements. This definition also allows that elements may optionally be present other than the elements specifically identified within the list of elements to which the phrase "at least one" refers, whether related or unrelated to those elements specifically identified.</p>
<p id="p0113" num="0113">In the claims, as well as in the specification above, all transitional phrases such as "comprising," "including," "carrying," "having," "containing," "involving," "holding," "composed of," and the like are to be understood to be open-ended, i.e., to mean including but not limited to. Only the transitional phrases "consisting of' and "consisting essentially of' shall be closed or semi-closed transitional phrases, respectively.</p>
<p id="p0114" num="0114">In another exemplary embodiment of the present invention, a computer program or a computer program element is provided that is characterized by being adapted to<!-- EPO <DP n="17"> --> execute the method steps of the method according to one of the preceding embodiments, on an appropriate system.</p>
<p id="p0115" num="0115">The computer program element might therefore be stored on a computer unit, which might also be part of an embodiment of the present invention. This computing unit may be adapted to perform or induce a performing of the steps of the method described above. Moreover, it may be adapted to operate the components of the above described apparatus. The computing unit can be adapted to operate automatically and/or to execute the orders of a user. A computer program may be loaded into a working memory of a data processor. The data processor may thus be equipped to carry out the method of the invention.</p>
<p id="p0116" num="0116">This exemplary embodiment of the invention covers both, a computer program that right from the beginning uses the invention and a computer program that by means of an up-date turns an existing program into a program that uses the invention.</p>
<p id="p0117" num="0117">Further on, the computer program element might be able to provide all necessary steps to fulfil the procedure of an exemplary embodiment of the method as described above.</p>
<p id="p0118" num="0118">According to a further exemplary embodiment of the present invention, a computer readable medium, such as a CD-ROM, is presented wherein the computer readable medium has a computer program element stored on it which computer program element is described by the preceding section.</p>
<p id="p0119" num="0119">A computer program may be stored and/or distributed on a suitable medium, such as an optical storage medium or a solid state medium supplied together with or as part of other hardware, but may also be distributed in other forms, such as via the internet or other wired or wireless telecommunication systems.</p>
<p id="p0120" num="0120">However, the computer program may also be presented over a network like the World Wide Web and can be downloaded into the working memory of a data processor from such a network. According to a further exemplary embodiment of the present invention, a medium for making a computer program element available for downloading is provided, which computer program element is arranged to perform a method according to one of the previously described embodiments of the invention.</p>
<p id="p0121" num="0121">It has to be noted that embodiments of the invention are described with reference to different subject matters. In particular, some embodiments are described with reference to method type claims whereas other embodiments are described with reference to the device type claims. However, a person skilled in the art will gather from the above and the following description that, unless otherwise notified, in addition to any combination of<!-- EPO <DP n="18"> --> features belonging to one type of subject matter also any combination between features relating to different subject matters is considered to be disclosed with this application. However, all features can be combined providing synergetic effects that are more than the simple summation of the features.</p>
<p id="p0122" num="0122">While the invention has been illustrated and described in detail in the drawings and foregoing description, such illustration and description are to be considered illustrative or exemplary and not restrictive. The invention is not limited to the disclosed embodiments. Other variations to the disclosed embodiments can be understood and effected by those skilled in the art in practicing a claimed invention, from a study of the drawings, the disclosure, and the dependent claims.</p>
</description>
<claims id="claims01" lang="en"><!-- EPO <DP n="19"> -->
<claim id="c-en-0001" num="0001">
<claim-text>A computer-implemented method (100) for processing image voxel data representative of at least one three-dimensional medical image of an imaging modality of an object of interest to classify transitions between at least two materials in the object of interest, comprising:
<claim-text>a) selecting (110) a local environment around a voxel in the image voxel data;</claim-text>
<claim-text>b) fitting (120) a material transition model to image intensities of the local environment of the voxel to estimate model parameters of the material transition model and to derive one or more quantities for characterizing a fitting quality of the model fit for the voxel, wherein the material transition model is constructed that corresponds to a behavior of the image intensities at material transitions;</claim-text>
<claim-text>c) determining (130) whether a valid fitting result is achieved for the voxel based on at least one of the one or more derived quantities and the model parameters;</claim-text>
<claim-text>d) classifying (140a) the voxel into one type of material transitions based on the estimated model parameters, if a valid fitting result is achieved for the voxel; or<br/>
classifying (140b) the voxel into one of the at least two materials based on the estimated model parameters, if an invalid fitting result is achieved for the voxel; and</claim-text>
<claim-text>e) repeating (150) steps a) to d) for a plurality of voxels in the image voxel data.</claim-text></claim-text></claim>
<claim id="c-en-0002" num="0002">
<claim-text>Method according to claim 1,<br/>
wherein at least two material transition models are applied to the plurality of voxels in the image voxel data.</claim-text></claim>
<claim id="c-en-0003" num="0003">
<claim-text>Method according to claim 1 or 2, further comprising:
<claim-text>- determining a respective concentration value for each of the plurality of voxels (i) based on the classified material transition, if a valid fitting result is achieved for the respective voxel, or (ii) based on the classified material, if an invalid fitting result is achieved for the respective voxel; and</claim-text>
<claim-text>- creating at least one concentration image for the at least two materials based on the determined concentration values of the plurality of voxels.</claim-text><!-- EPO <DP n="20"> --></claim-text></claim>
<claim id="c-en-0004" num="0004">
<claim-text>Method according to any one of the preceding claims,<br/>
wherein the plurality of voxels are voxels that are likely to be close to a material transition area.</claim-text></claim>
<claim id="c-en-0005" num="0005">
<claim-text>Method according to any one of the preceding claims,<br/>
wherein the imaging modality comprises computed tomography, CT.</claim-text></claim>
<claim id="c-en-0006" num="0006">
<claim-text>Method according to claim 5,<br/>
wherein the at least one three-dimensional medical image comprises synthesized monoenergetic images acquired at different energies;<br/>
wherein the behavior of the image intensities at material transitions in each of the synthesized monoenergetic images is modelled by a respective material transition model; and<br/>
wherein each material transition model has same geometric parameters.</claim-text></claim>
<claim id="c-en-0007" num="0007">
<claim-text>Method according to any one of the preceding claims,<br/>
wherein the imaging modality comprises magnetic resonance, MR, imaging.</claim-text></claim>
<claim id="c-en-0008" num="0008">
<claim-text>Method according to claim 7,<br/>
wherein the at least one three-dimensional medical image comprises a sequence of multi-parametric MR images;<br/>
wherein the behavior of the image intensities at material transitions in each of the multi-parametric MR images is modelled by a respective material transition model; and<br/>
wherein each material transition model has same geometric parameters.</claim-text></claim>
<claim id="c-en-0009" num="0009">
<claim-text>Method according to any one of the preceding claims, further comprising:
<claim-text>- removing effects of an undesired material of the at least two materials from the image voxel data based on a result of classification.</claim-text></claim-text></claim>
<claim id="c-en-0010" num="0010">
<claim-text>Method according to any one of the preceding claims,<br/>
wherein at least one of the following images is created:
<claim-text>- a model parameter image illustrative of the model parameters;<!-- EPO <DP n="21"> --></claim-text>
<claim-text>- a fitting quality image illustrate of the one or more derived quantity characterizing the fitting quality of the model fit; and</claim-text>
<claim-text>- one or more concentration images.</claim-text></claim-text></claim>
<claim id="c-en-0011" num="0011">
<claim-text>Method according to claim 10, further comprising:
<claim-text>- visualizing at least one of the created images.</claim-text></claim-text></claim>
<claim id="c-en-0012" num="0012">
<claim-text>Method according to any one of the preceding claims,<br/>
wherein the object of interest comprises a colon; and<br/>
wherein the at least two materials comprise gas, stool tagged with stool tagging agent, and tissue.</claim-text></claim>
<claim id="c-en-0013" num="0013">
<claim-text>An apparatus (200) comprising a processor configured to perform the method steps of any one of claims 1 to 12.</claim-text></claim>
<claim id="c-en-0014" num="0014">
<claim-text>A medical imaging system (300), comprising:
<claim-text>- a scanner (310) configured to scan an object of interest to acquire at least one three-dimensional image of the object of interest; and</claim-text>
<claim-text>- an apparatus according to claim 13 for processing image voxel data representative of the at least one three-dimensional image.</claim-text></claim-text></claim>
<claim id="c-en-0015" num="0015">
<claim-text>A computer program element configured, during execution, to perform the method steps of any one of claims 1 to 12.</claim-text></claim>
</claims>
<drawings id="draw" lang="en"><!-- EPO <DP n="22"> -->
<figure id="f0001" num="1a,1b,1c,1d,1e"><img id="if0001" file="imgf0001.tif" wi="157" he="205" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="23"> -->
<figure id="f0002" num="2,3"><img id="if0002" file="imgf0002.tif" wi="129" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="24"> -->
<figure id="f0003" num="4A,4B,4C,4D,4E"><img id="if0003" file="imgf0003.tif" wi="141" he="214" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="25"> -->
<figure id="f0004" num="5,6"><img id="if0004" file="imgf0004.tif" wi="93" he="203" img-content="drawing" img-format="tif"/></figure>
</drawings>
<search-report-data id="srep" lang="en" srep-office="EP" date-produced=""><doc-page id="srep0001" file="srep0001.tif" wi="151" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="151" he="233" type="tif"/><doc-page id="srep0003" file="srep0003.tif" wi="155" he="233" type="tif"/></search-report-data><search-report-data date-produced="20200915" id="srepxml" lang="en" srep-office="EP" srep-type="ep-sr" status="n"><!--
 The search report data in XML is provided for the users' convenience only. It might differ from the search report of the PDF document, which contains the officially published data. The EPO disclaims any liability for incorrect or incomplete data in the XML for search reports.
 -->

<srep-info><file-reference-id>2019P00949EP</file-reference-id><application-reference><document-id><country>EP</country><doc-number>20167664.0</doc-number></document-id></application-reference><applicant-name><name>Koninklijke Philips N.V.</name></applicant-name><srep-established srep-established="yes"/><srep-invention-title title-approval="yes"/><srep-abstract abs-approval="yes"/><srep-figure-to-publish figinfo="by-applicant"><figure-to-publish><fig-number>1</fig-number></figure-to-publish></srep-figure-to-publish><srep-info-admin><srep-office><addressbook><text>MN</text></addressbook></srep-office><date-search-report-mailed><date>20200923</date></date-search-report-mailed></srep-info-admin></srep-info><srep-for-pub><srep-fields-searched><minimum-documentation><classifications-ipcr><classification-ipcr><text>G06T</text></classification-ipcr></classifications-ipcr></minimum-documentation></srep-fields-searched><srep-citations><citation id="sr-cit0001"><nplcit id="sr-ncit0001" npl-type="b"><article><author><name>Iwo Serlie ET AL</name></author><atl>Computed Cleansing for Virtual Colonoscopy Using a Three-Material Transition Model</atl><book><book-title>LECTURE NOTES IN COMPUTER SCIENCE</book-title><imprint><address><text>Berlin, Heidelberg</text></address><name>Springer Berlin Heidelberg</name><pubdate>20030101</pubdate></imprint><vid>2879</vid><location><pp><ppf>175</ppf><ppl>183</ppl></pp></location><issn>0302-9743</issn><isbn>978-3-54-045234-8</isbn><refno>XP055096939</refno></book></article></nplcit><category>X</category><rel-claims>1-15</rel-claims><rel-passage><passage>* abstract *</passage><passage>* section 3 Method *</passage></rel-passage></citation><citation id="sr-cit0002"><nplcit id="sr-ncit0002" npl-type="s"><article><author><name>LIHONG LI ET AL</name></author><atl>Image segmentation approach to extract colon lumen through colonic material tagging and hidden Markov random field model for virtual colonoscopy</atl><serial><sertitle>PROCEEDINGS OF SPIE, IEEE, US</sertitle><pubdate>20020101</pubdate><vid>4683</vid><doi>10.1117/12.463607</doi><isbn>978-1-62841-730-2</isbn></serial><location><pp><ppf>406</ppf><ppl>411</ppl></pp></location><refno>XP002421709</refno></article></nplcit><category>A</category><rel-claims>1-15</rel-claims><rel-passage><passage>* the whole document *</passage></rel-passage></citation><citation id="sr-cit0003"><nplcit id="sr-ncit0003" npl-type="s"><article><author><name>SERLIE I ET AL</name></author><atl>Probabilistic method for virtual colonoscopy cleansing</atl><serial><sertitle>PROCEEDINGS OF SPIE; MEDICAL IMAGING 2003. PHYSIOLOGY AND FUNCTION: METHODS, SYSTEMS, AND APPLICATIONS, IEEE, US; SAN DIEGO, CA, USA</sertitle><pubdate>20030101</pubdate><vid>5031</vid><doi>10.1117/12.480403</doi><isbn>978-1-62841-730-2</isbn></serial><location><pp><ppf>405</ppf><ppl>412</ppl></pp></location><refno>XP008166714</refno></article></nplcit><category>A</category><rel-claims>1-15</rel-claims><rel-passage><passage>* the whole document *</passage></rel-passage></citation><citation id="sr-cit0004"><patcit dnum="US2011206250A1" id="sr-pcit0001" url="http://v3.espacenet.com/textdoc?DB=EPODOC&amp;IDX=US2011206250&amp;CY=ep"><document-id><country>US</country><doc-number>2011206250</doc-number><kind>A1</kind><name>MCGINNIS RYAN [US] ET AL</name><date>20110825</date></document-id></patcit><category>A</category><rel-claims>1-15</rel-claims><rel-passage><passage>* the whole document *</passage></rel-passage></citation><citation id="sr-cit0005"><nplcit id="sr-ncit0004" npl-type="s"><article><author><name>SERLIEI ET AL</name></author><atl>Computed Cleansing for Virtual Colonoscopy Using a Three-Material Transition Model</atl><serial><sertitle>ELECTRONIC PUBLISHING, ARTISTIC IMAGING, AND DIGITAL TYPOGRAPHY; [LECTURE NOTES IN COMPUTER SCIENCE , ISSN 0302-9743], SPRINGER VERLAG, DE</sertitle><pubdate>20031115</pubdate><vid>2879</vid><ino>PART 2</ino><isbn>978-3-540-24128-7</isbn></serial><location><pp><ppf>175</ppf><ppl>183</ppl></pp></location><refno>XP002382021</refno></article></nplcit><category>A</category><rel-claims>1-15</rel-claims><rel-passage><passage>* the whole document *</passage></rel-passage></citation><citation id="sr-cit0006"><nplcit id="sr-ncit0005" npl-type="s"><article><author><name>ZHANG WEIDONG ET AL</name></author><atl>Fully automatic colon segmentation in computed tomography colonography</atl><serial><sertitle>2016 IEEE INTERNATIONAL CONFERENCE ON SIGNAL AND IMAGE PROCESSING (ICSIP), IEEE</sertitle><pubdate>20160813</pubdate><doi>10.1109/SIPROCESS.2016.7888222</doi></serial><location><pp><ppf>51</ppf><ppl>55</ppl></pp></location><refno>XP033081809</refno></article></nplcit><category>A</category><rel-claims>1-15</rel-claims><rel-passage><passage>* the whole document *</passage></rel-passage></citation></srep-citations><srep-admin><examiners><primary-examiner><name>Blaszczyk, Marek</name></primary-examiner></examiners><srep-office><addressbook><text>Munich</text></addressbook></srep-office><date-search-completed><date>20200915</date></date-search-completed></srep-admin><!--							The annex lists the patent family members relating to the patent documents cited in the above mentioned European search report.							The members are as contained in the European Patent Office EDP file on							The European Patent Office is in no way liable for these particulars which are merely given for the purpose of information.							For more details about this annex : see Official Journal of the European Patent Office, No 12/82						--><srep-patent-family><patent-family><priority-application><document-id><country>US</country><doc-number>2011206250</doc-number><kind>A1</kind><date>20110825</date></document-id></priority-application><text>NONE</text></patent-family></srep-patent-family></srep-for-pub></search-report-data>
</ep-patent-document>
