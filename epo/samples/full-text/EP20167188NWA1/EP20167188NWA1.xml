<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE ep-patent-document PUBLIC "-//EPO//EP PATENT DOCUMENT 1.5.1//EN" "ep-patent-document-v1-5-1.dtd">
<!-- This XML data has been generated under the supervision of the European Patent Office -->
<ep-patent-document id="EP20167188A1" file="EP20167188NWA1.xml" lang="en" country="EP" doc-number="3889905" kind="A1" date-publ="20211006" status="n" dtd-version="ep-patent-document-v1-5-1">
<SDOBI lang="en"><B000><eptags><B001EP>ATBECHDEDKESFRGBGRITLILUNLSEMCPTIESILTLVFIROMKCYALTRBGCZEEHUPLSKBAHRIS..MTNORSMESMMAKHTNMD..........</B001EP><B005EP>J</B005EP><B007EP>BDM Ver 2.0.12 (4th of August) -  1100000/0</B007EP></eptags></B000><B100><B110>3889905</B110><B120><B121>EUROPEAN PATENT APPLICATION</B121></B120><B130>A1</B130><B140><date>20211006</date></B140><B190>EP</B190></B100><B200><B210>20167188.0</B210><B220><date>20200331</date></B220><B250>en</B250><B251EP>en</B251EP><B260>en</B260></B200><B400><B405><date>20211006</date><bnum>202140</bnum></B405><B430><date>20211006</date><bnum>202140</bnum></B430></B400><B500><B510EP><classification-ipcr sequence="1"><text>G06T   7/60        20170101AFI20200803BHEP        </text></classification-ipcr><classification-ipcr sequence="2"><text>B60D   1/00        20060101ALI20200803BHEP        </text></classification-ipcr><classification-ipcr sequence="3"><text>G06T   7/73        20170101ALI20200803BHEP        </text></classification-ipcr></B510EP><B520EP><classifications-cpc><classification-cpc sequence="1"><text>G06T   7/60        20130101 FI20200729BHEP        </text></classification-cpc><classification-cpc sequence="2"><text>G06T2207/30252     20130101 LA20200729BHEP        </text></classification-cpc><classification-cpc sequence="3"><text>G06T2207/10016     20130101 LA20200729BHEP        </text></classification-cpc><classification-cpc sequence="4"><text>G06T   7/73        20170101 LI20200729BHEP        </text></classification-cpc></classifications-cpc></B520EP><B540><B541>de</B541><B542>VERFAHREN UND SYSTEM ZUR BERECHNUNG DES FAHRZEUGANHÄNGERWINKELS</B542><B541>en</B541><B542>METHOD AND SYSTEM FOR CALCULATING VEHICLE TRAILER ANGLE</B542><B541>fr</B541><B542>PROCÉDÉ ET SYSTÈME DE CALCUL D'ANGLE DE REMORQUE DE VÉHICULE</B542></B540><B590><B598>5</B598></B590></B500><B700><B710><B711><snm>Continental Automotive GmbH</snm><iid>101676895</iid><irf>2020P01192EP (NU)</irf><adr><str>Vahrenwalder Straße 9</str><city>30165 Hannover</city><ctry>DE</ctry></adr></B711></B710><B720><B721><snm>Plowman, Robin</snm><adr><str>c/o Conti Temic microelectronic GmbH
Intellectual Property
Sieboldstraße 19</str><city>90411 Nürnberg</city><ctry>DE</ctry></adr></B721><B721><snm>Kadyrov, Alexander</snm><adr><str>c/o Conti Temic microelectronic GmbH
Intellectual Property 
Sieboldstraße 19</str><city>90411 Nürnberg</city><ctry>DE</ctry></adr></B721></B720><B740><B741><snm>Continental Corporation</snm><iid>101882523</iid><adr><str>c/o Conti Temic microelectronic GmbH 
Intellectual Property 
Sieboldstraße 19</str><city>90411 Nürnberg</city><ctry>DE</ctry></adr></B741></B740></B700><B800><B840><ctry>AL</ctry><ctry>AT</ctry><ctry>BE</ctry><ctry>BG</ctry><ctry>CH</ctry><ctry>CY</ctry><ctry>CZ</ctry><ctry>DE</ctry><ctry>DK</ctry><ctry>EE</ctry><ctry>ES</ctry><ctry>FI</ctry><ctry>FR</ctry><ctry>GB</ctry><ctry>GR</ctry><ctry>HR</ctry><ctry>HU</ctry><ctry>IE</ctry><ctry>IS</ctry><ctry>IT</ctry><ctry>LI</ctry><ctry>LT</ctry><ctry>LU</ctry><ctry>LV</ctry><ctry>MC</ctry><ctry>MK</ctry><ctry>MT</ctry><ctry>NL</ctry><ctry>NO</ctry><ctry>PL</ctry><ctry>PT</ctry><ctry>RO</ctry><ctry>RS</ctry><ctry>SE</ctry><ctry>SI</ctry><ctry>SK</ctry><ctry>SM</ctry><ctry>TR</ctry></B840><B844EP><B845EP><ctry>BA</ctry></B845EP><B845EP><ctry>ME</ctry></B845EP></B844EP><B848EP><B849EP><ctry>KH</ctry></B849EP><B849EP><ctry>MA</ctry></B849EP><B849EP><ctry>MD</ctry></B849EP><B849EP><ctry>TN</ctry></B849EP></B848EP></B800></SDOBI>
<abstract id="abst" lang="en">
<p id="pa01" num="0001">The invention relates to a method for determining the yaw angle (YA) of a trailer (2) with respect to the longitudinal axis (LAV) of a towing vehicle (1) based on a feature included in multiple captured images by establishing a perpendicular bisector (B1).
<img id="iaf01" file="imgaf001.tif" wi="97" he="122" img-content="drawing" img-format="tif"/></p>
</abstract>
<description id="desc" lang="en"><!-- EPO <DP n="1"> -->
<p id="p0001" num="0001">The present invention relates generally to the field of vehicle assistance systems. More specifically, the present invention relates to a method and a system for calculating yaw angle of a trailer coupled with a towing vehicle based on image information provided by a camera of the vehicle.</p>
<p id="p0002" num="0002">Methods for calculating the angle of a trailer with respect to the towing vehicle based on image information provided by a camera of the vehicle are already known.</p>
<p id="p0003" num="0003">Specifically, methods are known which have low computational complexity but do not provide robust angle information in case of poor-quality images. In addition, in known methods the exact position of the towball has to be known in order to determine yaw angle.</p>
<p id="p0004" num="0004">It is an objective of the embodiments of the invention to provide a method for calculating yaw angle of a trailer with high robustness and high reliability without having knowledge of the position of the towball. The objective is solved by the features of the independent claims. Preferred embodiments are given in the dependent claims. If not explicitly indicated otherwise, embodiments of the invention can be freely combined with each other.</p>
<p id="p0005" num="0005">According to an aspect, the invention refers to a method for determining the yaw angle of a trailer with respect to the longitudinal axis of a towing vehicle. The method comprises the following steps:<br/>
<!-- EPO <DP n="2"> -->First, at least a first and a second image of the trailer is captured using a camera. The first and second image is captured such that the orientation of the trailer with respect to the vehicle is different on the at least two images.</p>
<p id="p0006" num="0006">After capturing said images, at least a first feature of the trailer is determined. Said first feature has to be visible on first and second image. For example, the first feature may be a conspicuous first characteristic at a first location of the trailer.</p>
<p id="p0007" num="0007">After feature determination, a ray between the camera and determined first feature on the first image is established and said ray is projected onto a horizontal plane thereby obtaining a first projected feature position. Similarly, a ray between the camera and determined first feature on the second image is established and said ray is projected onto said horizontal plane thereby obtaining a second projected feature position. Said projection of features, respectively, rays may be performed in a vertical direction, i.e. a slanted ray may be transferred in a horizontal ray without changing the azimuth.</p>
<p id="p0008" num="0008">Based on said projections of first feature, a first perpendicular bisector is established between the location of the first projected feature position and the location of the second projected feature position. More in detail, the first perpendicular bisector may be a perpendicular straight line running through the centre of the line connecting an intersection of a first ray with a horizontal plane (e.g. at z=1) and the location of an intersection of a second ray with the horizontal plane. The first ray is determined by converting the image coordinates of the first feature in the first image into an optical ray using the cameras calibration information. The second ray is determined by converting the image coordinates of the first feature in the second image into an optical ray using the cameras calibration<!-- EPO <DP n="3"> --> information. Said first perpendicular bisector may be established in a horizontal plane.</p>
<p id="p0009" num="0009">After establishing said first perpendicular bisector, a first intersection point of first perpendicular bisector with a reference axis is determined. The reference axis may be the central longitudinal axis of the car, on which the camera and towball both lie. Thus, this intersection point represents the centre of rotation of the first feature.</p>
<p id="p0010" num="0010">Finally, the yaw angle of the trailer is calculated based on a first angle estimation, said first angle estimation referring to the angle between a first line running from first projected feature position to said first intersection point and a second line running from second projected feature position to said first intersection point in said horizontal plane .</p>
<p id="p0011" num="0011">Said method is advantageous because due to using two or more images and using one or more trailer features for establishing one or more perpendicular bisectors and calculating the yaw angle based on said one or more perpendicular bisectors, the results of yaw angle determination are very accurate and robust even when the detection of trailer features suffers from high noise or the quality of the images is poor. In addition, due to using a perpendicular bisector, for determining the yaw angle, the exact position of the towball can be unknown.</p>
<p id="p0012" num="0012">According to an embodiment, on first or second image, the yaw angle of the trailer with respect to the vehicle is zero. Thereby, said image can be used as "zero-pose image", i.e. as a reference of an exact alignment of the longitudinal axis of the vehicle with the longitudinal axis of the trailer. However, also another yaw angle value can be used as reference value. If said other yaw angle is not known, the system can calculate the change in trailer angle, rather than an absolute trailer angle.<!-- EPO <DP n="4"> --></p>
<p id="p0013" num="0013">According to an embodiment, the method further comprises the following steps:
<ul id="ul0001" list-style="dash">
<li>In addition to the first feature, a second feature of the trailer is determined which is visible on first and second image. Said second feature is arranged at a different position of the trailer than the first feature. The second feature may be a conspicuous second characteristic at a second location of the trailer.</li>
<li>In addition, a ray between the camera and determined second feature on the first image is projected onto said horizontal plane thereby obtaining a third projected feature position. Similarly, a ray between the camera and determined second feature on the second image is projected onto said horizontal plane thereby obtaining a fourth projected feature position.</li>
<li>Furthermore, a second perpendicular bisector is established between the location of the third projected feature position and the location of the fourth projected feature position.</li>
<li>Based on said second perpendicular bisector, a second intersection point of second perpendicular bisector with said reference axis is determined.</li>
<li>Based on second perpendicular bisector, a second angle estimation is established, the second angle estimation referring to the angle between a first line running from third projected feature position to said second intersection point and a second line running from fourth projected feature position to said second intersection point in said horizontal plane.<!-- EPO <DP n="5"> --></li>
<li>Finally, the yaw angle is calculated based on said first and second angle estimations.</li>
</ul></p>
<p id="p0014" num="0014">By using two or more trailer features and multiple perpendicular bisectors, the noise and mismatches in determining the pivot angle between perpendicular bisector and reference axis can be mitigated.</p>
<p id="p0015" num="0015">According to an embodiment, in addition to said first and second feature, at least one further feature of the trailer is used for calculating the yaw angle. Using three or more features further increases the robustness and reliability of yaw angle determination.</p>
<p id="p0016" num="0016">According to an embodiment, the yaw angle is calculated by establishing the median value based on the at least two angle estimations. Thereby, a very stable yaw angle determination can be obtained.</p>
<p id="p0017" num="0017">According to other embodiments, the yaw angle is calculated by establishing an average value of the at least two angle estimations or by using a statistical approach applied to said angle estimations.</p>
<p id="p0018" num="0018">According to an embodiment, the method further comprises the step of determining an angle window. Said angle window may comprise an upper and a lower bound around said yaw angle. In addition, a set of features is determined, said features within said set of features leading to angle estimations which are located within said angle window. Said determined set of features, preferably, only features included in said set of features are used for future yaw angle calculations. So, in other words, information of previous yaw angle determinations is used to determine two or more features of the trailer which lead to angle estimations quite close to determined yaw angle (i.e. within the angle window) and to not track those features which lead to angle estimations significantly deviating from<!-- EPO <DP n="6"> --> determined yaw angle (i.e. out of the angle window). Thereby, the computational complexity and accuracy of angle estimation can be significantly reduced.</p>
<p id="p0019" num="0019">According to an embodiment, camera calibration information is used for converting the position of said first and/or second feature from local domain of the image into local domain of the vehicle. For example, having knowledge of camera position using camera calibration information, the position of a certain feature on the image can be transferred in location information depending on or being correlated with the position of the camera included or attached to the vehicle.</p>
<p id="p0020" num="0020">According to an embodiment, the reference axis is the longitudinal axis of the towing vehicle if the camera and the towball of the vehicle are arranged in a vertically oriented plane which comprises said longitudinal axis of the towing vehicle. So, in other words, the yaw angle is determined based on angle estimations, said angle estimations referring to angles between the longitudinal axis of the towing vehicle and the established perpendicular bisectors.</p>
<p id="p0021" num="0021">According to another embodiment, the reference axis is a straight line running between the camera and the towball if the camera and/or the towball have a lateral offset with respect to the longitudinal axis of the towing vehicle. Thereby, a lateral offset between the camera and the towball can be compensated.</p>
<p id="p0022" num="0022">According to an embodiment, the camera is the rear view camera of the vehicle. Based on the rear view camera, images of the trailer can be captured with reduced technical effort.<!-- EPO <DP n="7"> --></p>
<p id="p0023" num="0023">According to an embodiment, the location of the first feature is not only determined in a first and second image but also in at least a third image. The location of the first feature in the third image is different to the location of the first feature in the first image and second image. A first perpendicular bisector can be determined between the first feature in the first image and the second image. A further perpendicular bisector can be determined between the first feature in the first image and the third image. A further intersection point can then be determined on the basis of the intersection of said first perpendicular bisector and said further perpendicular bisector.</p>
<p id="p0024" num="0024">Based on said first perpendicular bisector, a first angle estimation is calculated. The first angle estimation is the angle of rotation around said further intersection point, of the intersection of the first ray with the horizontal plane to the intersection of the second ray with the horizontal plane. The first angle estimation corresponds to the change in yaw angle of the trailer between the first image and the second image. So in other words, the point of rotation of the trailer is not determined by an intersection of first perpendicular bisector with reference axis but by intersecting at least two perpendicular bisectors obtained by tracking a feature over tree or more images.</p>
<p id="p0025" num="0025">According to a further aspect, a system for determining the yaw angle of a trailer with respect to the longitudinal axis of a towing vehicle is disclosed. The system comprises a camera for capturing images of the trailer and a processing entity for processing said captured images. The system is further configured to execute the steps of:
<ul id="ul0002" list-style="dash" compact="compact">
<li>capturing at least a first and a second image of the trailer using a camera, the orientation of the trailer with respect to the vehicle being different on the at least two images;<!-- EPO <DP n="8"> --></li>
<li>determining at least a first feature of the trailer which is visible on first and second image;</li>
<li>projecting the ray between the camera and determined first feature on the first image onto a horizontal plane thereby obtaining a first projected feature position and projecting the ray between the camera and determined first feature on the second image onto said horizontal plane thereby obtaining a second projected feature position;</li>
<li>establishing a first perpendicular bisector between the location of the first projected feature position and the location of the second projected feature position;</li>
<li>determining a first intersection point of first perpendicular bisector with a reference axis;</li>
<li>calculating the yaw angle based on a first angle estimation, said first angle estimation referring to the angle between a first line running from first projected feature position to said first intersection point and a second line running from second projected feature position to said first intersection point in said horizontal plane.</li>
</ul></p>
<p id="p0026" num="0026">Any upper-mentioned feature described as an embodiment of the method is also applicable as a system feature in a system according to the present disclosure.</p>
<p id="p0027" num="0027">According to yet another embodiment, a vehicle comprising a system according to anyone of upper-mentioned embodiments is disclosed.</p>
<p id="p0028" num="0028">The term "vehicle" as used in the present disclosure may refer to a car, truck, bus, train or any other crafts.<!-- EPO <DP n="9"> --></p>
<p id="p0029" num="0029">The term "yaw angle" as used in the present disclosure may refer to a pivot angle between the longitudinal axis of the vehicle and the longitudinal axis of the trailer.</p>
<p id="p0030" num="0030">The term "median" as used in the present disclosure may refer to a value separating a higher half from a lower half of a data sample or a probability distribution.</p>
<p id="p0031" num="0031">The term "essentially" or "approximately" as used in the invention means deviations from the exact value by +/- 10%, preferably by +/- 5% and/or deviations in the form of changes that are insignificant for the function and/or for the traffic laws.</p>
<p id="p0032" num="0032">Various aspects of the invention, including its particular features and advantages, will be readily understood from the following detailed description and the accompanying drawings, in which:
<ul id="ul0003" list-style="none">
<li><figref idref="f0001">Fig. 1</figref> shows an exemplary top view on a vehicle towing a trailer;</li>
<li><figref idref="f0001">Fig. 2</figref> schematically illustrates angle estimation based on a single feature captured by camera images in different pivot angles between the trailer and the towing vehicle;</li>
<li><figref idref="f0002">Fig. 3</figref> schematically illustrates angle estimations based on a first and a second feature captured by camera images in different pivot angles between the trailer and the towing vehicle;</li>
<li><figref idref="f0002">Fig. 4</figref> schematically illustrates the geometrical determination of point of rotation based on first and second perpendicular bisectors obtained from a single trailer feature included in three different images; and<!-- EPO <DP n="10"> --></li>
<li><figref idref="f0003">Fig. 5</figref> shows a schematic block diagram illustrating the steps of a method for determining the yaw angle of a trailer with respect to the longitudinal axis of a towing vehicle.</li>
</ul></p>
<p id="p0033" num="0033">The present invention will now be described more fully with reference to the accompanying drawings, in which example embodiments are shown. The embodiments in the figures may relate to preferred embodiments, while all elements and features described in connection with embodiments may be used, as far as appropriate, in combination with any other embodiment and feature as discussed herein, in particular related to any other embodiment discussed further above. However, this invention should not be construed as limited to the embodiments set forth herein. Throughout the following description similar reference numerals have been used to denote similar elements, parts, items or features, when applicable.</p>
<p id="p0034" num="0034">The features of the present invention disclosed in the specification, the claims, examples and/or the figures may both separately and in any combination thereof be material for realizing the invention in various forms thereof.</p>
<p id="p0035" num="0035"><figref idref="f0001">Fig. 1</figref> shows a top view illustration of a vehicle 1 towing a trailer 2. The vehicle 1 comprises a longitudinal axis LAV which runs through the centre of the vehicle 1. Similarly, the trailer 2 comprises a longitudinal axis LAT which runs through the centre of the trailer 2. The trailer 2 is coupled with the vehicle 1 by means of a trailer hitch comprising a towball 4.</p>
<p id="p0036" num="0036">In certain driving situations, the longitudinal axis LAV of the vehicle 1 and the longitudinal axis LAT of the trailer 2 may not be aligned in parallel or may not fall into one another but the axes may confine a yaw angle YA. In other words, the yaw angle YA defines the angular deviation of the<!-- EPO <DP n="11"> --> longitudinal axis LAT of the trailer 2 with respect to the longitudinal axis LAV of the vehicle 1. The yaw angle YA may be measured in a horizontal plane which includes the longitudinal axis LAT of the trailer 2 as well as the longitudinal axis LAV of the vehicle 1.</p>
<p id="p0037" num="0037">The knowledge of yaw angle YA is - inter alia - advantageous in trailer assistance systems, for example.</p>
<p id="p0038" num="0038">For determining the yaw angle YA, multiple images of at least a portion of the trailer 2 are captured by means of a camera 3. The camera 3 may be, for example, a rear view camera of the vehicle, which may also be used for capturing images of the surroundings of the car when driving backwards. One of the captured images may refer to a known angular arrangement of the trailer 2 with respect to the towing vehicle 1. Said image may be used as reference for calculating the yaw angle YA. In said known angular arrangement of the trailer 2 with respect to the towing vehicle 1, the yaw angle YA may be 0° or any other angle value.</p>
<p id="p0039" num="0039"><figref idref="f0001">Fig. 2</figref> shows a schematic diagram showing the angular relationship of a first feature F1 of the trailer 2 at different points of time at which the trailer 2 has a different yaw angle YA with respect to the towing vehicle 1.</p>
<p id="p0040" num="0040">The camera 3 may capture two or more images at different points of time at which the angular position of the trailer 2 with respect to the vehicle 1 is different. For example, an image series may be captured.</p>
<p id="p0041" num="0041">In the present example, the second image may show an orientation of the trailer with respect to the vehicle at a yaw angle YA = 0°.<!-- EPO <DP n="12"> --></p>
<p id="p0042" num="0042">Because of the angular movement of trailer 2 over time, a certain feature detected at the trailer may appear at different positions in the first and second image. In <figref idref="f0001">Fig. 2</figref>, the first feature is represented by a square.</p>
<p id="p0043" num="0043">The upper representation of first feature (associated with the solid optical ray R connecting the feature with the camera 3) is identified in a first image, the lower representation of first feature (associated with dashed optical ray R connecting the feature with the camera 3) is identified in a second image at a different point of time. For correlating the location of first feature in the respective image with the location of the vehicle 1, specifically a certain fix point of the vehicle 1, calibration information of the camera 3 may be used. Specifically, for determining the optical rays R connecting the first feature with the camera 3, calibration information of the camera 3 may be used to transform the location of said first feature in image coordinates into optical rays. In other words, for associating camera position and feature position, the location of feature on the image is correlated with a position of a fix point of the vehicle based on calibration information of the camera 3.</p>
<p id="p0044" num="0044">Features on the trailer are located and matched using feature detection and matching algorithm. For example, the Harris Corner Detector, Scale-Invariant Feature Transform (SIFT) algorithm, Speeded Up Robust Features (SURF) algorithm, Binary Robust Invariant Scalable Keypoints (BRISK) algorithm, Binary Robust Independent Elementary Features (BRIEF), Oriented FAST and rotated BRIEF (ORB) algorithm or another suitable feature detection and matching algorithm could be used.</p>
<p id="p0045" num="0045">The feature detection and matching algorithm may detect image features that are on the trailer or not on the trailer. To segment the trailer features from the non-trailer features a number of different methods could be used. For instance, when driving forwards in a straight line, trailer features can<!-- EPO <DP n="13"> --> be segmented from non-trailer features by looking for features that remain in the same position over time. Alternatively, the motion of background features can be modelled over time using the vehicle's known motion. This could be extracted from CAN data regarding speed and steering. Features which do not fit the Epipolar constraint of the Essential Matrix could then be considered as trailer features.</p>
<p id="p0046" num="0046">After feature identification in the respective images, the first feature of first and second image are projected in a common horizontal plane. More in detail, the ray between the camera 3 and determined first feature on the first image is projected onto a horizontal plane thereby obtaining a first projected feature position PFP1a. In addition, the ray between the camera 3 and determined first feature on the second image is projected onto the same horizontal plane thereby obtaining a second projected feature position PFP1b. It is worth mentioning that said projection is made in vertical direction thereby only changing the elevation angle of optical rays but not the azimuth angle.</p>
<p id="p0047" num="0047">After determining first and second projected feature positions PFP1a, PFP1b, a first perpendicular bisector B1 is established based on said first and second projected feature positions PFP1a, PFP1b. As shown in <figref idref="f0001">Fig. 2</figref>, the first perpendicular bisector B1 is a line being perpendicular to the line linking first and second projected feature positions PFP1a, PFP1b. In addition, the first perpendicular bisector B1 runs through the center of said linking line. Said first perpendicular bisector B1 crosses a reference axis, which is in the present embodiment the longitudinal axis of the vehicle LAV. Said intersection of first perpendicular bisector B1 and reference axis provides the point of rotation, around which the trailer is rotated. More in detail, said intersection provides the position of the towball 4.<!-- EPO <DP n="14"> --></p>
<p id="p0048" num="0048">Based on said first perpendicular bisector B1, a first angle estimation α1 is calculated. Said first angle estimation α1 refers to an angle provided between a first line L1 linking first projected feature position PFP1a and the intersection of first perpendicular bisector B1 and reference axis and a second line L2 linking second projected feature position PFP1b and the intersection of first perpendicular bisector B1 and reference axis. The intersection may be indicative for the position of towball 4. More in detail, the first angle estimation α1 characterizes the pivot angle of the trailer 2 in a horizontal plane between the location of the first feature in the first image projected on the horizontal plane and the location of the first feature in the second image projected on said horizontal plane around said first intersection point IP1 (which is the position of towball 4).</p>
<p id="p0049" num="0049">The first angle estimation α1 represents the yaw angle YA of the trailer 2 around its actual point of rotation.</p>
<p id="p0050" num="0050"><figref idref="f0002">Fig. 3</figref> illustrates an embodiment similar to <figref idref="f0001">Fig. 2</figref> which uses a first and a second feature F1, F2 of the trailer 2 captured at different points of time (at which the trailer 2 has a different yaw angle YA with respect to the towing vehicle 1) for establishing yaw angle YA.</p>
<p id="p0051" num="0051">On the images captured by the camera 3, multiple different features may be identifiable. As shown in <figref idref="f0002">Fig. 3</figref>, said features are identified at different angular positions with respect to a fix point of the vehicle 1. The first feature is illustrated by a square, the second feature is illustrated by a triangle. Said fix point may be the location of the camera 3 or may be the location of the towball 4.</p>
<p id="p0052" num="0052">In <figref idref="f0002">Fig. 3</figref>, the upper pair of first and second feature (indicated by PFP1a, PFP2a and associated with the solid optical rays connecting the features with the camera 3) are identified in a first image, the lower pair of first and<!-- EPO <DP n="15"> --> second feature F1, F2 (indicated by PFP1b, PFP2b and associated with dashed optical rays connecting the features with the camera 3) are identified in a second image at a different point of time.</p>
<p id="p0053" num="0053">The determination of yaw angle YA is performed analogously to the embodiment of <figref idref="f0001">Fig. 2</figref>. The main difference is that two angle estimations α1, α2 are established and the yaw angle of the trailer is developed based on said two angle estimations α1, α2. More in detail, establishing first perpendicular bisector B1 and obtaining first angle estimation α1 is performed like described above.</p>
<p id="p0054" num="0054">In addition, second angle estimation α2 is obtained by establishing third projected feature position PFP2a and fourth projected feature position PFP2b, establishing a second perpendicular bisector B2 in order to obtain a second intersection point IP2 and connecting the third projected feature position PFP2a and the fourth projected feature position PFP2b with said second intersection point IP2. Said third projected feature position PFP2a is obtained by projecting second feature in the first image onto said horizontal plane and fourth projected feature position PFP2b is obtained by projecting second feature in the second image onto said horizontal plane. The second intersection point IP2 may be the point in which the second perpendicular bisector B2 crosses the reference axis, in the present embodiment the longitudinal axis of the vehicle LAV. The second angle estimation α2 is the angle between a first line linking third projected feature position PFP2a and intersection point IP2 and a second line linking fourth projected feature position PFP2b and intersection point IP2.</p>
<p id="p0055" num="0055">In the present embodiment, the reference axis is the longitudinal axis LAV of the towing vehicle 1, because the camera 3 as well as the towball 4 is located on said longitudinal axis LAV of the vehicle 1. In other embodiments, if the camera 3 or the towball 4 has a lateral offset to the<!-- EPO <DP n="16"> --> longitudinal axis LAV of the vehicle 1 or the lateral offset of the camera 3 and the towball 4 with respect to the longitudinal axis LAV of the vehicle 1 is different, the reference axis may be formed by a straight line linking the camera 3 and the towball 4.</p>
<p id="p0056" num="0056">Under ideal conditions, the first angle estimation α1 and the second angle estimation α2 should be equal (α1 = α2) and should represent the yaw angle YA. However, due to noise and mismatches, the values of first and second angle estimation α1, α2 can be different.</p>
<p id="p0057" num="0057">It is worth mentioning that more than two features of the trailer 2 could determined and tracked over multiple images. In addition, preferably, more than two images are captured at different points of time in order to enhance the result of yaw angle estimation. Thereby, more than two angle estimations α1, α2 can be established for increasing the quality of yaw angle determination.</p>
<p id="p0058" num="0058">For determining the yaw angle YA based on first and second angle estimations α1, α2 having different values, a statistical measure may be used. According to a first embodiment, the median of two or more angle estimations α1, α2 may be used to determine the yaw angle YA. According to other embodiments, a statistical method may be used to determine the yaw angle YA based on of two or more angle estimations α1, α2. The statistical method may be, for example, RANSAC-algorithm (RANSAC: random sample consensus) or least squares algorithm.</p>
<p id="p0059" num="0059">It appeared that not all features visible on the captured images are equally suitable for calculating yaw angle YA. In order to reduce computational complexity and robustness, those features are selected and further used for determining yaw angle YA, which provide pivot angles quite close to actual yaw angle. For feature selection, only those features may be<!-- EPO <DP n="17"> --> tracked in future images which provided pivot angles α1, α2 in a certain window around the actual yaw angle. For example, the window may be defined by an upper and a lower boundary, said upper and lower boundary defining an angular window around said actual yaw angle. For example, the window may span over a distance of 2° to 10°, more particular between 3° and 5°. All features which led to pivot angles within said window in the last two or more yaw angle determination steps are further tracked in the next captured images.</p>
<p id="p0060" num="0060">In case of tracking a particular trailer feature for multiple images, due to the movement of the trailer 2, the samples of said feature may be arranged on a circle segment. The centre of said circle segment represents the location of towball 4. Therefore, by tracking a particular trailer feature over multiple images, the location of towball 4 can be derived.</p>
<p id="p0061" num="0061">In order to mitigate noise, the determination of the location of towball 4 may consider multiple trailer features tracked for a period of time over multiple images. Each trailer feature may correspond to a circle segment with certain centre estimation. By applying a statistical method on said multiple centre estimations, the actual location of towball 4 can be developed. The statistical method may be, for example, RANSAC-algorithm or least squares algorithm.</p>
<p id="p0062" num="0062"><figref idref="f0002">Fig. 4</figref> shows a further embodiment of geometrically determining the point of rotation without using upper-mentioned reference axis.</p>
<p id="p0063" num="0063">The point of rotation is established by developing at least two perpendicular bisectors B1, B2 based on three images which show a certain feature in different angular positions with respect to the towing vehicle 1. In <figref idref="f0002">Fig. 4</figref>, first projected feature position PFP1a refers to a<!-- EPO <DP n="18"> --> feature included in first image and projected in a common horizontal plane as mentioned before. Similarly, the second projected feature position PFP1b refers to a feature included in a second image and third projected feature position PFP1c refers to a feature included in a third image.</p>
<p id="p0064" num="0064">The first perpendicular bisector B1 refers to a line linking first and second projected feature positions PFP1a, PFP1b. The second perpendicular bisector B2 refer to a line linking first and third projected feature positions PFP1a, PFP1c. The intersection of first and second perpendicular bisectors B1, B2 defines an intersecting point IP which is indicative for the point of rotation of the trailer 2, i.e. indicative for the position of the towball 4.</p>
<p id="p0065" num="0065">Said intersecting point IP can be used for determining the yaw angle YA of the trailer as shown in the embodiments of <figref idref="f0001">Fig. 2</figref> and <figref idref="f0002">3</figref>.</p>
<p id="p0066" num="0066"><figref idref="f0003">Fig. 5</figref> shows a block diagram illustrating the method steps of a method for determining the yaw angle YA of a trailer 2 with respect to the longitudinal axis LAV of a towing vehicle 1.</p>
<p id="p0067" num="0067">As a first step, a first and a second image of the trailer is captured (S10).</p>
<p id="p0068" num="0068">After image capturing, at least one feature of the trailer visible on the first and the second image is determined (S11).</p>
<p id="p0069" num="0069">After feature determination, a first projected feature position and a second projected feature position are established by feature projection (S12).</p>
<p id="p0070" num="0070">After feature projection, a first perpendicular bisector is established (S13).<!-- EPO <DP n="19"> --></p>
<p id="p0071" num="0071">After establishing first perpendicular bisector, a first intersection point of first perpendicular bisector with a reference axis or a further perpendicular bisector is developed (S14).</p>
<p id="p0072" num="0072">Finally, the yaw angle is calculated based on first angle estimation (S15).</p>
<p id="p0073" num="0073">It should be noted that the description and drawings merely illustrate the principles of the proposed invention. Those skilled in the art will be able to implement various arrangements that, although not explicitly described or shown herein, embody the principles of the invention.<!-- EPO <DP n="20"> --></p>
<heading id="h0001"><b>List of reference numerals</b></heading>
<p id="p0074" num="0074">
<dl id="dl0001">
<dt>1</dt><dd>vehicle</dd>
<dt>2</dt><dd>trailer</dd>
<dt>3</dt><dd>camera</dd>
<dt>4</dt><dd>towball</dd>
</dl>
<dl id="dl0002" compact="compact">
<dt><i>α</i>1</dt><dd>first angle estimation</dd>
<dt><i>α</i>2</dt><dd>second angle estimation</dd>
<dt>B1</dt><dd>first perpendicular bisector</dd>
<dt>B2</dt><dd>second perpendicular bisector</dd>
<dt>PFP1a</dt><dd>projected feature position of first feature in first image</dd>
<dt>PFP1b</dt><dd>projected feature position of first feature in second image</dd>
<dt>PFP1c</dt><dd>projected feature position of first feature in third image</dd>
<dt>PFP2a</dt><dd>projected feature position of second feature in first image</dd>
<dt>PFP2b</dt><dd>projected feature position of second feature in second image</dd>
<dt>IP</dt><dd>intersecting point</dd>
<dt>IP1</dt><dd>first intersection point</dd>
<dt>IP2</dt><dd>second intersection point</dd>
<dt>LAT</dt><dd>longitudinal axis of trailer</dd>
<dt>LAV</dt><dd>longitudinal axis of vehicle</dd>
<dt>R</dt><dd>optical ray</dd>
<dt>YA</dt><dd>yaw angle</dd>
</dl></p>
</description>
<claims id="claims01" lang="en"><!-- EPO <DP n="21"> -->
<claim id="c-en-0001" num="0001">
<claim-text>Method for determining the yaw angle (YA) of a trailer (2) with respect to the longitudinal axis (LAV) of a towing vehicle (1), the method comprising the steps of:
<claim-text>- capturing at least a first and a second image of the trailer (2) using a camera (3), the orientation of the trailer (2) with respect to the vehicle (1) being different on the at least two images (S10);</claim-text>
<claim-text>- determining at least a first feature of the trailer (2) which is visible on first and second image (S11);</claim-text>
<claim-text>- projecting the ray between the camera (3) and determined first feature on the first image onto a horizontal plane thereby obtaining a first projected feature position (PFP1a) and projecting the ray between the camera (3) and determined first feature on the second image onto said horizontal plane thereby obtaining a second projected feature position (PFP1b) (S12);</claim-text>
<claim-text>- establishing a first perpendicular bisector (B1) between the location of the first projected feature position (PFP1a) and the location of the second projected feature position (PFP1b) (S13);</claim-text>
<claim-text>- determining a first intersection point (IP1) of first perpendicular bisector (B1) with a reference axis or a further perpendicular bisector (S14);</claim-text>
<claim-text>- calculating the yaw angle (YA) based on a first angle estimation (α1), said first angle estimation (α1) referring to the angle between a first line running from first projected feature position (PFP1a) to said first intersection point (IP1) and a second line running from second projected feature position (PFP1b) to said first intersection point (IP1) in said horizontal plane (S15).</claim-text><!-- EPO <DP n="22"> --></claim-text></claim>
<claim id="c-en-0002" num="0002">
<claim-text>Method according to claim 1, wherein on first or second image, the yaw angle (YA) of the trailer (2) with respect to the vehicle (1) is zero or any known yaw angle (YA) which can be used as reference angle.</claim-text></claim>
<claim id="c-en-0003" num="0003">
<claim-text>Method according to claim 1 or 2, further comprising the steps of:
<claim-text>- determining a second feature of the trailer (2) which is visible on first and second image, wherein said second feature is arranged at a different position of the trailer (2) than the first feature;</claim-text>
<claim-text>- projecting the ray between the camera (3) and determined second feature on the first image onto said horizontal plane thereby obtaining a third projected feature position (PFP2a) and projecting the ray between the camera (3) and determined second feature on the second image onto said horizontal plane thereby obtaining a fourth projected feature position (PFP2b);</claim-text>
<claim-text>- establishing a second perpendicular bisector (B2) between the location of the third projected feature position (PFP2a) and the location of the fourth projected feature position (PFP2b);</claim-text>
<claim-text>- determining a second intersection point (IP2) of second perpendicular bisector (B2) with said reference axis;</claim-text>
<claim-text>- calculating a second angle estimation (α2), the second angle estimation (α2) referring to the angle between a first line running from third projected feature position (PFP2a) to said second intersection point (IP2) and a second line running from fourth projected feature position (PFP2b) to said second intersection point (IP2) in said horizontal plane; and</claim-text>
<claim-text>- calculating the yaw angle (YA) based on said first and second angle estimations (α1, α2).</claim-text></claim-text></claim>
<claim id="c-en-0004" num="0004">
<claim-text>Method according to claim 3, wherein in addition to said first and second feature, at least one further feature of the trailer (2) is used for calculating the yaw angle (YA).<!-- EPO <DP n="23"> --></claim-text></claim>
<claim id="c-en-0005" num="0005">
<claim-text>Method according to claims 3 or 4, wherein the yaw angle (YA) is calculated by establishing the median value based on the at least two angle estimations.</claim-text></claim>
<claim id="c-en-0006" num="0006">
<claim-text>Method according to anyone of preceding claims 3 to 5, wherein the yaw angle (YA) is calculated by establishing an average value of the at least two angle estimations or by using a statistical approach applied to said angle estimations.</claim-text></claim>
<claim id="c-en-0007" num="0007">
<claim-text>Method according to anyone of preceding claims, further comprising the step of determining an angle window, said angle window comprising an upper and a lower bound around yaw angle (YA), determining a set of features which lead to angle estimations within said angle window and using said determined set of features for future yaw angle (YA) calculations.</claim-text></claim>
<claim id="c-en-0008" num="0008">
<claim-text>Method according to anyone of the preceding claims, wherein camera calibration information is used for converting the position of said first and/or second feature from local domain of the image into local domain of the vehicle (1).</claim-text></claim>
<claim id="c-en-0009" num="0009">
<claim-text>Method according to anyone of the preceding claims, wherein the reference axis is the longitudinal axis (LAV) of the towing vehicle (1) if the camera (3) and the towball (4) of the vehicle (1) are arranged in a vertically oriented plane which comprises said longitudinal axis (LAV) of the towing vehicle (1).</claim-text></claim>
<claim id="c-en-0010" num="0010">
<claim-text>Method according to anyone of the preceding claims, wherein the reference axis is a straight line running between the camera (3) and the towball (4) if the camera (3) and/or the towball (4) have a lateral<!-- EPO <DP n="24"> --> offset with respect to the longitudinal axis (LAV) of the towing vehicle (1).</claim-text></claim>
<claim id="c-en-0011" num="0011">
<claim-text>Method according to anyone of the preceding claims, wherein the camera (3) is the rear view camera of the vehicle (1).</claim-text></claim>
<claim id="c-en-0012" num="0012">
<claim-text>System for determining the yaw angle (YA) of a trailer (2) with respect to the longitudinal axis (LAV) of a towing vehicle (1), the system comprising a camera (3) for capturing images of the trailer (2) and a processing entity for processing said captured images, the system further being configured to execute the steps of:
<claim-text>- capturing at least a first and a second image of the trailer (2) using a camera (3), the orientation of the trailer (2) with respect to the vehicle (1) being different on the at least two images (S10);</claim-text>
<claim-text>- determining at least a first feature of the trailer (2) which is visible on first and second image (S11);</claim-text>
<claim-text>- projecting the ray between the camera (3) and determined first feature on the first image onto a horizontal plane thereby obtaining a first projected feature position (PFP1a) and projecting the ray between the camera (3) and determined first feature on the second image onto said horizontal plane thereby obtaining a second projected feature position (PFP1b) (S12);</claim-text>
<claim-text>- establishing a first perpendicular bisector (B1) between the location of the first projected feature position (PFP1a) and the location of the second projected feature position (PFP1b) (S13);</claim-text>
<claim-text>- determining a first intersection point (IP1) of first perpendicular bisector (B1) with a reference axis or a further perpendicular bisector (S14);</claim-text>
<claim-text>- calculating the yaw angle (YA) based on a first angle estimation (α1), said first angle estimation (α1) referring to the angle between a first line running from first projected feature position (PFP1a) to<!-- EPO <DP n="25"> --> said first intersection point (IP1) and a second line running from second projected feature position (PFP1b) to said first intersection point (IP1) in said horizontal plane (S15).</claim-text></claim-text></claim>
<claim id="c-en-0013" num="0013">
<claim-text>Vehicle comprising a system according to claim 12.</claim-text></claim>
</claims>
<drawings id="draw" lang="en"><!-- EPO <DP n="26"> -->
<figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="160" he="230" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> -->
<figure id="f0002" num="3,4"><img id="if0002" file="imgf0002.tif" wi="145" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="28"> -->
<figure id="f0003" num="5"><img id="if0003" file="imgf0003.tif" wi="131" he="167" img-content="drawing" img-format="tif"/></figure>
</drawings>
<search-report-data id="srep" lang="en" srep-office="EP" date-produced=""><doc-page id="srep0001" file="srep0001.tif" wi="157" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="155" he="233" type="tif"/></search-report-data><search-report-data date-produced="20200730" id="srepxml" lang="en" srep-office="EP" srep-type="ep-sr" status="n"><!--
 The search report data in XML is provided for the users' convenience only. It might differ from the search report of the PDF document, which contains the officially published data. The EPO disclaims any liability for incorrect or incomplete data in the XML for search reports.
 -->

<srep-info><file-reference-id>2020P01192EP (NU)</file-reference-id><application-reference><document-id><country>EP</country><doc-number>20167188.0</doc-number></document-id></application-reference><applicant-name><name>Continental Automotive GmbH</name></applicant-name><srep-established srep-established="yes"/><srep-invention-title title-approval="yes"/><srep-abstract abs-approval="yes"/><srep-figure-to-publish figinfo="by-applicant"><figure-to-publish><fig-number>5</fig-number></figure-to-publish></srep-figure-to-publish><srep-info-admin><srep-office><addressbook><text>MN</text></addressbook></srep-office><date-search-report-mailed><date>20200807</date></date-search-report-mailed></srep-info-admin></srep-info><srep-for-pub><srep-fields-searched><minimum-documentation><classifications-ipcr><classification-ipcr><text>G06T</text></classification-ipcr><classification-ipcr><text>B60D</text></classification-ipcr></classifications-ipcr></minimum-documentation></srep-fields-searched><srep-citations><citation id="sr-cit0001"><patcit dnum="EP3537382A1" id="sr-pcit0001" url="http://v3.espacenet.com/textdoc?DB=EPODOC&amp;IDX=EP3537382&amp;CY=ep"><document-id><country>EP</country><doc-number>3537382</doc-number><kind>A1</kind><name>CONTINENTAL AUTOMOTIVE GMBH [DE]</name><date>20190911</date></document-id></patcit><category>Y</category><rel-claims>1,2,8-13</rel-claims><category>A</category><rel-claims>3-7</rel-claims><rel-passage><passage>* paragraphs [0024],  [0027],  [0072],  [0075]; figure 3 *</passage></rel-passage></citation><citation id="sr-cit0002"><patcit dnum="DE102016117284A1" id="sr-pcit0002" url="http://v3.espacenet.com/textdoc?DB=EPODOC&amp;IDX=DE102016117284&amp;CY=ep"><document-id><country>DE</country><doc-number>102016117284</doc-number><kind>A1</kind><name>CONNAUGHT ELECTRONICS LTD [IE]</name><date>20180315</date></document-id></patcit><category>Y</category><rel-claims>1,2,8-13</rel-claims><category>A</category><rel-claims>3-7</rel-claims><rel-passage><passage>* paragraphs [0041],  [0042]; figures 1,2 *</passage></rel-passage></citation><citation id="sr-cit0003"><patcit dnum="US2018276839A1" id="sr-pcit0003" url="http://v3.espacenet.com/textdoc?DB=EPODOC&amp;IDX=US2018276839&amp;CY=ep"><document-id><country>US</country><doc-number>2018276839</doc-number><kind>A1</kind><name>DIESSNER HORST D [US] ET AL</name><date>20180927</date></document-id></patcit><category>A</category><rel-claims>1-13</rel-claims><rel-passage><passage>* the whole document *</passage></rel-passage></citation><citation id="sr-cit0004"><patcit dnum="US2018251154A1" id="sr-pcit0004" url="http://v3.espacenet.com/textdoc?DB=EPODOC&amp;IDX=US2018251154&amp;CY=ep"><document-id><country>US</country><doc-number>2018251154</doc-number><kind>A1</kind><name>LU YUESHENG [US] ET AL</name><date>20180906</date></document-id></patcit><category>A</category><rel-claims>1-13</rel-claims><rel-passage><passage>* the whole document *</passage></rel-passage></citation></srep-citations><srep-admin><examiners><primary-examiner><name>Tillier, Christophe</name></primary-examiner></examiners><srep-office><addressbook><text>Munich</text></addressbook></srep-office><date-search-completed><date>20200730</date></date-search-completed></srep-admin><!--							The annex lists the patent family members relating to the patent documents cited in the above mentioned European search report.							The members are as contained in the European Patent Office EDP file on							The European Patent Office is in no way liable for these particulars which are merely given for the purpose of information.							For more details about this annex : see Official Journal of the European Patent Office, No 12/82						--><srep-patent-family><patent-family><priority-application><document-id><country>EP</country><doc-number>3537382</doc-number><kind>A1</kind><date>20190911</date></document-id></priority-application><family-member><document-id><country>EP</country><doc-number>3537382</doc-number><kind>A1</kind><date>20190911</date></document-id></family-member><family-member><document-id><country>US</country><doc-number>2020402257</doc-number><kind>A1</kind><date>20201224</date></document-id></family-member><family-member><document-id><country>WO</country><doc-number>2019170469</doc-number><kind>A1</kind><date>20190912</date></document-id></family-member></patent-family><patent-family><priority-application><document-id><country>DE</country><doc-number>102016117284</doc-number><kind>A1</kind><date>20180315</date></document-id></priority-application><text>NONE</text></patent-family><patent-family><priority-application><document-id><country>US</country><doc-number>2018276839</doc-number><kind>A1</kind><date>20180927</date></document-id></priority-application><family-member><document-id><country>US</country><doc-number>2018276839</doc-number><kind>A1</kind><date>20180927</date></document-id></family-member><family-member><document-id><country>US</country><doc-number>2020175707</doc-number><kind>A1</kind><date>20200604</date></document-id></family-member><family-member><document-id><country>US</country><doc-number>2021201523</doc-number><kind>A1</kind><date>20210701</date></document-id></family-member></patent-family><patent-family><priority-application><document-id><country>US</country><doc-number>2018251154</doc-number><kind>A1</kind><date>20180906</date></document-id></priority-application><family-member><document-id><country>US</country><doc-number>2014200759</doc-number><kind>A1</kind><date>20140717</date></document-id></family-member><family-member><document-id><country>US</country><doc-number>2015321697</doc-number><kind>A1</kind><date>20151112</date></document-id></family-member><family-member><document-id><country>US</country><doc-number>2018251154</doc-number><kind>A1</kind><date>20180906</date></document-id></family-member><family-member><document-id><country>US</country><doc-number>2021114657</doc-number><kind>A1</kind><date>20210422</date></document-id></family-member><family-member><document-id><country>WO</country><doc-number>2012103193</doc-number><kind>A1</kind><date>20120802</date></document-id></family-member></patent-family></srep-patent-family></srep-for-pub></search-report-data>
</ep-patent-document>
