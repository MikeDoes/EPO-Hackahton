<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE ep-patent-document PUBLIC "-//EPO//EP PATENT DOCUMENT 1.5.1//EN" "ep-patent-document-v1-5-1.dtd">
<!-- This XML data has been generated under the supervision of the European Patent Office -->
<ep-patent-document id="EP19211911B1" file="EP19211911NWB1.xml" lang="en" country="EP" doc-number="3633917" kind="B1" date-publ="20211006" status="n" dtd-version="ep-patent-document-v1-5-1">
<SDOBI lang="en"><B000><eptags><B001EP>ATBECHDEDKESFRGBGRITLILUNLSEMCPTIESILTLVFIROMKCYALTRBGCZEEHUPLSK..HRIS..MTNORS..SM..................</B001EP><B005EP>J</B005EP><B007EP>BDM Ver 2.0.12 (4th of August) -  2100000/0</B007EP></eptags></B000><B100><B110>3633917</B110><B120><B121>EUROPEAN PATENT SPECIFICATION</B121></B120><B130>B1</B130><B140><date>20211006</date></B140><B190>EP</B190></B100><B200><B210>19211911.3</B210><B220><date>20130510</date></B220><B240><B241><date>20200914</date></B241></B240><B250>en</B250><B251EP>en</B251EP><B260>en</B260></B200><B300><B310>201213469618</B310><B320><date>20120511</date></B320><B330><ctry>US</ctry></B330></B300><B400><B405><date>20211006</date><bnum>202140</bnum></B405><B430><date>20200408</date><bnum>202015</bnum></B430><B450><date>20211006</date><bnum>202140</bnum></B450><B452EP><date>20210713</date></B452EP></B400><B500><B510EP><classification-ipcr sequence="1"><text>H04W  12/08        20210101AFI20210629BHEP        </text></classification-ipcr><classification-ipcr sequence="2"><text>H04L   9/32        20060101ALI20210629BHEP        </text></classification-ipcr><classification-ipcr sequence="3"><text>H04W  12/041       20210101ALI20210629BHEP        </text></classification-ipcr><classification-ipcr sequence="4"><text>H04W  12/0431      20210101ALI20210629BHEP        </text></classification-ipcr><classification-ipcr sequence="5"><text>H04W  12/062       20210101ALI20210629BHEP        </text></classification-ipcr><classification-ipcr sequence="6"><text>H04W  12/069       20210101ALI20210629BHEP        </text></classification-ipcr><classification-ipcr sequence="7"><text>H04W  36/14        20090101ALI20210629BHEP        </text></classification-ipcr><classification-ipcr sequence="8"><text>H04W  36/00        20090101ALI20210629BHEP        </text></classification-ipcr><classification-ipcr sequence="9"><text>H04W  84/12        20090101ALN20210629BHEP        </text></classification-ipcr></B510EP><B520EP><classifications-cpc><classification-cpc sequence="1"><text>H04W  36/0072      20130101 FI20160317BHEP        </text></classification-cpc><classification-cpc sequence="2"><text>H04W  12/041       20210101 LI20210101RHEP        </text></classification-cpc><classification-cpc sequence="3"><text>H04W  12/069       20210101 LI20210101RHEP        </text></classification-cpc><classification-cpc sequence="4"><text>H04W  12/0431      20210101 LI20210101RHEP        </text></classification-cpc><classification-cpc sequence="5"><text>H04W  36/14        20130101 LI20160317BHEP        </text></classification-cpc><classification-cpc sequence="6"><text>H04W  36/0077      20130101 LI20160317BHEP        </text></classification-cpc><classification-cpc sequence="7"><text>H04W  84/12        20130101 LA20151211BHEP        </text></classification-cpc><classification-cpc sequence="8"><text>H04W  12/08        20130101 LI20200218RHEP        </text></classification-cpc><classification-cpc sequence="9"><text>H04W  12/062       20210101 LI20210101RHEP        </text></classification-cpc></classifications-cpc></B520EP><B540><B541>de</B541><B542>ERWEITERTE SERVICE-SET-ÜBERGÄNGE IN DRAHTLOSEN NETZWERKEN</B542><B541>en</B541><B542>EXTENDED SERVICE SET TRANSITIONS IN WIRELESS NETWORKS</B542><B541>fr</B541><B542>TRANSITIONS D'UN ENSEMBLE DE SERVICES ÉTENDU DANS DES RÉSEAUX SANS FIL</B542></B540><B560><B561><text>EP-A1- 2 445 242</text></B561><B561><text>WO-A1-03/092218</text></B561><B561><text>US-A1- 2010 271 978</text></B561><B561><text>US-A1- 2011 047 382</text></B561><B561><text>US-A1- 2012 116 886</text></B561><B562><text>Konstantinos Georgantas: "Fast Initial Authentication, a New Mechanism to Enable Fast WLAN Mobility", , 26 September 2011 (2011-09-26), XP055663146, Retrieved from the Internet: URL:https://www.cs.helsinki.fi/u/gurtov/pa pers/Georgantas-thesis-for-archive.pdf [retrieved on 2020-01-29]</text></B562></B560></B500><B600><B620><parent><pdoc><dnum><anum>13788377.3</anum><pnum>2850775</pnum></dnum><date>20130510</date></pdoc></parent></B620></B600><B700><B720><B721><snm>McCANN, Stephen</snm><adr><str>c/o 2200 University Avenue East</str><city>Waterloo, Ontario N2K 0A7</city><ctry>CA</ctry></adr></B721><B721><snm>MONTEMURRO, Michael Peter</snm><adr><str>c/o 2200 University Avenue East</str><city>Waterloo, Ontario N2K 0A7</city><ctry>CA</ctry></adr></B721></B720><B730><B731><snm>BlackBerry Limited</snm><iid>101727902</iid><irf>44248-EP-ETD</irf><adr><str>2200 University Avenue East</str><city>Waterloo, Ontario N2K 0A7</city><ctry>CA</ctry></adr></B731></B730><B740><B741><snm>Hanna Moore + Curley</snm><iid>101668780</iid><adr><str>Garryard House 
25-26 Earlsfort Terrace</str><city>Dublin 2, D02 PX51</city><ctry>IE</ctry></adr></B741></B740></B700><B800><B840><ctry>AL</ctry><ctry>AT</ctry><ctry>BE</ctry><ctry>BG</ctry><ctry>CH</ctry><ctry>CY</ctry><ctry>CZ</ctry><ctry>DE</ctry><ctry>DK</ctry><ctry>EE</ctry><ctry>ES</ctry><ctry>FI</ctry><ctry>FR</ctry><ctry>GB</ctry><ctry>GR</ctry><ctry>HR</ctry><ctry>HU</ctry><ctry>IE</ctry><ctry>IS</ctry><ctry>IT</ctry><ctry>LI</ctry><ctry>LT</ctry><ctry>LU</ctry><ctry>LV</ctry><ctry>MC</ctry><ctry>MK</ctry><ctry>MT</ctry><ctry>NL</ctry><ctry>NO</ctry><ctry>PL</ctry><ctry>PT</ctry><ctry>RO</ctry><ctry>RS</ctry><ctry>SE</ctry><ctry>SI</ctry><ctry>SK</ctry><ctry>SM</ctry><ctry>TR</ctry></B840></B800></SDOBI>
<description id="desc" lang="en"><!-- EPO <DP n="1"> -->
<heading id="h0001"><b>BACKGROUND</b></heading>
<p id="p0001" num="0001">Wireless network deployments, such as wireless local area networks ("WLANs"), allow mobile devices to access network and Internet services when within proximity of wireless communication signals of those wireless networks. Through network discovery communications with the WLAN, a mobile device or station ("STA") may obtain network information about an access point ("AP") or access network. Access Network Query Protocol ("ANQP") may allow a STA to request additional network information prior to establishing network connectivity. Such network information may include access to particular subscription service provider ("SSP") networks ("SSPN"), roaming agreements to allow connections from wireless clients associated with different SSPs, authentication capabilities to enable secure communications, support for emergency services or support for particular types of multi-media access (e.g., audio and/or video streaming, downloading, etc.). However, there is no expedited process for a mobile device to transition between networks. A mobile device may need to disconnect or disassociate with one network and authenticate/associate with a different network for the transition.</p>
<p id="p0002" num="0002">"Fast Initial Authentication, a new Mechanism to enable Fast WLAN Mobility" discloses an architecture for seamless handovers within a single Extended Service Set, ESS, network.</p>
<p id="p0003" num="0003"><patcit id="pcit0001" dnum="EP2445242A1"><text>EP 2 445242 A1</text></patcit> discloses an authentication method which includes redirecting a HTTP request message sent by a WLAN terminal to an address of a login webpage of a WLAN network, and returning the redirected HTTP request message to the WLAN terminal.</p>
<heading id="h0002"><b>SUMMARY</b></heading>
<p id="p0004" num="0004">The invention is defined in the appended claims.<!-- EPO <DP n="2"> --></p>
<heading id="h0003">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p0005" num="0005">
<ul id="ul0001" list-style="none" compact="compact">
<li><figref idref="f0001">Figure 1</figref> illustrates a communication network;</li>
<li><figref idref="f0002">Figure 2</figref> illustrates a communication layer architecture;</li>
<li><figref idref="f0003">Figure 3</figref> illustrates an alternative communication network;</li>
<li><figref idref="f0004">Figure 4</figref> illustrates another alternative communication network;</li>
<li><figref idref="f0005">Figure 5</figref> illustrates a mobile device ("STA");</li>
<li><figref idref="f0006">Figure 6</figref> illustrates an access point;</li>
<li><figref idref="f0007">Figure 7</figref> illustrates key authentication;</li>
<li><figref idref="f0008">Figure 8</figref> illustrates device authentication;</li>
<li><figref idref="f0008">Figure 9</figref> illustrates key generation;</li>
<li><figref idref="f0009">Figure 10</figref> illustrates a process for generating and utilizing a key; and</li>
<li><figref idref="f0009">Figure 11</figref> illustrates another process for generating and utilizing a key for transitioning between ESS networks.</li>
</ul></p>
<heading id="h0004">DETAILED DESCRIPTION</heading>
<p id="p0006" num="0006">The disclosed systems and methods allow mobile devices to transition between networks. The transition may occur seamlessly, such that a consumer never loses the network connection despite transitioning between networks. The communication for enabling a transition may comprise discovery information about a network prior to association with that network. This pre-association communication may be retrieved through a wireless protocol, such as Access Network Query Protocol ("ANQP"), which allows a mobile device to retrieve information about a network prior to associating with that network. Communications prior to network association may be referred to discovery communications (i.e., communications that<!-- EPO <DP n="3"> --> occur while a mobile device is in a pre-associated state). ANQP may allow a device to retrieve additional network information that can be used for transitioning between networks.</p>
<p id="p0007" num="0007">The seamless transition may be enabled through the creation and utilization of a central key holder authority that works across IEEE 802.11 Extended Service Sets ("ESSs"). The identity of the central key holder (i.e. key holder identity) may be advertised to an IEEE 802.11 mobile device in a pre-associated state. In other words, the key holder identity may be communicated with discovery communications, such as through ANQP messaging. The mobile device can use the key discovery communication along with a key generation method to assist the authentication and/or association with a network and whilst transitioning from one ESS to another.</p>
<p id="p0008" num="0008">There may be a common root key ("K") across ESSs. At each new access point ("AP") that the mobile device encounters, ESS and key holder identities may be discovered through discovery communications, including those available in neighboring APs. This information is available to the mobile device in a pre-associated state. A new IEEE 802.11 network layer key hierarchy that produces the common root key K across ESSs may allow fast authenticated ESS transitions for a mobile device.</p>
<p id="p0009" num="0009">The transitioning between networks and ESSs may be especially needed in an environment where mobile users are frequently entering and leaving the coverage area of an ESS. Every time the mobile device enters an ESS, the mobile device may do an initial link setup to establish wireless local area network ("WLAN") connectivity. With the current IEEE 802.11 specification, initial authentication for a high number of users entering an ESS, may result in signaling overload in an authentication server. This may result in the local hotspot (e.g. an environment that is within communication range of WLAN signals) becoming exhausted of<!-- EPO <DP n="4"> --> memory. For example, IEEE 802.11r provides a solution to allow a mobile device to transition between Basic Service Sets ("BSSs"), within the same mobility domain that restricts them to a single network (e.g. ESS). This may be equivalent to a mobile device moving from one WLAN to another, while remaining with the same network. The architecture of this IEEE 802.11 solution does not allow it to be scaled from local network (e.g. BSS) transition to network (e.g. ESS) transition, as the identity of the BSS is delivered in a different manner from that of the ESS. In addition, IEEE 802.11r assumes that security keys have a security association within a single ESS, to enable local network (e.g. BSS) transition.</p>
<p id="p0010" num="0010">A basic service set ("BSS") may be a set of stations ("STAs") that can communicate with each other. Each access point and its wireless devices may be known as a BSS. The BSS may include a STAs that have successfully synchronized using the JOIN service primitives and one STA that has used the START primitive. Membership in a BSS may not imply that wireless communication with all other members of the BSS is possible. According to the IEEE 802.11 standard a STA may be a mobile device, an access point "AP" or a mesh device "MSTA". Although not specified, the messages and protocols described below may be bi-directional and can flow from a mobile device to an AP and vice-versa. In infrastructure mode, a single AP together with all associated STAs is called a BSS. Every BSS has an identification (ID) called the BSSID, which may be the MAC address of the AP servicing the BSS. The simplest BSS may include one AP and one STA. There may be two types of BSS: 1) independent BSS (also referred to as IBSS); and 2) infrastructure BSS. An independent BSS ("IBSS") may be an ad-hoc network of STAs that contains no APs, which means they may not connect to any other basic service set.<!-- EPO <DP n="5"> --></p>
<p id="p0011" num="0011">A common distribution system ("DS") and two or more BSSs may create an extended service set ("ESS"). The ESS may be a set of one or more interconnected BSSs and integrated local area networks that appear as a single BSS to the logical link control layer at any STA associated with one of those BSSs. APs in an ESS are connected by a distribution system. The APs communicate amongst themselves to forward traffic from one BSS to another to facilitate movement of STAs between BSSs through the distribution system. The distribution system is the backbone of the wireless LAN and may be constructed of either a wired LAN or wireless network. The distribution system is a thin layer in each AP that determines the destination for traffic received from a BSS. The distribution system determines if traffic should be relayed back to a destination in the same BSS, forwarded on the distribution system to another AP, or sent into the wired network to a destination not in the extended service set. Communications received by an AP from the distribution system are transmitted to the BSS to be received by the destination mobile device.</p>
<p id="p0012" num="0012">Network equipment outside of the extended service set views the ESS and all of its STAs as a single MAC-layer network where all STAs are physically stationary. Thus, the ESS "hides" the mobility of the mobile devices from everything outside the ESS. In other words, components outside of the ESS need not be aware of or informed about the mobility of the mobile devices within the ESS. This level of indirection provided by the IEEE 802.11 architecture allows existing network protocols that have no concept of mobility to operate correctly with a wireless LAN where there is mobility. With ESS, the entire network may appear as an independent basic service set ("IBSS") to the Logical Link Control layer ("LLC"). Accordingly, STAs within the ESS may communicate or even move between BSSs transparently to the LLC. Each BSS may have an identity ("ID") called a service set identity ("SSID") which<!-- EPO <DP n="6"> --> is a 32-byte (maximum) character string. As described below, the transition between networks may include a transition between ESSs through the use of a common root key ("K") that is transmitted during discovery communications. Also as described below, there may be an Extended Authentication Server ("EAS") that acts as a key holder for advertising the keys during discovery communications.</p>
<p id="p0013" num="0013">Mobile devices that communicate prior to network association and transition between networks (e.g. ESSs) may include mobile communication devices, mobile computing devices, or any other device capable of communicating wirelessly with a wireless network. Such devices may also be referred to as terminals, wireless terminals, mobile devices, stations ("STA") or user equipment, and may also include mobile smart phones (e.g., a BlackBerry® smart phone or BlackBerry® Playbook), wireless personal digital assistants ("PDA"), machine to machine equipment, equipment within a smart grid ("SmartGrid"), equipment within a mesh network (an ad-hoc or peer network), laptop/notebook/netbook computers with wireless adapters, etc.</p>
<p id="p0014" num="0014">Some mobile devices may transition between ESS networks, which may include a wireless local area network ("WLAN"). Network discovery and connectivity in a WLAN may occur through standards that define access, control and communications in networks, such as the communication standard known as IEEE@ (Institute for Electrical and Electronics Engineers) 802.11, which, among other things, includes features describing "interworking with external networks." The "interworking" standard may be part of the IEEE 802.11-2012 base standard, and was formerly part of the amendment document IEEE 802.11u. Alternatively, the network discovery and connectivity may be subject to other parts of the IEEE 802.11 standard and other wireless communication standards including WLAN standards including any IEEE@ 802.xx standard (e.g. IEEE 802.15, IEEE 802.16, IEEE 802.19, IEEE 802.20, and IEEE 802.22),<!-- EPO <DP n="7"> --> personal area network standards, wide area network standards, or cellular communication standards.</p>
<p id="p0015" num="0015">One exemplary network may be a WLAN and is described below. Alternatively, the devices may discover information about other networks through other protocols and architectures, including a cellular network or a WiMax network. The network may comprise a publicly accessible network, such as the Internet, a private network, such as an intranet, or combinations thereof, and may utilize a variety of networking protocols now available or later developed including, but not limited to TCP/IP based networking protocols. The networks may include any communication method or employ any form of machine-readable media for communicating information from one device to another.</p>
<p id="p0016" num="0016">The transition between networks through discovery communications may be implemented in many environments providing WLAN access for network connectivity or in WLAN access locations or environments in which it may be expected that one or more users carrying respective mobile devices will associate with (i.e., join or connect to) and disassociate from a wireless network, AP, or WLAN as they enter and exit the WLAN access locations or environments.</p>
<p id="p0017" num="0017">In a WLAN environment, network discovery may include, for example, an active scan procedure or passive scan procedure performed by the mobile device. Typically, scanning procedures within a WLAN environment involve scanning for (i.e., determining) candidate STAs (e.g., mobile device, APs or mesh stations "MSTAs") with which the mobile device may associate with during an association procedure or re-associate with during a re-association procedure. In a passive scan procedure, a mobile device may "listen for" (i.e., receive or detect) beacon frames periodically transmitted from another STA (e.g., a mobile device, an AP or<!-- EPO <DP n="8"> --> MSTA). In an active scan procedure, the mobile device generates one or more probe request frames. A STA (e.g., a mobile device, an AP or MSTA) that receives a probe request frame, in response, transmits a probe response frame. The mobile device then processes any received probe response frames.</p>
<p id="p0018" num="0018">In some WLAN environments, network discovery may further include an IEEE 802.11 authentication procedure. In other words, network discovery may include a successful authentication, an unsuccessful authentication, or a deauthentication of a mobile device with one of the STAs that were identified during the scanning procedure discussed above. Stated another way, network discovery may include: a transition of the mobile device from "State 1" to "State 2" based on a successful authentication of the mobile device; an unchanged state (i.e., remaining in "State 1") of the mobile device if authentication of the mobile device was unsuccessful; or a transition of the mobile device from "State 2" to "State 1" based on a deauthentication of the mobile device.</p>
<p id="p0019" num="0019">Some WLAN locations or environments may be known as "hotspots" in reference to a location or environment that is within communication range of WLAN signals. WLAN locations or environments may include coffee shops, retail stores, home locations (e.g. homes and apartments), educational facilities, office environments, airports, public transportation stations and vehicles, hotels, etc. Such WLANs are often implemented as access networks that provide access to publicly accessible networks and may be associated with, or support access to, external networks (or WLAN-supported networks) owned and/or operated by subscription-based service providers. For example, an external network can be owned and/or operated by an Internet-access service provider or a telecommunications carrier/service provider that provides subscription-based Internet access for a fee (e.g., a monthly fee). In some systems, a<!-- EPO <DP n="9"> --> subscriber/user may subscribe to such a service can use wireless network access and/or Internet-access services based on such a subscription when the subscriber is in communication proximity of the WLAN with an appropriate mobile device. In some instances, different WLANs may provide access to different types of network information. For example, some WLANs may provide access to particular subscription service provider networks, and some WLANs may support roaming agreements to allow connections from mobile devices associated with different SSPs.</p>
<p id="p0020" num="0020">During some network discovery processes a mobile device may transmit a query for certain network information from the wireless local area network ("WLAN"). The terminal may obtain network information made available by WLANs to determine, based on the network information, whether to continue with a connection process to associate with that network.</p>
<p id="p0021" num="0021">In accordance with the embodiments described herein, mobile devices may request network information from WLANs using an Access Network Query Protocol ("ANQP"). ANQP supports information retrieval from an Advertisement Server that supports a Generic Advertisement Service ("GAS"). ANQP and GAS are defined in IEEE® 802.11u™ and also IEEE® 802.11-2012™.</p>
<p id="p0022" num="0022">Generic Advertisement Service ("GAS") may serve as a transport mechanism, at layer-2 (see e.g. <figref idref="f0002">Figure 2</figref>), for an advertisement protocol such as ANQP. The advertisement protocol may connect the mobile device to one of several interworked servers. The advertisement protocol allows the transmission of frames between a mobile device and a server in the network prior to network connectivity. For example, GAS provides support for network selection by a mobile device as well as for communication between the mobile device and other information resources in the network before the mobile device associates with a WLAN. The<!-- EPO <DP n="10"> --> mobile device may be connected to a layer-2 radio service, without exchanging any authentication parameters or without having a recognized session (because no session keys are established and no internet protocol "IP" address is assigned). When in compliance with the IEEE 802.11 standard, no data traffic is allowed in this state.</p>
<p id="p0023" num="0023">Other layer-2 transport mechanisms or even authentication mechanisms may be used. For example, the Extensible Authentication Protocol ("EAP") may be used to carry the advertisement protocol. The advertisement protocol information would be encapsulated within a suitable EAP-TLV (type length value) method frame (or alternative EAP method frame) and transported by the EAP. Use of secure credentials exchanged during the EAP transactions would also provide a level of security for any information carried within the advertisement protocol. For example, if EAP-SIM (or EAP-AKA) were to be the authentication protocol, any advertisement protocol information encapsulated (i.e. securely carried) within a suitable EAP-TLV frame during the same EAP transaction may also be protected by the SIM credentials.</p>
<p id="p0024" num="0024">Access Network Query Protocol ("ANQP") is an advertisement protocol and operates as a query and response protocol used by a mobile device to discover a range of information from a server including accessible roaming partners internet protocol address type availability, and other metadata useful in the mobile device's network selection process. ANQP is capable of discovering information about hotspots or wireless networks, prior to the mobile device establishing network connectivity and associating with that network. In addition to being defined in IEEE@ 802.11u, additional ANQP messages may alternatively or additionally be defined in the Wi-Fi Alliance ("WFA") Hotspot 2.0 (also referred to as Passpoint) specifications. These ANQP extensions within the WFA Hotspot 2.0 specifications may be referred to as Hotspot ("HS") 2.0 ANQP elements. Alternatively, other advertisement protocols (e.g.,<!-- EPO <DP n="11"> --> Registered Location Query Protocol "RLQP" as defined in IEEE® 802.11af and Hotspot Registration Protocol "HRP" as defined in Wi-Fi Alliance Hotspot 2.0) may also be used. ANQP provides one embodiment for communication with a WLAN at the network discovery stage without requiring an association with the WLAN. Network information that is communicated prior to network association (or at the network discovery stage) is discussed below. In alternative embodiments, other layer-2 transport mechanisms or even authentication mechanisms such as the Extensible Authentication Protocol (EAP) could be used to carry the ANQP messages. The ANQP message would be encapsulated within a suitable EAP-TLV method frame (or alternative EAP method frame) and transported by the EAP.</p>
<p id="p0025" num="0025">A network discovery exchange may involve a requesting STA querying another STA (e.g., a mobile device, an AP or MSTA) for network information. A WLAN AP (also referred to simply as an AP) is an entity that contains one STA and provides access to distribution services via a wireless medium for associated STAs. The queried or receiving STA (e.g., a mobile device, an AP or an MSTA) may respond to the received query with the requested information in a response. The queried or receiving terminal can provide the response information with or without proxying the query to a server in an external network (e.g., a subscription service provider ("SSP") network). For example, an external network connected to a queried WLAN may have certain network information accessible via the WLAN and of which a querying mobile device may be made aware. The network discovery exchange or communications prior to network association may use ANQP or other query protocols too, just as information exchange services may be used alternatively.</p>
<p id="p0026" num="0026"><figref idref="f0001">Figure 1</figref> illustrates a communication network 100. Network information may be communicated during network discovery using ANQP over the communications network 100.<!-- EPO <DP n="12"> --> The communication network 100 includes a plurality of WLAN access locations 102a-c having respective access points ("APs") 104a-c that provide access to respective access networks 106a-c. The APs 104a-c are further described with respect to <figref idref="f0006">Figure 6</figref>. The access network A 106a provides access to an external network A 108a and the access network B 106b provides access to an external network B 108b. Unlike the access networks A 106a and B 106b that do not connect directly to the Internet 112, the access network C 110 may connect directly to a publicly accessible network like the Internet. Thus, the access network C 106c may be a public network, while the access networks A 106a and B 106b may be private networks. Any of the described networks may form part of an ESS.</p>
<p id="p0027" num="0027">In one embodiment, each of the external networks A 108a and B 108b may be a subscription service provider network ("SSPN") owned or operated by data subscription service providers, Internet subscription service providers, media (e.g., audio/video) subscription service providers, wireless communications subscription service providers, or any combination thereof. The external networks A 108a and B 108b are connected to the Internet 112 and may, for example, provide subscription-based Internet access to mobile device devices. In some implementations, roaming agreements between different subscription service providers may enable the external networks A 108a and B 108b to support roaming connections for mobile devices associated with other subscription service providers. In one embodiment, the external networks 108a-b are ESS networks. Alternatively, networks 106a-c may be ESS networks.</p>
<p id="p0028" num="0028">The WLAN access location 102a illustrates a mobile device 114 in wireless range of the access point ("AP") 104a. The mobile device 114 is further described with respect to <figref idref="f0005">Figure 5</figref>. The AP 104a connects with the access network A 106a, which may provide a direct or indirect connection to other networks, including publicly accessible network like the Internet<!-- EPO <DP n="13"> --> 112. Prior to the mobile device 114 associating with the access network A 106a, mobile device 114 sends a discovery request 116 to the AP 104a. The AP 104a may respond with a discovery response 118. In alternative embodiments, the discovery request 116 may originate from the AP 104a and the discovery response 118 may be from the mobile device 114, such as with mesh, peer to peer, ad-hoc or Wi-Fi direct networks. The discovery request 116 or the discovery response 118 may include discovery communications 120. The discovery communications 120, also known as network information, discovery information, or network discovery information, may include information about the network and/or device that is communicated between the device and the network prior to the device associating with the network. Accordingly, the discovery communications 120 may be referred to as pre-association communications or pre-association information. In one embodiment, the discovery communications 120 may be communicated using the ANQP protocol.</p>
<p id="p0029" num="0029">The discovery communications (request 116 and response 120) may be exchanged at a media access control ("MAC") sub-layer of a data link layer of the Open Systems Interconnection ("OSI") Reference Model without needing to use operations at or above an internet protocol ("IP") layer (i.e., a network layer) and without needing to otherwise provide access to the IP layer while discovering discovery communications 120. Discovering network information using messages exchanged at or above the network layer may require more processing power for a mobile device than implementing processes at the MAC sub-layer. The layers in which the discovery communication occurs are further illustrated in <figref idref="f0002">Figure 2</figref>.</p>
<p id="p0030" num="0030">Each of the APs 104a-c and the mobile device 114 may include a network adapter or network interface card that facilitates connections to a wireless medium. The network interface component may be referred to as a station ("STA"). Each of the access networks 106a-c and the<!-- EPO <DP n="14"> --> external networks 108a-b may be associated with one or more ESSs and a key holder identifier may be provided to mobile devices 114 prior to the association with a network.</p>
<p id="p0031" num="0031">The mobile device 114 may associate with different APs (e.g., the APs 104a-c) based at least partially on the discovery communications 120 received regarding the available external networks. The mobile device 114 may receive information from the APs when moved in range of one of the WLAN access locations 102a-c, respectively. The information received may be discovery communications prior to association that include information about the particular BSS or ESS for the networks. The information received may be utilized when transitioning between networks.</p>
<p id="p0032" num="0032"><figref idref="f0002">Figure 2</figref> illustrates a communication layer architecture 200. The communication layer architecture 200 includes seven layers which may be implemented in accordance with the Open Systems Interconnection ("OSI") Reference Model. The communication layer architecture 200 includes a data link layer 202, which includes a media access control ("MAC") sub-layer 204. Mobile devices (e.g., the mobile device 114 of <figref idref="f0001">Figure 1</figref>) may provide network information or discovery communications 120 (e.g. the discovery request 116 and the discovery response 118) with wireless access points (e.g., the APs 102a-c of <figref idref="f0001">Figure 1</figref>) at the MAC sub-layer 204. A mobile device may access information from a memory or other hardware of the mobile device at the MAC sub-layer 204 without needing to perform operations at or above an internet protocol layer (e.g., a network layer 208) and without needing to provide access to the internet protocol layer. Mobile devices (e.g., the mobile device 114 of <figref idref="f0001">Figure 1</figref>) that include mobile smart phones, PDA's, processor based devices, etc. may have relatively limited processor cycles and less available electrical power than fixed-location computing devices powered using wired (e.g. alternating current) electricity sources. Low-level resource operations at the MAC sub-layer<!-- EPO <DP n="15"> --> require relatively fewer system resources than user-interface-intensive and operating system intensive operations (e.g., web-browser operations) at an application layer.</p>
<p id="p0033" num="0033">Some communications or authentication techniques that use hypertext transfer protocol ("HTTP") or other internet protocol processes may require establishing a connection between a mobile device and a wireless access point at one or more of the layers between and including the network layer 208 and an application layer 210 of the communication layer architecture 200. In these applications, discovery communications 120 may not require a connection or access to the network layer 208 or any layers within a protocol suite. An inclusion of a discovery communication 120 on the MAC sub-layer 204 may allow for a mobile device to communicate with a network without associating with the network.</p>
<p id="p0034" num="0034">Discovering network information available via access points using the MAC sub-layer may be used for identifying the BSS and/or ESS associated with a particular AP. As described below in <figref idref="f0003 f0004">Figures 3-4</figref>, the ESS information may be used by a mobile device to transition seamlessly between different networks associated with different ESSs. The discovery communications 120 may indicate whether a particular network (e.g., a SSPN) has the extended capability for improved transitions between ESS networks. An indication of that capability may be a particular bit added to the Extended Capability information element ("IE") that indicates the ability to utilize a key K for faster transitions between ESS networks. As described below, the particular bit may be referred to as a Fast Initial Link Setup ("FILS") bit and may be a part of discovery communications prior to association. The FILS bit may indicate whether the extended capability for expedited transitions is possible. Further, the discovery communications may include a key holder identifier that is advertised to mobile devices to allow those terminals to<!-- EPO <DP n="16"> --> determine when ESS networks have access to the same key. The key may be derived at the mobile device through an algorithm which eliminates the need to transmit the key.</p>
<p id="p0035" num="0035"><figref idref="f0003">Figure 3</figref> illustrates an alternative communication network 300. In particular, the network 300 illustrates the communication between the mobile device 114, the AP 104, and an ESS network 305. An Extended Authentication Server ("EAS") 302 may be the key holder that provides the key identification to be used, by the AP 104, during pre-association communications. The EAS 302 may be implemented as hardware and/or software. In one embodiment, the EAS 302 may be an additional hardware device that communicates with the ESS network 305. Alternatively, the EAS 302 may be software that runs on existing hardware in communication with the ESS network 305. Exemplary existing hardware that may operate as the EAS 302 may include a maintenance server and/or a billing server that are configured (through software) to act as the EAS 302. The EAS 302 may be an authentication mechanism that covers multiple networks over a large area. For example, an EAS 302 may cover a small city or county. The ESS network 305 may advertise, via the AP 104, the EAS 302 to the mobile devices 114 that the ESS network 305 is associated with. In particular, as the EAS 302 may be the key holder, its identity, referred to as "K<sub>ID</sub>", may be advertised or broadcast.</p>
<p id="p0036" num="0036">Upon initial entry into the network 305, the mobile device 114 discovers the identity of a key holder "K<sub>ID</sub>" from AP 104 (as advertised by the AP 104 in pre-association communications) together with identity of the ESS itself. The K<sub>ID</sub> may be implemented to identify the K key holder, which is the EAS 302 in the example shown in <figref idref="f0003">Figure 3</figref>. AP 104 may advertise or broadcast (to mobile devices, such as the mobile device 114) the identity of the K key holder K<sub>ID</sub>. A new ANQP-message or field may be utilized to allow advertisement of the K<sub>ID</sub>. Once the mobile device 114 detects the Fast Initial Link Setup ("FILS") bit within the<!-- EPO <DP n="17"> --> broadcasted Extended Capabilities IE from the AP, the mobile device 114 may then retrieve the K<sub>ID</sub> using this new ANQP-message or field.</p>
<p id="p0037" num="0037">The K<sub>ID</sub> may be the address of the EAS and may also be referred to as the Fast Initial Link Setup ("FILS") identity. FILS may refer to mechanisms for improving the initialization and association of devices with wireless networks. In this case, the transition between networks is fast and seamless because of the key identification. In particular, if the ESS 305 is the network that the mobile device 114 wishes to connect to, a "K" key security association is established between the mobile device 114 and the EAS 305 by an authentication sequence (examples of which are described with respect to <figref idref="f0007 f0008">Figures 7-8</figref>).</p>
<p id="p0038" num="0038">At each new AP 104 that the mobile device 114 encounters, ESS 305 and key holder identities may be discovered through discovery communications (e.g. using a new ANQP-message or field). A new ESS level key ("K") is created at the ESS (network) level and may then be used as a symmetric key between the mobile device 114 and the EAS 302 that the mobile device 114 connects to. The K key may be derived from the IEEE 802.11u HESSID identifier used to identify homogeneous ESSs (e.g. ESSs that share some sort of relationship). The K key may also be derived by an authentication sequence between the mobile device 114 and the EAS 302, with the IEEE 802.11u HESSID being used to identify the EAS 302 in one example. An existing IEEE 802.11 parameter such as the HESSID (or FQDN or other new network identifier) may be used to carry the K<sub>ID</sub> parameter. Once the mobile device 114 detects the FILS bit within the broadcast Extended Capabilities IE from the AP, the mobile device 114 may directly use the HESSID parameter. The HESSID parameter and FILS bit may also broadcast from the AP. If the HESSID is not being used as the K<sub>ID</sub>, then another ANQP-message may be used to retrieve it.<!-- EPO <DP n="18"> --></p>
<p id="p0039" num="0039">The EAS 305 maintains the K key and the K<sub>ID</sub> (the address of the EAS) becomes the identity of the K key holder. As described, the AP 104 advertises (through discovery communications) the K<sub>ID</sub> before association with the network. Mobile devices may then utilize the K<sub>ID</sub> information that is transmitted before network association to transition between networks with the same K<sub>ID</sub>.</p>
<p id="p0040" num="0040">Extended authentication request and response messages may be generated to allow the K key to be transported from the device to an AP, to allow a more efficient authentication mechanism when transitioning from one ESS to another. The extended messages may include an extra bit that is added to the advertised Extended Capability information element ("IE"). The extra bit may indicate that ESS transitioning using the K key is enabled. The Extended Capability IE may be returned to a mobile device by an AP in a probe response with a single bit set within this IE to indicate ESS transitioning support.</p>
<p id="p0041" num="0041"><figref idref="f0004">Figure 4</figref> illustrates another alternative communication network. In particular, <figref idref="f0004">Figure 4</figref> shows that the mobile device 114 can use the K key to perform an expedited authentication (e.g. a Fast Initial Link Setup "FILS") with another access point AP2 that is connected to a different ESS network (ESS2), advertising the same K<sub>ID</sub> (i.e. the address of the same EAS 302 as shown in <figref idref="f0003">Figure 3</figref>). The expedited authentication may be beneficial as it is faster than conventional authentication, due to the fact that the presence of the K key and K<sub>ID</sub> implies an existing security association between the mobile device 114 and the access network AP2. In other words, assuming that the mobile device 114 has previously connected with the first access network AP1, the mobile device 114 will know the K<sub>ID</sub> and have already established a security association with the EAS with the K key. Then, if the mobile device 114 has discovery communications (pre-association) with the second access point AP2, the K<sub>ID</sub> will be<!-- EPO <DP n="19"> --> transmitted to the mobile device 114 during the discovery communications. Since the EAS 302 and K key cover both the ESS 1 and ESS2 networks, the mobile device 114 can quickly transition to the second access point AP2 network because of the prior security association. The EAS 302 providing the K<sub>ID</sub> and the K key association with the mobile device 114 allows for fast transitions between any ESS networks associated with that EAS 302.</p>
<p id="p0042" num="0042"><figref idref="f0005">Figure 5</figref> illustrates a mobile device 114 as shown in <figref idref="f0001">Figures 1</figref>, <figref idref="f0003">3</figref>, and <figref idref="f0004">4</figref>. The mobile device 114 includes a processor 502 that may be used to control the overall operation of the mobile device 114. The processor 502 may be implemented using a controller, a general purpose processor, a digital signal processor, dedicated hardware, or any combination thereof. The processor 502 may include a central processing unit, a graphics processing unit, a digital signal processor or other type of processing device. The processor 502 may be a component in any one of a variety of systems. For example, the processor 502 may be part of a standard personal computer or a workstation. The processor 502 may be one or more general processors, digital signal processors, application specific integrated circuits, field programmable gate arrays, servers, networks, digital circuits, analog circuits, combinations thereof, or other now known or later developed devices for analyzing and processing data. The processor 502 may operate in conjunction with a software program, such as code generated manually (i.e., programmed).</p>
<p id="p0043" num="0043">The mobile device 114 also includes a terminal message generator 504 and a terminal data parser 506. The terminal message generator 504 may generate network information discovery messages such as the discovery request 116 and discover response 118 for communicating the network information 120 from <figref idref="f0001">Figure 1</figref>. The terminal data parser 506 may be used to retrieve network information from memory (e.g., random access memory 510, etc.).<!-- EPO <DP n="20"> --> For example, the terminal data parser 506 may retrieve network information 120 that is cached in the mobile device 114 after receipt from a WLAN (e.g., the access networks 106a-c of <figref idref="f0001">Figure 1</figref>).</p>
<p id="p0044" num="0044">In the illustrated embodiment, the terminal message generator 504 and the terminal data parser 506 are shown as separate from and connected to the processor 502. In alternative embodiments, the terminal message generator 504 and the terminal data parser 506 may be implemented in the processor 502 and/or in a wireless communication subsystem (e.g., a wireless communication subsystem 518). The terminal message generator 504 and the terminal data parser 506 may be implemented using any combination of hardware, firmware, and/or software. For example, one or more integrated circuits, discrete semiconductor components, and/or passive electronic components may be used. For example, the terminal message generator 504 and the terminal data parser 506, or parts thereof, may be implemented using one or more circuits, programmable processors, application specific integrated circuits, programmable logic devices, field programmable logic devices, etc.</p>
<p id="p0045" num="0045">The terminal message generator 504 and the terminal data parser 506, or parts thereof, may be implemented using instructions, code, and/or other software and/or firmware, etc. stored on a machine accessible medium and executable by, for example, a processor (e.g., the processor 502). The terminal message generator 504 or the terminal data parser 506 may be stored on or include a tangible storage medium or memory. For example, the terminal message generator 504 or the terminal data parser 506 may be implemented in software stored on a memory that is executable by the processor 502. Alternatively, the terminal message generator 504 and/or the terminal data parser 506 may be implemented in hardware with software functions. The memory for storing software associated with the terminal message generator 504 and/or the terminal data parser 506 may include, but is not limited to, computer readable storage<!-- EPO <DP n="21"> --> media such as various types of volatile and non-volatile storage media, including random access memory, read-only memory, programmable read-only memory, electrically programmable read-only memory, electrically erasable read-only memory, flash memory, magnetic tape or disk, optical media and the like. In one embodiment, the memory may include the random access memory 510 for the processor 502, or may be an external storage device or database for storing recorded ad or user data. Examples include a hard drive, compact disc ("CD"), digital video disc ("DVD"), memory card, memory stick, floppy disc, universal serial bus ("USB") memory device, or any other device operative to store user data. The memory is operable to store instructions executable by the processor 502.</p>
<p id="p0046" num="0046">The mobile device 114 may include a FLASH memory 508, a random access memory 510, and/or an expandable memory interface 512 coupled with the processor 502. The FLASH memory 508 may store computer readable instructions and/or data. In some embodiments, the FLASH memory 508 and/or the RAM 510 may store the network information 120 from <figref idref="f0001">Figure 1</figref> and instructions for communicating that network information 120. The processor 502 may be coupled with the memory (e.g. the FLASH memory 508, or the RAM 510) for storing software instructions executable by the processor 502. The memory may include, but is not limited to, computer readable storage media such as various types of volatile and non-volatile storage media, including random access memory, read-only memory, programmable read-only memory, electrically programmable read-only memory, electrically erasable read-only memory, flash memory, magnetic tape or disk, optical media and the like. The functions, acts or tasks illustrated in the figures or described herein may be performed by the programmed processor 502 executing the instructions stored in the memory. The functions, acts or tasks are independent of the particular type of instruction set, storage media, processor or processing strategy and may be<!-- EPO <DP n="22"> --> performed by software, hardware, integrated circuits, firm-ware, micro-code and the like, operating alone or in combination. Likewise, processing strategies may include multiprocessing, multitasking, parallel processing and the like.</p>
<p id="p0047" num="0047">The mobile device 114 may include a security hardware interface 514 to receive a SIM card from a wireless service provider. A SIM card may be used for network discovery communications including authentication of the mobile device 114 for establishing a connection with a WLAN-supported network. The mobile device 114 may be provided with an external data I/O interface 516. The external data I/O interface 516 may be used by a user to transfer information to the mobile device 114 through a wired medium.</p>
<p id="p0048" num="0048">The mobile device 114 may include wireless communication subsystem 518 to enable wireless communications with access points (e.g., the APs 104a-c of <figref idref="f0001">Figure 1</figref>). Although not shown, the mobile device 114 may also have a long-range communication subsystem to receive messages from, and send messages to, a cellular wireless network. In the illustrated examples described herein, the wireless communication subsystem 518 can be configured in accordance with the IEEE@ 802.11 standard. In other example implementations, the wireless communication subsystem 518 may be implemented using a BLUETOOTH® radio, a ZIGBEE® device, a wireless USB device, an ultra-wideband radio, a Near Field Communications ("NFC") device, or a Radio Frequency Identifier ("RFID") device.</p>
<p id="p0049" num="0049">The mobile device 114 may include a user interface for communicating with the mobile device. The user interface may be separate component or it may include a speaker 520, a microphone 522, a display 524, and a user input interface 526. The display 524 may be a liquid crystal display, an organic light emitting diode, a flat panel display, a solid state display, a cathode ray tube, a projector, a printer or other now known or later developed display device for<!-- EPO <DP n="23"> --> outputting determined information. The user input interface 526 may include alphanumeric keyboard and/or telephone-type keypad, a multi-direction actuator or roller wheel with dynamic button pressing capability, a touch panel, etc. The network discovery information that is communicated with a network prior to connection may be communicated with or without each of the user interfaces described herein. The speaker, 520, the microphone 522, the display 524, the user input interface 526, and/or any combination thereof may be omitted in alternative embodiments. In one embodiment, the mobile device 114 is a battery-powered device and includes a battery 528 and a battery interface 530.</p>
<p id="p0050" num="0050"><figref idref="f0006">Figure 6</figref> illustrates an access point ("AP") 104a. The access point shown in <figref idref="f0006">Figure 6</figref> is AP 104a, but may also be illustrative of other access points (e.g. APs 104b, 104c). AP 104a includes a processor 602 to perform operations of the AP 104a. The processor 602 may be similar to the processor 502 described above.</p>
<p id="p0051" num="0051">The AP 104a includes an access point message generator 604 to generate network information communications and an access point data parser 606 for retrieving network information communications from the mobile device 114 and/or the external network A 108a as illustrated in <figref idref="f0001">Figure 1</figref>. The access point message generator 604 may be similar to the terminal message generator 504 of <figref idref="f0005">Figure 5</figref>, and the access point data parser 606 may be similar to the terminal data parser 506 of <figref idref="f0005">Figure 5</figref>. As with the terminal message generator 504 and the terminal data parser 506 of <figref idref="f0005">Figure 5</figref>, the access point message generator 604 and the access point data parser 606 may be implemented in software stored on a memory that is executable by the processor 602 or may be implemented in hardware with software functions executed by the processor 602. Alternatively, the access point message generator 604 and the access point data parser 606 may be implemented in a wireless communication subsystem (e.g., a wireless<!-- EPO <DP n="24"> --> communication subsystem 612) using any combination of hardware, firmware, and/or software including instructions stored on a tangible computer readable medium and/or a non-transitory computer readable medium.</p>
<p id="p0052" num="0052">The AP 104a may also include a FLASH memory 608 and a RAM 610, both of which are coupled to the processor 602. The FLASH memory 608 and/or the random access memory ("RAM") 610 may be configured to store network information (e.g., network information 120 including discovery communications from <figref idref="f0001">Figure 1</figref>). The RAM 610 may also be used to generate messages for communication with the mobile device 114 and/or to the external network A 108a. The RAM 610 may also store received messages communicated by the mobile device 114 and/or the external network A 108a.</p>
<p id="p0053" num="0053">To communicate with mobile devices such as the mobile device 114, the AP 104a may include a wireless communication subsystem 612, which may be similar to the wireless communication subsystem 518 of the mobile device 114 illustrated in <figref idref="f0005">Figure 5</figref>. To communicate with a WLAN-supported network or external network (e.g., the networks 106a-c, 108a, and 108b of <figref idref="f0001">Figure 1</figref>), the AP 104a may include a network uplink communication interface 614.</p>
<p id="p0054" num="0054"><figref idref="f0007">Figure 7</figref> illustrates key authentication. In particular, <figref idref="f0007">Figure 7</figref> shows an example initial authentication sequence where the ESS (network) level K key is derived between a mobile device and an EAS. In one embodiment, the K<sub>ID</sub> may have no relationship to the K key itself. The K key may be derived using a pseudo-random function (e.g. the IEEE 802.11r KDF) based on a hash of elements that may include the mobile identity (MAC address), the EAS Identity, a mutually derived key based on the result of mutual authentication during the initial association process, supplicant Nonce "SNonce" (e.g. from the mobile device), authenticator Nonce<!-- EPO <DP n="25"> --> "ANonce" (e.g. from the EAS), and the SSID of the ESS where the mobile initially connected. A Nonce may be a random number that is not repeated, such as the date and time.</p>
<p id="p0055" num="0055">In message 702, the advertisement of the ESS identity and the EAS identity (K<sub>ID</sub>) provides the mobile device 114 with parameters that are related to the network to which the AP is connected. The advertisement may be performed during discovery communications while the mobile device 114 is in a pre-associated state. In block 704, an authentication request is sent from the mobile device 114 to the EAS 302. The authentication request may include the K<sub>ID</sub> along with an SNonce variable. In message 706, the authentication response is sent to the mobile device 114 from the EAS 302. The authentication response may include the K<sub>ID</sub> along with an ANonce variable. In message 708, an association message exchange may occur. The association message exchange may occur between the mobile device 114 and the EAS 302 resulting in the generation of the key K value. In one embodiment, the key K is not transmitted for security reasons, rather the key K is generated (e.g. derived or calculated) mutually by the mobile device 114 and the EAS 302. In another embodiment, the key K is not transmitted for security reasons, rather the key K is generated asymmetrically by the EAS 302 using an identity of the mobile device 114. In another embodiment, the K key has a lifetime. When the lifetime of K expires, the mobile device may re-run the initial authentication sequence (with the same EAS 302 or a new EAS) to generate a new K key. This new K key will be different from the old one, as SNonce and ANonce have different values.</p>
<p id="p0056" num="0056"><figref idref="f0008">Figure 8</figref> illustrates device authentication. As illustrated in <figref idref="f0008">Figure 8</figref>, the messages may be related to the expedited transition and authentication of the mobile device 114 with a second access point 104 and a second ESS network after previously authenticating with a first access point 104 and a first ESS network associated with the same EAS 302. In other words,<!-- EPO <DP n="26"> --> <figref idref="f0008">Figure 8</figref> illustrates the communications between the EAS 302, ESS Network 2, AP2, and the mobile device 114 as illustrated in <figref idref="f0004">Figure 4</figref>.</p>
<p id="p0057" num="0057">The messages in <figref idref="f0008">Figure 8</figref> include an initialization message 802 between the access point 104 and the EAS 302. The initialization message 802 may allow the AP to have both the K key and K<sub>ID</sub>, before the mobile device 114 comes into radio range of the ESS network. It is also possible to split this message into two parts so that the K<sub>ID</sub> can be delivered to AP 104 at system initiation, and then the K key may be delivered once it has been derived as the mobile device enters the ESS network range. Accordingly, the K<sub>ID</sub> can be advertised to the mobile devices 114 from the AP 104 through the advertisement message 804. The advertisement message 804 may be performed using a probe request or a probe response between the mobile device 114 and the AP 104. Alternatively, ANQP messages may be sent from the mobile device 114 to the AP 104. In this message the identity of the ESS to which the AP 104 is connected (ESS) and the identity of the K Key holder (K<sub>ID</sub>) may be transmitted to the mobile device 114. The mobile device 114 receives the ESS and/or K<sub>ID</sub> and knows whether an expedited authentication is possible. In particular, if the mobile device 114 has already authentication with the same K<sub>ID</sub>, then expedited authentication is possible for the other ESSs associated with that key holder (i.e. the EAS is the same). The expedited authentication sequence 806 may then occur. The authentication sequence may take place between the mobile device 114 and the access point 104. The EAS may need to pass the key K to the access point 104, prior to the initial authentication sequence.</p>
<p id="p0058" num="0058"><figref idref="f0008">Figure 9</figref> illustrates key generation 901. In particular, the key generation 901 may occur at the individual devices (e.g. the mobile device 114 and the EAS 302) so that the key K does not need to be communicated. The local key generation 901 may be performed through an an algorithm that utilizes certain information, such as the K<sub>ID</sub> and appropriate Nonces, to generate<!-- EPO <DP n="27"> --> the key K. The generation of the K key may result from a symmetrical algorithm operating between individual devices (mutual) or an asymmetric algorithm operating in one device only. The key generation 901 may include network level K key 902, certificate based K key 904, and/or Kerberos ticket K key 906.</p>
<p id="p0059" num="0059">The certificate based K key 904 may be derived from a certificate delivered by a Root Certificate Authority that has a trust relationship with the mobile device and the EAS. The type of certificate may be insignificant. In this case, the mobile device 114 may have to perform an initial out of band ("OOB") enrolment protocol with the EAS (potentially using GAS or some other protocol) to initialize its certificate. Each access point may also have a certificate derived from the same Root Certificate Authority. An alternative is that a manufacturer's certificate may be used, although this may be difficult to revoke if the security of the mobile device is compromised. Once the mobile device 114 has a certificate, either an asymmetric or symmetric algorithm (e.g. Diffie-Hellman) exchange may be used between it and the EAS to derive a public/private K key pair, which is used for authentication as the mobile device 114 moves between ESSs. The lifetime of the derived private key may be difficult to manage when using a certificate based K key 904.</p>
<p id="p0060" num="0060">The Kerberos ticket K Key 906 may be derived when the mobile device 114 authenticates with an initial ESS for the first time. The K key itself may not be passed over the air. Rather mathematical parameters which allow the K key to be derived may be passed. Although, this initial transaction may be rather slow, subsequent transactions may be much faster. An exemplary process for a mobile device 114 may include: 1) an initial login using IEEE 802.1X (authenticate); 2) obtaining a Kerberos ticket (enrollment process); 3) re-authenticate (when necessary) to a new hotspot using the Kerberos ticket; and 4) perform an<!-- EPO <DP n="28"> --> online signup to establish more permanent credentials. Kerberos tickets may be time limited, for example, to only multiple hours. If the Kerberos Server is located on the same realm (advertised by K<sub>ID</sub>) as the EAS (see <figref idref="f0004">Figure 4</figref>), then the mobile device 114 may perform expedited authentication and association as it transitions between each ESS.</p>
<p id="p0061" num="0061"><figref idref="f0009">Figure 10</figref> illustrates a process for generating and utilizing a key for transitioning between ESS networks. In block 1002, a mobile device may receive an advertisement of a key holder identity K<sub>ID</sub> from a particular network. The key holder may be an EAS that provides the key holder identity to a number of ESS networks. The advertisement may be a discovery communication prior to network association and may be an ANQP communication. In block 1004, the mobile device may connect with or associate with a first ESS network associated with the EAS. The association may include an authentication process in which the mobile device is authenticated to access the network. When within range of a second ESS network, the device may receive an advertisement from the second ESS network that includes the same key holder identity K<sub>ID</sub> that was advertised from the first ESS network as in block 1006. The receipt of the advertisement form the second ESS network may occur after the mobile device has left the first ESS network, or it may occur while the mobile device is still associated with the first ESS network. The advertisements of the key holder identity K<sub>ID</sub> may include an identifier of the particular ESS network (e.g. ESS1 or ESS2).</p>
<p id="p0062" num="0062">Since the mobile device has already authenticated with a related ESS network (ESS1, which is related because of the common security association with EAS), there may be an abbreviated or expedited authentication. This expedited authentication process may also be referred to as a seamless or expedited transition between ESS networks. In block 1008, the key<!-- EPO <DP n="29"> --> K may be derived on the mobile device as described with respect to <figref idref="f0008">Figure 9</figref>. Once the K key is derived, the mobile device may transition from the first ESS network to the second ESS network.</p>
<p id="p0063" num="0063"><figref idref="f0009">Figure 11</figref> illustrates another process for generating and utilizing a key for transitioning between ESS networks. In block 1102, the key may be generated. As described above, the key may be generated at the mobile device and/or the EAS without passing the key over a network. In block 1104, a key holder identifier K<sub>ID</sub> that is used to identify the key holder may be generated. As described, the K<sub>ID</sub> may identify the EAS for one or more ESS networks. In block 1106, discovery communications from the access points are advertised that include the K<sub>ID</sub>. In addition to identifying the key holder identity (EAS, K<sub>ID</sub>), the discovery communications may also identify the ESS for the particular access point. In block 1108, authentication messages may be derived based on the generation of the key K at the mobile device and at the EAS. The authentication may include a verification at the mobile device and/or the EAS that the key was properly generated. In one embodiment, this verification may occur without any authentication messages being transmitted. In block 1110, the mobile device may transition between ESS networks. When those networks are connected with the same EAS the transition may be expedited in part because the K key is already know. The expedited transition may be utilized when the mobile device recognizes the K<sub>ID</sub> that is advertised.</p>
<p id="p0064" num="0064">The system and process described may be encoded in a signal bearing medium, a computer readable medium such as a memory, programmed within a device such as one or more integrated circuits, and one or more processors or processed by a controller or a computer. If the methods are performed by software, the software may reside in a memory resident to or interfaced to a storage device, synchronizer, a communication interface, or non-volatile or volatile memory in communication with a transmitter. A circuit or electronic device designed to<!-- EPO <DP n="30"> --> send data to another location. The memory may include an ordered listing of executable instructions for implementing logical functions. A logical function or any system element described may be implemented through optic circuitry, digital circuitry, through source code, through analog circuitry, through an analog source such as an analog electrical, audio, or video signal or a combination. The software may be embodied in any computer-readable or signal-bearing medium, for use by, or in connection with an instruction executable system, apparatus, or device. Such a system may include a computer-based system, a processor-containing system, or another system that may selectively fetch instructions from an instruction executable system, apparatus, or device that may also execute instructions.</p>
<p id="p0065" num="0065">A "computer-readable medium," "machine readable medium," "propagated-signal" medium, and/or "signal-bearing medium" may comprise any device that includes, stores, communicates, propagates, or transports software for use by or in connection with an instruction executable system, apparatus, or device. The machine-readable medium may selectively be, but not limited to, an electronic, magnetic, optical, electromagnetic, infrared, or semiconductor system, apparatus, device, or propagation medium. A non-exhaustive list of examples of a machine-readable medium would include: an electrical connection "electronic" having one or more wires, a portable magnetic or optical disk, a volatile memory such as a Random Access Memory "RAM", a Read-Only Memory "ROM", an Erasable Programmable Read-Only Memory (EPROM or Flash memory), or an optical fiber. A machine-readable medium may also include a tangible medium upon which software is printed, as the software may be electronically stored as an image or in another format (e.g., through an optical scan), then compiled, and/or interpreted or otherwise processed. The processed medium may then be stored in a computer and/or machine memory.<!-- EPO <DP n="31"> --></p>
<p id="p0066" num="0066">In an alternative embodiment, dedicated hardware implementations, such as application specific integrated circuits, programmable logic arrays and other hardware devices, can be constructed to implement one or more of the methods described herein. Applications that may include the apparatus and systems of various embodiments can broadly include a variety of electronic and computer systems. One or more embodiments described herein may implement functions using two or more specific interconnected hardware modules or devices with related control and data signals that can be communicated between and through the modules, or as portions of an application-specific integrated circuit. Accordingly, the present system encompasses software, firmware, and hardware implementations.</p>
<p id="p0067" num="0067">The illustrations of the embodiments described herein are intended to provide a general understanding of the structure of the various embodiments. The illustrations are not intended to serve as a complete description of all of the elements and features of apparatus and systems that utilize the structures or methods described herein. Many other embodiments may be apparent to those of skill in the art upon reviewing the disclosure. Other embodiments may be utilized and derived from the disclosure, such that structural and logical substitutions and changes may be made without departing from the scope of the disclosure. Additionally, the illustrations are merely representational and may not be drawn to scale. Certain proportions within the illustrations may be exaggerated, while other proportions may be minimized. Accordingly, the disclosure and the figures are to be regarded as illustrative rather than restrictive.</p>
</description>
<claims id="claims01" lang="en"><!-- EPO <DP n="32"> -->
<claim id="c-en-01-0001" num="0001">
<claim-text>A method for generating and utilizing, by a mobile device (114), a key for transitioning between extended service set, ESS, networks, the method comprising:
<claim-text>receiving (702) an identifier of a key holder (302) and an identifier of a first ESS network from a first access point (104), the first access point (104) being connected to the first ESS network, and the first ESS network being associated with the key holder (302);</claim-text>
<claim-text>constructing an authentication request (704), the authentication request including a first nonce, where the first nonce includes first randomly generated data;</claim-text>
<claim-text>transmitting the authentication request (704) to the key holder (302);</claim-text>
<claim-text>receiving an authentication response (706) including a second nonce, where the second nonce includes second randomly generated data;</claim-text>
<claim-text>generating a mutually derived key with the key holder (302) based on a symmetrical algorithm using the authentication request (704) and the authentication response (706);</claim-text>
<claim-text>using the mutually derived key to allow the mobile device (114) to perform an authentication with the first access point (104);</claim-text>
<claim-text>receiving the identifier of the key holder (302) and an identifier of a second ESS network from a second access point, the second access point being connected to the second ESS network, and the second ESS network being associated with said key holder (302); and<!-- EPO <DP n="33"> --></claim-text>
<claim-text>using said mutually derived key to perform an authentication with the second access point, allowing the mobile device to perform a transition from the first ESS network to the second ESS network.</claim-text></claim-text></claim>
<claim id="c-en-01-0002" num="0002">
<claim-text>The method of claim 1, wherein each of said identifiers of the first and second ESS networks is a homogenous extended service set identifier, HESSID.</claim-text></claim>
<claim id="c-en-01-0003" num="0003">
<claim-text>The method of claim 1, wherein the identifier of the key holder (302) is received prior to the mobile device (114) associating with the first ESS network connected to the first access point (104).</claim-text></claim>
<claim id="c-en-01-0004" num="0004">
<claim-text>The method of claim 1, wherein the identifier of the key holder (302) is received at a media access control, MAC, sub-layer (204).</claim-text></claim>
<claim id="c-en-01-0005" num="0005">
<claim-text>A mobile device (114) comprising a processor (502) configured to carry out the method of any of claims 1 to 4.</claim-text></claim>
<claim id="c-en-01-0006" num="0006">
<claim-text>A computer readable medium comprising instructions which, when executed by a processor (502) of a mobile device (114), causes the mobile device (104) to carry out the method of any of claims 1 to 4.</claim-text></claim>
</claims>
<claims id="claims02" lang="de"><!-- EPO <DP n="34"> -->
<claim id="c-de-01-0001" num="0001">
<claim-text>Verfahren zum Erzeugen und Benutzen, durch ein Mobilgerät (114), eines Schlüssels zum Übergehen zwischen Extended-Service-Set(ESS)-Netzwerken, wobei das Verfahren Folgendes umfasst:
<claim-text>Empfangen (702) eines Identifiers eines Schlüsselinhabers (302) und eines Identifiers eines ersten ESS-Netzwerks von einem ersten Zugangspunkt (104), wobei der erste Zugangspunkt (104) mit dem ersten ESS-Netzwerk verbunden ist und das erste ESS-Netzwerk mit dem Schlüsselinhaber (302) verknüpft ist;</claim-text>
<claim-text>Konstruieren einer Authentifizierungsanforderung (704), wobei die Authentifizierungsanforderung einen ersten Zeitstempel beinhaltet, wobei der erste Zeitstempel erste zufällig erzeugte Daten beinhaltet;</claim-text>
<claim-text>Übertragen der Authentifizierungsanforderung (704) an den Schlüsselinhaber (302);</claim-text>
<claim-text>Empfangen einer Authentifizierungsantwort (706), die einen zweiten Zeitstempel beinhaltet, wobei der zweite Zeitstempel zweite zufällig erzeugte Daten beinhaltet;</claim-text>
<claim-text>Erzeugen eines gegenseitig abgeleiteten Schlüssels mit dem Schlüsselhalter (302) basierend auf einem symmetrischen Algorithmus unter Verwendung der Authentifizierungsanforderung (704) und der Authentifizierungsantwort (706);</claim-text>
<claim-text>Verwenden des gegenseitig abgeleiteten Schlüssels, um es dem Mobilgerät (114) zu ermöglichen, eine Authentifizierung mit dem ersten Zugangspunkt (104) durchzuführen;</claim-text>
<claim-text>Empfangen des Identifiers des Schlüsselinhabers (302) und eines Identifiers eines zweiten ESS-Netzwerks von einem zweiten Zugangspunkt, wobei der zweite Zugangspunkt mit dem zweiten ESS-Netzwerk verbunden ist und das zweite ESS-Netzwerk mit dem Schlüsselinhaber (302) verknüpft ist; und</claim-text>
<claim-text>Verwenden des gegenseitig abgeleiteten Schlüssels, um eine Authentifizierung mit dem zweiten Zugangspunkt durchzuführen, Ermöglichen, dass das Mobilgerät einen Übergang von dem ersten ESS-Netzwerk zu dem zweiten ESS-Netzwerk durchführt.</claim-text></claim-text></claim>
<claim id="c-de-01-0002" num="0002">
<claim-text>Verfahren nach Anspruch 1, wobei jeder der Identifier des ersten und des zweiten ESS-Netzwerks ein Homogenous Extended Service Set Identifier (HESSID) ist.</claim-text></claim>
<claim id="c-de-01-0003" num="0003">
<claim-text>Verfahren nach Anspruch 1, wobei der Identifier des Schlüsselinhabers (302)<!-- EPO <DP n="35"> --> empfangen wird, bevor sich das Mobilgerät (114) mit dem ersten ESS-Netzwerk verknüpft, das mit dem ersten Zugangspunkt (104) verbunden ist.</claim-text></claim>
<claim id="c-de-01-0004" num="0004">
<claim-text>Verfahren nach Anspruch 1, wobei der Identifier des Schlüsselinhabers (302) an einer Media-Access-Control(MAC)-Unterschicht (204) empfangen wird.</claim-text></claim>
<claim id="c-de-01-0005" num="0005">
<claim-text>Mobilgerät (114), das einen Prozessor (502) umfasst, der konfiguriert ist, um das Verfahren nach einem der Ansprüche 1 bis 4 zu vollziehen.</claim-text></claim>
<claim id="c-de-01-0006" num="0006">
<claim-text>Computerlesbares Medium, das Anweisungen umfasst, die, wenn sie durch einen Prozessor (502) eines Mobilgeräts (114) ausgeführt werden, das Mobilgerät (104) veranlassen, ein Verfahren nach einem der Ansprüche 1 bis 4 zu vollziehen.</claim-text></claim>
</claims>
<claims id="claims03" lang="fr"><!-- EPO <DP n="36"> -->
<claim id="c-fr-01-0001" num="0001">
<claim-text>Procédé pour générer et utiliser, par un dispositif mobile (114), une clé pour la transition entre des réseaux d'ensemble de services étendu, ESS, le procédé comprenant :
<claim-text>la réception (702) d'un identifiant d'un détenteur de clé (302) et d'un identifiant d'un premier réseau ESS provenant d'un premier point d'accès (104), le premier point d'accès (104) étant connecté au premier réseau ESS, et le premier réseau ESS étant associé au détenteur de clé (302) ;</claim-text>
<claim-text>la construction d'une demande d'authentification (704), la demande d'authentification comportant un premier nombre aléatoire, le premier nombre aléatoire comportant des premières données générées de manière aléatoire ;</claim-text>
<claim-text>la transmission de la demande d'authentification (704) au détenteur de clé (302) ;</claim-text>
<claim-text>la réception d'une réponse d'authentification (706) comportant un second nombre aléatoire, le second nombre aléatoire comportant des secondes données générées de manière aléatoire ;</claim-text>
<claim-text>la génération d'une clé dérivée mutuellement avec le détenteur de clé (302) sur la base d'un algorithme symétrique à l'aide de la demande d'authentification (704) et de la réponse d'authentification (706) ;</claim-text>
<claim-text>l'utilisation de la clé dérivée mutuellement pour permettre au dispositif mobile (114) d'effectuer une authentification avec le premier point d'accès (104) ;</claim-text>
<claim-text>la réception de l'identifiant du détenteur de clé (302) et d'un identifiant d'un second réseau ESS en provenance d'un second point d'accès, le second point d'accès étant connecté au second réseau ESS, et le second réseau ESS étant associé audit détenteur de clé (302) ; et</claim-text>
<claim-text>l'utilisation de ladite clé dérivée mutuellement pour effectuer une authentification avec le second point d'accès, permettant au dispositif mobile d'effectuer une transition du premier réseau ESS au second réseau ESS.</claim-text></claim-text></claim>
<claim id="c-fr-01-0002" num="0002">
<claim-text>Procédé selon la revendication 1, chacun desdits identifiants des premier et second réseaux ESS étant un identifiant d'ensemble de services étendu homogène, HESSID.</claim-text></claim>
<claim id="c-fr-01-0003" num="0003">
<claim-text>Procédé selon la revendication 1, l'identifiant du détenteur de clé (302) étant reçu avant que le dispositif mobile (114) ne s'associe au premier réseau ESS connecté au<!-- EPO <DP n="37"> --> premier point d'accès (104).</claim-text></claim>
<claim id="c-fr-01-0004" num="0004">
<claim-text>Procédé selon la revendication 1, l'identifiant du détenteur de clé (302) étant reçu au niveau d'une sous-couche de commande d'accès au support, MAC, (204).</claim-text></claim>
<claim id="c-fr-01-0005" num="0005">
<claim-text>Dispositif mobile (114) comprenant un processeur (502) configuré pour mettre en œuvre le procédé selon l'une quelconque des revendications 1 à 4.</claim-text></claim>
<claim id="c-fr-01-0006" num="0006">
<claim-text>Support lisible par ordinateur comprenant des instructions qui, lorsqu'elles sont exécutées par un processeur (502) d'un dispositif mobile (114), amènent le dispositif mobile (104) à mettre en œuvre un procédé selon l'une quelconque des revendications 1 à 4.</claim-text></claim>
</claims>
<drawings id="draw" lang="en"><!-- EPO <DP n="38"> -->
<figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="154" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="39"> -->
<figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="162" he="108" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="40"> -->
<figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="154" he="184" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> -->
<figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="130" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> -->
<figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="165" he="184" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> -->
<figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="165" he="141" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> -->
<figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="163" he="106" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> -->
<figure id="f0008" num="8,9"><img id="if0008" file="imgf0008.tif" wi="163" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> -->
<figure id="f0009" num="10,11"><img id="if0009" file="imgf0009.tif" wi="131" he="219" img-content="drawing" img-format="tif"/></figure>
</drawings>
<ep-reference-list id="ref-list">
<heading id="ref-h0001"><b>REFERENCES CITED IN THE DESCRIPTION</b></heading>
<p id="ref-p0001" num=""><i>This list of references cited by the applicant is for the reader's convenience only. It does not form part of the European patent document. Even though great care has been taken in compiling the references, errors or omissions cannot be excluded and the EPO disclaims all liability in this regard.</i></p>
<heading id="ref-h0002"><b>Patent documents cited in the description</b></heading>
<p id="ref-p0002" num="">
<ul id="ref-ul0001" list-style="bullet">
<li><patcit id="ref-pcit0001" dnum="EP2445242A1"><document-id><country>EP</country><doc-number>2445242</doc-number><kind>A1</kind></document-id></patcit><crossref idref="pcit0001">[0003]</crossref></li>
</ul></p>
</ep-reference-list>
</ep-patent-document>
